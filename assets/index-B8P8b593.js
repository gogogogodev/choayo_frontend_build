import{g3 as $,r as u,gs as ne,k as e,S as o,aw as g,gt as H,n as i,bI as z,u as _,az as A,ag as N,dH as K,C as L,aL as Q,ci as oe,l as j,db as re,du as B,bE as X,I as Y,m as p,f as C,gm as ae,gv as te,bH as ie,dk as G,aQ as q,gw as le,aC as ce,fe as de,c4 as xe,ff as he,d2 as pe,aY as V,dg as F,dL as me,aK as ue,L as je,c3 as O,fs as ge,ch as fe,c as be,af as ve,p as k,aE as ye,H as we}from"./index-DtP58muJ.js";import{u as W}from"./index-TQm3s3pV.js";import{E as R}from"./empty-content-DR9MOANP.js";import{S as I}from"./Skeleton-2yIQyMsS.js";import{M as ke}from"./markdown-3Pra4sDh.js";import"./index-DjgS7-xh.js";import"./html-to-markdown-B4uLyYvU.js";const D={revalidateIfStale:!1,revalidateOnFocus:!1,revalidateOnReconnect:!1};function Ce(){const{data:r,isLoading:n,error:a,isValidating:t}=W("",$,D);return u.useMemo(()=>({labels:r?.labels||[],labelsLoading:n,labelsError:a,labelsValidating:t,labelsEmpty:!n&&!r?.labels.length}),[r?.labels,a,n,t])}function Ie(s){const{data:n,isLoading:a,error:t,isValidating:l}=W("",$,D);return u.useMemo(()=>{const x=n?.mails.length?ne(n?.mails,"id"):{},m=Object.keys(x);return{mails:{byId:x,allIds:m},mailsLoading:a,mailsError:t,mailsValidating:l,mailsEmpty:!a&&!m.length}},[n?.mails,t,a,l])}function Se(s){const{data:n,isLoading:a,error:t,isValidating:l}=W("",$,D);return u.useMemo(()=>({mail:n?.mail,mailLoading:a,mailError:t,mailValidating:l}),[n?.mail,t,a,l])}function Le({slots:s,sx:r,...n}){return e.jsxs(o,{sx:r,...n,children:[s.header,e.jsxs(o,{spacing:1,direction:"row",sx:{flex:"1 1 auto",overflow:"hidden"},children:[e.jsx(o,{sx:{flex:"0 0 200px",overflow:"hidden",display:{xs:"none",md:"flex"}},children:s.nav}),e.jsx(o,{sx:{borderRadius:1.5,flex:"0 0 320px",overflow:"hidden",bgcolor:"background.default",display:{xs:"none",md:"flex"}},children:s.list}),e.jsx(o,{sx:{minWidth:0,flex:"1 1 auto",borderRadius:1.5,overflow:"hidden",bgcolor:"background.default"},children:s.details})]})]})}const Me={all:"fluent:mail-24-filled",inbox:"solar:inbox-bold",trash:"solar:trash-bin-trash-bold",drafts:"solar:file-text-bold",spam:"solar:danger-bold",sent:"iconamoon:send-fill",starred:"eva:star-fill",important:"material-symbols:label-important-rounded",social:"solar:tag-horizontal-bold-duotone",promotions:"solar:tag-horizontal-bold-duotone",forums:"solar:tag-horizontal-bold-duotone"};function Ee({selected:s,label:r,onClickNavItem:n,...a}){const t=Me[r.id];return e.jsx(g,{component:"li",sx:{display:"flex"},children:e.jsxs(H,{disableGutters:!0,onClick:n,sx:{pl:1,pr:1.5,gap:2,borderRadius:.75,color:"text.secondary",...s&&{color:"text.primary"}},...a,children:[e.jsx(i,{icon:t,width:22,sx:{color:r.color}}),e.jsx(g,{component:"span",sx:{flexGrow:1,textTransform:"capitalize",typography:s?"subtitle2":"body2"},children:r.name}),!!r.unreadCount&&e.jsx(g,{component:"span",sx:{typography:"caption"},children:r.unreadCount})]})})}function Te({amount:s=6,sx:r,...n}){return[...Array(s)].map((a,t)=>e.jsxs(o,{spacing:2,direction:"row",alignItems:"center",sx:{py:1,color:l=>z(l.vars.palette.grey["500Channel"],.24),...r},...n,children:[e.jsx(I,{variant:"circular",sx:{width:32,height:32,bgcolor:"currentColor"}}),e.jsx(I,{sx:{width:.5,height:10,bgcolor:"currentColor"}})]},t))}function Fe({amount:s=6,sx:r,...n}){return[...Array(s)].map((a,t)=>e.jsxs(o,{spacing:2,direction:"row",alignItems:"center",sx:{py:1,...r},...n,children:[e.jsx(I,{variant:"circular",sx:{width:40,height:40}}),e.jsxs(o,{spacing:1,flexGrow:1,children:[e.jsx(I,{sx:{width:.75,height:10}}),e.jsx(I,{sx:{width:.5,height:10}})]})]},t))}function Pe({empty:s,labels:r,loading:n,openNav:a,onCloseNav:t,selectedLabelId:l,onToggleCompose:c,handleClickLabel:x}){const m=_(),f=e.jsx(o,{sx:{flex:"1 1 auto",px:{xs:2.5,md:1.5}},children:e.jsx(Te,{})}),y=e.jsx(o,{sx:{flex:"1 1 auto",px:{xs:2.5,md:1.5}},children:e.jsx(R,{title:"No labels",imgUrl:`${L.site.basePath}/assets/icons/empty/ic-folder-empty.svg`})}),b=e.jsx(A,{sx:{flex:"1 1 0"},children:e.jsx("nav",{children:e.jsx(g,{component:"ul",sx:{pb:1.5,px:{xs:1.5,md:.5}},children:r.map(d=>e.jsx(Ee,{label:d,selected:l===d.id,onClickNavItem:()=>{x(d.id)}},d.id))})})}),h=e.jsxs(e.Fragment,{children:[e.jsx(o,{sx:{p:{xs:2.5,md:m.spacing(2,1.5)}},children:e.jsx(N,{fullWidth:!0,color:"inherit",variant:"contained",startIcon:e.jsx(i,{icon:"solar:pen-bold"}),onClick:c,children:"Compose"})}),n?f:e.jsx(e.Fragment,{children:s?y:b})]});return e.jsxs(e.Fragment,{children:[h,e.jsx(K,{open:a,onClose:t,slotProps:{backdrop:{invisible:!0}},PaperProps:{sx:{width:280}},children:h})]})}function ze({mail:s,selected:r,sx:n,...a}){return e.jsx(g,{component:"li",sx:{display:"flex"},children:e.jsxs(H,{disableGutters:!0,sx:{p:1,gap:2,borderRadius:1,...r&&{bgcolor:"action.selected"},...n},...a,children:[e.jsx(Q,{alt:s.from.name,src:s.from.avatarUrl??"",children:s.from.name.charAt(0).toUpperCase()}),e.jsx(oe,{primary:s.from.name,primaryTypographyProps:{noWrap:!0,component:"span",variant:"subtitle2"},secondary:s.message,secondaryTypographyProps:{noWrap:!0,component:"span",variant:s.isUnread?"subtitle2":"body2",color:s.isUnread?"text.primary":"text.secondary"}}),e.jsxs(o,{alignItems:"flex-end",sx:{alignSelf:"stretch"},children:[e.jsx(j,{noWrap:!0,variant:"body2",component:"span",sx:{mb:1.5,fontSize:12,color:"text.disabled"},children:re(s.createdAt)}),!!s.isUnread&&e.jsx(g,{sx:{width:8,height:8,borderRadius:"50%",bgcolor:"info.main"}})]})]})})}function $e({empty:s,mails:r,loading:n,openMail:a,onCloseMail:t,onClickMail:l,selectedMailId:c,selectedLabelId:x}){const m=B("up","md"),f=e.jsx(o,{sx:{px:2,flex:"1 1 auto"},children:e.jsx(Fe,{})}),y=e.jsx(o,{sx:{px:2,flex:"1 1 auto"},children:e.jsx(R,{title:`Nothing in ${x}`,description:"This folder is empty",imgUrl:`${L.site.basePath}/assets/icons/empty/ic-folder-empty.svg`})}),b=e.jsx(A,{sx:{flex:"1 1 0"},children:e.jsx("nav",{children:e.jsx(g,{component:"ul",sx:{px:2,pb:1,gap:.5,display:"flex",flexDirection:"column"},children:r.allIds.map(d=>e.jsx(ze,{mail:r.byId[d],selected:c===d,onClick:()=>{l(d)}},d))})})}),h=e.jsxs(e.Fragment,{children:[e.jsx(o,{sx:{p:2},children:m?e.jsx(X,{placeholder:"Search...",InputProps:{startAdornment:e.jsx(Y,{position:"start",children:e.jsx(i,{icon:"eva:search-fill",sx:{color:"text.disabled"}})})}}):e.jsx(j,{variant:"h6",sx:{textTransform:"capitalize"},children:x})}),n?f:e.jsx(e.Fragment,{children:s?y:b})]});return e.jsxs(e.Fragment,{children:[h,e.jsx(K,{open:a,onClose:t,slotProps:{backdrop:{invisible:!0}},PaperProps:{sx:{width:320}},children:h})]})}function Ae({onOpenNav:s,onOpenMail:r,sx:n,...a}){return e.jsxs(o,{direction:"row",alignItems:"center",sx:{py:1,mb:1,...n},...a,children:[e.jsx(p,{onClick:s,children:e.jsx(i,{icon:"fluent:mail-24-filled"})}),r&&e.jsx(p,{onClick:r,children:e.jsx(i,{icon:"solar:chat-round-dots-bold"})}),e.jsx(X,{fullWidth:!0,size:"small",placeholder:"Search...",InputProps:{startAdornment:e.jsx(Y,{position:"start",children:e.jsx(i,{icon:"eva:search-fill",sx:{color:"text.disabled"}})})},sx:{ml:2}})]})}const S=20;function Ne({onCloseCompose:s}){const r=B("up","sm"),n=C(),[a,t]=u.useState(""),l=u.useCallback(c=>{t(c)},[]);return e.jsxs(ae,{children:[(n.value||!r)&&e.jsx(te,{open:!0,sx:{zIndex:c=>c.zIndex.modal-1}}),e.jsxs(ie,{sx:{maxWidth:560,right:S,borderRadius:2,display:"flex",bottom:S,position:"fixed",overflow:"hidden",flexDirection:"column",zIndex:c=>c.zIndex.modal,width:`calc(100% - ${S*2}px)`,boxShadow:c=>c.customShadows.dropdown,...n.value&&{maxWidth:1,height:`calc(100% - ${S*2}px)`}},children:[e.jsxs(o,{direction:"row",alignItems:"center",sx:{bgcolor:"background.neutral",p:c=>c.spacing(1.5,1,1.5,2)},children:[e.jsx(j,{variant:"h6",sx:{flexGrow:1},children:"New message"}),e.jsx(p,{onClick:n.onToggle,children:e.jsx(i,{icon:n.value?"eva:collapse-fill":"eva:expand-fill"})}),e.jsx(p,{onClick:s,children:e.jsx(i,{icon:"mingcute:close-line"})})]}),e.jsx(G,{placeholder:"To",endAdornment:e.jsxs(o,{direction:"row",spacing:.5,sx:{typography:"subtitle2"},children:[e.jsx(g,{sx:{cursor:"pointer","&:hover":{textDecoration:"underline"}},children:"Cc"}),e.jsx(g,{sx:{cursor:"pointer","&:hover":{textDecoration:"underline"}},children:"Bcc"})]}),sx:{px:2,height:48,borderBottom:c=>`solid 1px ${z(c.vars.palette.grey["500Channel"],.08)}`}}),e.jsx(G,{placeholder:"Subject",sx:{px:2,height:48,borderBottom:c=>`solid 1px ${z(c.vars.palette.grey["500Channel"],.08)}`}}),e.jsxs(o,{spacing:2,flexGrow:1,sx:{p:2,flex:"1 1 auto",overflow:"hidden"},children:[e.jsx(q,{value:a,onChange:l,placeholder:"Type a message",slotProps:{wrap:{...n.value&&{minHeight:0,flex:"1 1 auto"}}},sx:{maxHeight:480,...n.value&&{maxHeight:1,flex:"1 1 auto"}}}),e.jsxs(o,{direction:"row",alignItems:"center",children:[e.jsxs(o,{direction:"row",alignItems:"center",flexGrow:1,children:[e.jsx(p,{children:e.jsx(i,{icon:"solar:gallery-add-bold"})}),e.jsx(p,{children:e.jsx(i,{icon:"eva:attach-2-fill"})})]}),e.jsx(N,{variant:"contained",color:"primary",endIcon:e.jsx(i,{icon:"iconamoon:send-fill"}),children:"Send"})]})]})]})]})}function Be({mail:s,renderLabel:r,empty:n,loading:a}){const t=_(),l=C(!0);if(a)return e.jsx(le,{});if(n||!s)return e.jsx(R,{title:"No conversation selected",description:"Select a conversation to read",imgUrl:`${L.site.basePath}/assets/icons/empty/ic-email-selected.svg`});const c=e.jsxs(e.Fragment,{children:[e.jsx(o,{direction:"row",spacing:1,flexGrow:1,children:s.labelIds.map(h=>{const d=r(h);return d?e.jsx(ce,{sx:{color:he(d.color,.24),bgcolor:xe(d.color,.16),[pe.dark]:{color:de(d.color,.24)}},children:d.name},d.id):null})}),e.jsxs(o,{direction:"row",alignItems:"center",children:[e.jsx(V,{color:"warning",icon:e.jsx(i,{icon:"eva:star-outline"}),checkedIcon:e.jsx(i,{icon:"eva:star-fill"}),checked:s.isStarred,inputProps:{id:"starred-checkbox","aria-label":"Starred checkbox"}}),e.jsx(V,{color:"warning",icon:e.jsx(i,{icon:"material-symbols:label-important-rounded"}),checkedIcon:e.jsx(i,{icon:"material-symbols:label-important-rounded"}),checked:s.isImportant,inputProps:{id:"important-checkbox","aria-label":"Important checkbox"}}),e.jsx(F,{title:"Archive",children:e.jsx(p,{children:e.jsx(i,{icon:"solar:archive-down-minimlistic-bold"})})}),e.jsx(F,{title:"Mark Unread",children:e.jsx(p,{children:e.jsx(i,{icon:"fluent:mail-unread-20-filled"})})}),e.jsx(F,{title:"Trash",children:e.jsx(p,{children:e.jsx(i,{icon:"solar:trash-bin-trash-bold"})})}),e.jsx(p,{children:e.jsx(i,{icon:"eva:more-vertical-fill"})})]})]}),x=e.jsxs(e.Fragment,{children:[e.jsxs(j,{variant:"subtitle2",sx:{...me({line:2}),flex:"1 1 auto"},children:["Re: ",s.subject]}),e.jsxs(o,{spacing:.5,children:[e.jsxs(o,{direction:"row",alignItems:"center",justifyContent:"flex-end",children:[e.jsx(p,{size:"small",children:e.jsx(i,{width:18,icon:"solar:reply-bold"})}),e.jsx(p,{size:"small",children:e.jsx(i,{width:18,icon:"solar:multiple-forward-left-broken"})}),e.jsx(p,{size:"small",children:e.jsx(i,{width:18,icon:"solar:forward-bold"})})]}),e.jsx(j,{variant:"caption",noWrap:!0,sx:{color:"text.disabled"},children:ue(s.createdAt)})]})]}),m=e.jsxs(e.Fragment,{children:[e.jsx(Q,{alt:s.from.name,src:s.from.avatarUrl?`${s.from.avatarUrl}`:"",sx:{mr:2},children:s.from.name.charAt(0).toUpperCase()}),e.jsxs(o,{spacing:.5,sx:{width:0,flexGrow:1},children:[e.jsxs(o,{spacing:.5,direction:"row",children:[e.jsx(j,{component:"span",variant:"subtitle2",sx:{flexShrink:0},children:s.from.name}),e.jsx(j,{component:"span",noWrap:!0,variant:"body2",sx:{color:"text.secondary"},children:`<${s.from.email}>`})]}),e.jsxs(j,{noWrap:!0,component:"span",variant:"caption",sx:{color:"text.secondary"},children:["To: ",s.to.map(h=>e.jsx(je,{color:"inherit",sx:{"&:hover":{color:"text.primary"}},children:`${h.email}, `},h.email))]})]})]}),f=e.jsxs(o,{spacing:1,sx:{p:1,borderRadius:1,bgcolor:"background.neutral"},children:[e.jsxs(o,{direction:"row",alignItems:"center",justifyContent:"space-between",children:[e.jsxs(O,{onClick:l.onToggle,sx:{borderRadius:.5,typography:"caption",color:"text.secondary"},children:[e.jsx(i,{icon:"eva:attach-2-fill",sx:{mr:.5}}),s.attachments.length," attachments",e.jsx(i,{icon:l.value?"eva:arrow-ios-upward-fill":"eva:arrow-ios-downward-fill",width:16,sx:{ml:.5}})]}),e.jsxs(O,{sx:{py:.5,gap:.5,px:.75,borderRadius:.75,typography:"caption",fontWeight:"fontWeightSemiBold"},children:[e.jsx(i,{width:18,icon:"eva:cloud-download-fill"})," Download"]})]}),e.jsx(ge,{in:l.value,unmountOnExit:!0,timeout:"auto",children:e.jsx(o,{direction:"row",flexWrap:"wrap",spacing:.75,children:s.attachments.map(h=>e.jsx(fe,{tooltip:!0,imageView:!0,file:h.preview,onDownload:()=>console.info("DOWNLOAD"),sx:{width:48,height:48,backgroundColor:"background.neutral"},slotProps:{icon:{width:24,height:24}}},h.id))})})]}),y=e.jsx(ke,{children:s.message,sx:{px:2,"& p":{typography:"body2"}}}),b=e.jsxs(e.Fragment,{children:[e.jsx(q,{sx:{maxHeight:320}}),e.jsxs(o,{direction:"row",alignItems:"center",children:[e.jsx(p,{children:e.jsx(i,{icon:"solar:gallery-add-bold"})}),e.jsx(p,{children:e.jsx(i,{icon:"eva:attach-2-fill"})}),e.jsx(o,{flexGrow:1}),e.jsx(N,{color:"primary",variant:"contained",endIcon:e.jsx(i,{icon:"iconamoon:send-fill"}),children:"Send"})]})]});return e.jsxs(e.Fragment,{children:[e.jsx(o,{direction:"row",alignItems:"center",flexShrink:0,sx:{pl:2,pr:1,height:56},children:c}),e.jsx(o,{spacing:2,flexShrink:0,direction:"row",sx:{p:2,borderTop:`1px dashed ${t.vars.palette.divider}`,borderBottom:`1px dashed ${t.vars.palette.divider}`},children:x}),e.jsx(o,{flexShrink:0,direction:"row",alignItems:"center",sx:{pt:2,px:2},children:m}),!!s.attachments.length&&e.jsxs(o,{sx:{px:2,mt:2},children:[" ",f," "]}),e.jsx(A,{sx:{mt:3,flex:"1 1 240px"},children:y}),e.jsx(o,{flexShrink:0,spacing:2,sx:{p:2},children:b})]})}const P="inbox";function We(){const s=be(),r=ve(),n=r.get("label")??P,a=r.get("id")??"",t=B("up","md"),l=C(),c=C(),x=C(),{labels:m,labelsLoading:f,labelsEmpty:y}=Ce(),{mails:b,mailsLoading:h,mailsError:d,mailsEmpty:M}=Ie(n),{mail:J,mailLoading:Z,mailError:U}=Se(a),E=b.allIds[0]||"",ee=u.useCallback(()=>{l.value&&l.onFalse(),x.onToggle()},[x,l]),se=u.useCallback(v=>{if(t||l.onFalse(),v){const w=v!==P?`${k.dashboard.mail}?label=${v}`:k.dashboard.mail;s.push(w)}},[l,s,t]),T=u.useCallback(v=>{t||c.onFalse();const w=n!==P?`${k.dashboard.mail}?id=${v}&label=${n}`:`${k.dashboard.mail}?id=${v}`;s.push(w)},[c,s,n,t]);return u.useEffect(()=>{(d||U)&&s.push(k.dashboard.mail)},[U,d,s]),u.useEffect(()=>{!a&&E&&T(E)},[E,T,a]),u.useEffect(()=>{x.value?document.body.style.overflow="hidden":document.body.style.overflow=""},[x.value]),e.jsxs(e.Fragment,{children:[e.jsxs(ye,{maxWidth:!1,sx:{flex:"1 1 auto",display:"flex",flexDirection:"column"},children:[e.jsx(j,{variant:"h4",sx:{mb:{xs:3,md:5}},children:"Mail"}),e.jsx(Le,{sx:{p:1,borderRadius:2,flex:"1 1 auto",bgcolor:"background.neutral"},slots:{header:e.jsx(Ae,{onOpenNav:l.onTrue,onOpenMail:M?void 0:c.onTrue,sx:{display:{md:"none"}}}),nav:e.jsx(Pe,{labels:m,empty:y,loading:f,openNav:l.value,onCloseNav:l.onFalse,selectedLabelId:n,handleClickLabel:se,onToggleCompose:ee}),list:e.jsx($e,{mails:b,empty:M,loading:h||f,openMail:c.value,onCloseMail:c.onFalse,onClickMail:T,selectedLabelId:n,selectedMailId:a}),details:e.jsx(Be,{mail:J,empty:M,loading:h||Z,renderLabel:v=>m.filter(w=>w.id===v)[0]})}})]}),x.value&&e.jsx(Ne,{onCloseCompose:x.onFalse})]})}const Re={title:`Mail | Dashboard - ${L.site.name}`};function Ke(){return e.jsxs(e.Fragment,{children:[e.jsx(we,{children:e.jsxs("title",{children:[" ",Re.title]})}),e.jsx(We,{})]})}export{Ke as default};
