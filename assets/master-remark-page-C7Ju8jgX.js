import{f as I,r as o,k as e,d as T,ag as y,n as g,i7 as A,g as P,t as E,c6 as O,F as B,dj as z,c8 as M,aF as b,ay as R,bZ as H,o as L,cP as N,cD as G,m as K,cQ as W,cd as _,cc as F,S as $,I as q,iq as Q,aw as Z,az as J,H as U,C as X,aE as Y}from"./index-DtP58muJ.js";import{C as ee}from"./custom-breadcrumbs-C-JLSHAz.js";import{C as ae}from"./errors-wZ747Yys.js";import{F as te}from"./form-caption-DmEucZqR.js";import{R as se,a as oe,b as re,c as ne}from"./functions-C90aQ1cx.js";import{R as v,a as ie,T as le,b as ce}from"./schemas-wXp1Tq2Y.js";import{a as de,b as S,c as me,T as ue}from"./TableRow-BeGZSEnl.js";import{T as x}from"./TableCell-BYy3h6md.js";import{T as he}from"./table-pagination-custom-DoMFqUCQ.js";import{C as xe}from"./Card-DhhypByC.js";import"./TablePagination-DcwzPYld.js";import"./LastPage-CTPAXkYQ.js";import"./FormControlLabel-aYt4PlDo.js";const V=o.createContext(void 0),j=()=>{const a=o.useContext(V);if(a===void 0)throw new Error("useContextPage must be used within a PageContext.Provider");return a},pe=({children:a})=>{const t=I(),[s,r]=o.useState(0),n=()=>r(m=>m+1),[i,l]=o.useState(null),c=m=>{l(m)},[d,p]=o.useState(""),f=m=>{p(m)},h=o.useMemo(()=>({isDialogFormOpen:t,refreshFlag:s,triggerRefresh:n,keyword:d,updateKeyword:f,remarkFormValues:i,updateRemarkFormValues:c}),[t,s,d,i]);return e.jsx(V.Provider,{value:h,children:a})};function fe(){const{checkAbilities:a}=T(),{isDialogFormOpen:t}=j();return e.jsx(ee,{heading:"Remark",links:[{name:"Master",href:"#"},{name:"Remark",href:"#"}],action:a?.("remark:create")&&e.jsx(y,{size:"medium",variant:"contained",onClick:t.onTrue,startIcon:e.jsx(g,{icon:"mingcute:add-line"}),children:"New Remark"}),sx:{mb:{xs:3,md:5}}})}function ge(){const{showSweetDialog:a}=A(),{isDialogFormOpen:t,remarkFormValues:s,updateRemarkFormValues:r,triggerRefresh:n}=j(),[i,l]=o.useState("New Remark"),c=P({resolver:E(ie),defaultValues:v}),{reset:d,handleSubmit:p,formState:{isSubmitting:f,isDirty:h}}=c;o.useEffect(()=>{s?(l("Edit Remark"),d({id:s.id,code:s.code,name:s.name})):l("New Remark")},[s]);const m=()=>{d(v),r(null),t.onFalse()},w=async C=>{await se(C).then(()=>{m(),n(),a({icon:"success",title:"Data saved successfully",description:"Saved successfully"})}).catch(u=>{u instanceof ae&&Object.keys(u.validationErrors).forEach(k=>{c.setError(k,{type:"manual",message:u.validationErrors[k][0]})})})};return e.jsx(O,{open:t.value,children:e.jsxs(B,{methods:c,onSubmit:p(w),children:[e.jsx(z,{children:i}),e.jsx(M,{sx:{overflow:"visible"},children:e.jsxs(b,{container:!0,spacing:3,children:[e.jsx(b,{xs:12,children:e.jsx(R,{name:"code",label:"Code",size:"medium"})}),e.jsx(b,{xs:12,children:e.jsx(R,{name:"name",label:"Name",size:"medium"})}),e.jsx(b,{xs:12,children:e.jsx(te,{caption:"Fill in the form above and correct it again correctly"})})]})}),e.jsxs(H,{children:[e.jsx(y,{onClick:m,variant:"outlined",color:"inherit",children:"Cancel"}),e.jsx(L,{size:"medium",type:"submit",disabled:!h,variant:"contained",loading:f,children:"Save"})]})]})})}function je(){const a=[{id:"id",label:"ID",width:10},{id:"remark",label:"Remark",width:100},{id:"description",label:"Description",width:200},{id:"",width:10}];return e.jsx(de,{children:e.jsx(S,{children:a.map(t=>e.jsx(x,{align:t.align||"left",sortDirection:!1,sx:{width:t.width,minWidth:0},children:t.label},t.id))})})}function ke({row:a}){const t=N(),{showConfirmDialog:s}=G(),{checkAbilities:r,checkAbilitiesMultiple:n}=T(),{isDialogFormOpen:i,updateRemarkFormValues:l,triggerRefresh:c}=j();return e.jsxs(S,{hover:!0,children:[e.jsx(x,{sx:{whiteSpace:"nowrap"},children:a.code}),e.jsx(x,{sx:{whiteSpace:"nowrap"},children:a.name}),e.jsx(x,{sx:{whiteSpace:"nowrap"},children:`${a.code} - ${a.name}`}),e.jsxs(x,{sx:{whiteSpace:"nowrap"},align:"right",children:[n?.(["remark:edit","remark:delete"])&&e.jsx(K,{color:t.open?"inherit":"default",onClick:t.onOpen,children:e.jsx(g,{icon:"eva:more-vertical-fill"})}),e.jsx(W,{open:t.open,anchorEl:t.anchorEl,onClose:t.onClose,slotProps:{arrow:{placement:"right-top"}},children:e.jsxs(_,{children:[r?.("remark:delete")&&e.jsxs(F,{onClick:()=>{t.onClose(),s({title:"Delete Remark",description:"Anda yakin? Data akan dihapus permanent.",confirmBtnText:"Delete",onConfirm:async()=>{await oe(a.id??""),c()}})},sx:{color:"error.main"},children:[e.jsx(g,{icon:"solar:trash-bin-trash-bold"}),"Delete"]}),r?.("remark:edit")&&e.jsxs(F,{onClick:()=>{t.onClose(),i.onTrue(),l(a)},children:[e.jsx(g,{icon:"solar:pen-bold"}),"Edit"]})]})})]})]})}function D({text:a}){return e.jsx(S,{hover:!0,children:e.jsx(x,{sx:{whiteSpace:"nowrap"},align:"center",colSpan:4,children:a})})}function be({rows:a,status:t}){return e.jsx(me,{children:t==="loading"?e.jsx(D,{text:"loading .."}):a.length===0?e.jsx(D,{text:"data not found"}):a.map((s,r)=>e.jsx(ke,{row:s},r))})}function we(){const{keyword:a,updateKeyword:t}=j(),s=P({resolver:E(ce),defaultValues:le}),{watch:r,reset:n,handleSubmit:i}=s;o.useEffect(()=>{n({keyword:a})},[a,n]);const l=r();o.useEffect(()=>{const d=setTimeout(()=>{l.keyword===""&&t("")},300);return()=>clearTimeout(d)},[l.keyword,t]);const c=async d=>{t(d.keyword)};return e.jsx($,{sx:{p:2.5},children:e.jsx(B,{methods:s,onSubmit:i(c),children:e.jsx(R,{size:"medium",name:"keyword",tooltipTitle:"press enter",placeholder:"Search ID or remark...",InputProps:{startAdornment:e.jsx(q,{position:"start",children:e.jsx(g,{icon:"eva:search-fill",sx:{color:"text.disabled"}})})}})})})}function Ce(){const{keyword:a,refreshFlag:t}=j(),{isOnline:s,previousStatus:r}=Q(),[n,i]=o.useState(0),[l,c]=o.useState(0),[d,p]=o.useState([]),[f,h]=o.useState(!1),m=async()=>{h(!0),await ne({keyword:a,page:n+1}).then(u=>{p(u.data),c(u.total),i(u.current_page-1)}).finally(()=>{h(!1)})};o.useEffect(()=>{m()},[a,t,n]);const w=(u,k)=>{i(k)},C=u=>{i(0)};return o.useEffect(()=>{s&&r==="offline"&&re()},[s,r]),e.jsxs(xe,{children:[e.jsx(we,{}),e.jsx(Z,{sx:{position:"relative"},children:e.jsx(J,{children:e.jsxs(ue,{size:"medium",sx:{minWidth:0},children:[e.jsx(je,{}),e.jsx(be,{rows:d,status:f?"loading":"finish"})]})})}),e.jsx(he,{dense:!1,page:n,count:l,rowsPerPage:15,rowsPerPageOptions:[15,25,100],onPageChange:w,onRowsPerPageChange:C})]})}const Re={title:`Master - Remark - ${X.site.name}`};function ze(){return e.jsxs(e.Fragment,{children:[e.jsx(U,{children:e.jsxs("title",{children:[" ",Re.title]})}),e.jsx(Y,{maxWidth:"xl",children:e.jsxs(pe,{children:[e.jsx(fe,{}),e.jsx(Ce,{}),e.jsx(ge,{})]})})]})}export{ze as default};
