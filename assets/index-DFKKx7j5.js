import{r as S,bN as Tt}from"./index-CtazL8yi.js";import{s as Qt}from"./index-QBukoXJl.js";const qt=0,Ut=1,Ht=2,xt=3;var Wt=Object.prototype.hasOwnProperty;function Rt(t,e){var n,s;if(t===e)return!0;if(t&&e&&(n=t.constructor)===e.constructor){if(n===Date)return t.getTime()===e.getTime();if(n===RegExp)return t.toString()===e.toString();if(n===Array){if((s=t.length)===e.length)for(;s--&&Rt(t[s],e[s]););return s===-1}if(!n||typeof t=="object"){s=0;for(n in t)if(Wt.call(t,n)&&++s&&!Wt.call(e,n)||!(n in e)||!Rt(t[n],e[n]))return!1;return Object.keys(e).length===s}}return t!==t&&e!==e}const P=new WeakMap,M=()=>{},C=M(),ht=Object,i=t=>t===C,N=t=>typeof t=="function",q=(t,e)=>({...t,...e}),$t=t=>N(t.then),ut={},st={},Dt="undefined",Q=typeof window!=Dt,mt=typeof document!=Dt,Zt=Q&&"Deno"in window,te=()=>Q&&typeof window.requestAnimationFrame!=Dt,kt=(t,e)=>{const n=P.get(t);return[()=>!i(e)&&t.get(e)||ut,s=>{if(!i(e)){const a=t.get(e);e in st||(st[e]=a),n[5](e,q(a,s),a||ut)}},n[6],()=>!i(e)&&e in st?st[e]:!i(e)&&t.get(e)||ut]};let gt=!0;const ee=()=>gt,[wt,Ot]=Q&&window.addEventListener?[window.addEventListener.bind(window),window.removeEventListener.bind(window)]:[M,M],ne=()=>{const t=mt&&document.visibilityState;return i(t)||t!=="hidden"},se=t=>(mt&&document.addEventListener("visibilitychange",t),wt("focus",t),()=>{mt&&document.removeEventListener("visibilitychange",t),Ot("focus",t)}),re=t=>{const e=()=>{gt=!0,t()},n=()=>{gt=!1};return wt("online",e),wt("offline",n),()=>{Ot("online",e),Ot("offline",n)}},oe={isOnline:ee,isVisible:ne},ie={initFocus:se,initReconnect:re},Pt=!Tt.useId,X=!Q||Zt,ae=t=>te()?window.requestAnimationFrame(t):setTimeout(t,1),lt=X?S.useEffect:S.useLayoutEffect,ft=typeof navigator<"u"&&navigator.connection,jt=!X&&ft&&(["slow-2g","2g"].includes(ft.effectiveType)||ft.saveData),rt=new WeakMap,ce=t=>ht.prototype.toString.call(t),dt=(t,e)=>t===`[object ${e}]`;let ue=0;const vt=t=>{const e=typeof t,n=ce(t),s=dt(n,"Date"),a=dt(n,"RegExp"),u=dt(n,"Object");let o,c;if(ht(t)===t&&!s&&!a){if(o=rt.get(t),o)return o;if(o=++ue+"~",rt.set(t,o),Array.isArray(t)){for(o="@",c=0;c<t.length;c++)o+=vt(t[c])+",";rt.set(t,o)}if(u){o="#";const E=ht.keys(t).sort();for(;!i(c=E.pop());)i(t[c])||(o+=c+":"+vt(t[c])+",");rt.set(t,o)}}else o=s?t.toJSON():e=="symbol"?t.toString():e=="string"?JSON.stringify(t):""+t;return o},_t=t=>{if(N(t))try{t=t()}catch{t=""}const e=t;return t=typeof t=="string"?t:(Array.isArray(t)?t.length:t)?vt(t):"",[t,e]};let le=0;const St=()=>++le;async function zt(...t){const[e,n,s,a]=t,u=q({populateCache:!0,throwOnError:!0},typeof a=="boolean"?{revalidate:a}:a||{});let o=u.populateCache;const c=u.rollbackOnError;let E=u.optimisticData;const A=T=>typeof c=="function"?c(T):c!==!1,w=u.throwOnError;if(N(n)){const T=n,R=[],I=e.keys();for(const h of I)!/^\$(inf|sub)\$/.test(h)&&T(e.get(h)._k)&&R.push(h);return Promise.all(R.map(m))}return m(n);async function m(T){const[R]=_t(T);if(!R)return;const[I,h]=kt(e,R),[ot,r,Z,K]=P.get(e),j=()=>{const D=ot[R];return(N(u.revalidate)?u.revalidate(I().data,T):u.revalidate!==!1)&&(delete Z[R],delete K[R],D&&D[0])?D[0](Ht).then(()=>I().data):I().data};if(t.length<3)return j();let O=s,F,L=!1;const d=St();r[R]=[d,0];const $=!i(E),V=I(),k=V.data,tt=V._c,U=i(tt)?k:tt;if($&&(E=N(E)?E(U,k):E,h({data:E,_c:U})),N(O))try{O=O(U)}catch(D){F=D,L=!0}if(O&&$t(O))if(O=await O.catch(D=>{F=D,L=!0}),d!==r[R][0]){if(L)throw F;return O}else L&&$&&A(F)&&(o=!0,h({data:U,_c:C}));if(o&&!L)if(N(o)){const D=o(O,U);h({data:D,error:C,_c:C})}else h({data:O,error:C,_c:C});if(r[R][1]=St(),Promise.resolve(j()).then(()=>{h({_c:C})}),L){if(w)throw F;return}return O}}const Mt=(t,e)=>{for(const n in t)t[n][0]&&t[n][0](e)},fe=(t,e)=>{if(!P.has(t)){const n=q(ie,e),s=Object.create(null),a=zt.bind(C,t);let u=M;const o=Object.create(null),c=(w,m)=>{const T=o[w]||[];return o[w]=T,T.push(m),()=>T.splice(T.indexOf(m),1)},E=(w,m,T)=>{t.set(w,m);const R=o[w];if(R)for(const I of R)I(m,T)},A=()=>{if(!P.has(t)&&(P.set(t,[s,Object.create(null),Object.create(null),Object.create(null),a,E,c]),!X)){const w=n.initFocus(setTimeout.bind(C,Mt.bind(C,s,qt))),m=n.initReconnect(setTimeout.bind(C,Mt.bind(C,s,Ut)));u=()=>{w&&w(),m&&m(),P.delete(t)}}};return A(),[t,a,A,u]}return[t,P.get(t)[4]]},de=(t,e,n,s,a)=>{const u=n.errorRetryCount,o=a.retryCount,c=~~((Math.random()+.5)*(1<<(o<8?o:8)))*n.errorRetryInterval;!i(u)&&o>u||setTimeout(s,c,a)},Ee=Rt,[Bt,pe]=fe(new Map),Re=q({onLoadingSlow:M,onSuccess:M,onError:M,onErrorRetry:de,onDiscarded:M,revalidateOnFocus:!0,revalidateOnReconnect:!0,revalidateIfStale:!0,shouldRetryOnError:!0,errorRetryInterval:jt?1e4:5e3,focusThrottleInterval:5*1e3,dedupingInterval:2*1e3,loadingTimeout:jt?5e3:3e3,compare:Ee,isPaused:()=>!1,cache:Bt,mutate:pe,fallback:{}},oe),he=(t,e)=>{const n=q(t,e);if(e){const{use:s,fallback:a}=t,{use:u,fallback:o}=e;s&&u&&(n.use=s.concat(u)),a&&o&&(n.fallback=q(a,o))}return n},me=S.createContext({}),ge="$inf$",Jt=Q&&window.__SWR_DEVTOOLS_USE__,we=Jt?window.__SWR_DEVTOOLS_USE__:[],Oe=()=>{Jt&&(window.__SWR_DEVTOOLS_REACT__=Tt)},ve=t=>N(t[1])?[t[0],t[1],t[2]||{}]:[t[0],null,(t[1]===null?t[2]:t[1])||{}],Se=()=>q(Re,S.useContext(me)),Te=t=>(e,n,s)=>t(e,n&&((...u)=>{const[o]=_t(e),[,,,c]=P.get(Bt);if(o.startsWith(ge))return n(...u);const E=c[o];return i(E)?n(...u):(delete c[o],E)}),s),De=we.concat(Te),_e=t=>function(...n){const s=Se(),[a,u,o]=ve(n),c=he(s,o);let E=t;const{use:A}=c,w=(A||[]).concat(De);for(let m=w.length;m--;)E=w[m](E);return E(a,u||c.fetcher||null,c)},Ce=(t,e,n)=>{const s=e[t]||(e[t]=[]);return s.push(n),()=>{const a=s.indexOf(n);a>=0&&(s[a]=s[s.length-1],s.pop())}};Oe();const Et=Tt.use||(t=>{switch(t.status){case"pending":throw t;case"fulfilled":return t.value;case"rejected":throw t.reason;default:throw t.status="pending",t.then(e=>{t.status="fulfilled",t.value=e},e=>{t.status="rejected",t.reason=e}),t}}),pt={dedupe:!0},ye=(t,e,n)=>{const{cache:s,compare:a,suspense:u,fallbackData:o,revalidateOnMount:c,revalidateIfStale:E,refreshInterval:A,refreshWhenHidden:w,refreshWhenOffline:m,keepPreviousData:T}=n,[R,I,h,ot]=P.get(s),[r,Z]=_t(t),K=S.useRef(!1),j=S.useRef(!1),O=S.useRef(r),F=S.useRef(e),L=S.useRef(n),d=()=>L.current,$=()=>d().isVisible()&&d().isOnline(),[V,k,tt,U]=kt(s,r),D=S.useRef({}).current,G=i(o)?i(n.fallback)?C:n.fallback[r]:o,Ct=(f,l)=>{for(const v in D){const p=v;if(p==="data"){if(!a(f[p],l[p])&&(!i(f[p])||!a(nt,l[p])))return!1}else if(l[p]!==f[p])return!1}return!0},yt=S.useMemo(()=>{const f=!r||!e?!1:i(c)?d().isPaused()||u?!1:E!==!1:c,l=_=>{const x=q(_);return delete x._k,f?{isValidating:!0,isLoading:!0,...x}:x},v=V(),p=U(),b=l(v),J=v===p?b:l(p);let g=b;return[()=>{const _=l(V());return Ct(_,g)?(g.data=_.data,g.isLoading=_.isLoading,g.isValidating=_.isValidating,g.error=_.error,g):(g=_,_)},()=>J]},[s,r]),z=Qt.useSyncExternalStore(S.useCallback(f=>tt(r,(l,v)=>{Ct(v,l)||f()}),[s,r]),yt[0],yt[1]),At=!K.current,Kt=R[r]&&R[r].length>0,B=z.data,H=i(B)?G&&$t(G)?Et(G):G:B,et=z.error,it=S.useRef(H),nt=T?i(B)?i(it.current)?H:it.current:B:H,bt=Kt&&!i(et)?!1:At&&!i(c)?c:d().isPaused()?!1:u?i(H)?!1:E:i(H)||E,It=!!(r&&e&&At&&bt),Gt=i(z.isValidating)?It:z.isValidating,Yt=i(z.isLoading)?It:z.isLoading,Y=S.useCallback(async f=>{const l=F.current;if(!r||!l||j.current||d().isPaused())return!1;let v,p,b=!0;const J=f||{},g=!h[r]||!J.dedupe,_=()=>Pt?!j.current&&r===O.current&&K.current:r===O.current,x={isValidating:!1,isLoading:!1},Vt=()=>{k(x)},Nt=()=>{const y=h[r];y&&y[1]===p&&delete h[r]},Ft={isValidating:!0};i(V().data)&&(Ft.isLoading=!0);try{if(g&&(k(Ft),n.loadingTimeout&&i(V().data)&&setTimeout(()=>{b&&_()&&d().onLoadingSlow(r,n)},n.loadingTimeout),h[r]=[l(Z),St()]),[v,p]=h[r],v=await v,g&&setTimeout(Nt,n.dedupingInterval),!h[r]||h[r][1]!==p)return g&&_()&&d().onDiscarded(r),!1;x.error=C;const y=I[r];if(!i(y)&&(p<=y[0]||p<=y[1]||y[1]===0))return Vt(),g&&_()&&d().onDiscarded(r),!1;const W=V().data;x.data=a(W,v)?W:v,g&&_()&&d().onSuccess(v,r,n)}catch(y){Nt();const W=d(),{shouldRetryOnError:at}=W;W.isPaused()||(x.error=y,g&&_()&&(W.onError(y,r,W),(at===!0||N(at)&&at(y))&&(!d().revalidateOnFocus||!d().revalidateOnReconnect||$())&&W.onErrorRetry(y,r,W,Xt=>{const ct=R[r];ct&&ct[0]&&ct[0](xt,Xt)},{retryCount:(J.retryCount||0)+1,dedupe:!0})))}return b=!1,Vt(),!0},[r,s]),Lt=S.useCallback((...f)=>zt(s,O.current,...f),[]);if(lt(()=>{F.current=e,L.current=n,i(B)||(it.current=B)}),lt(()=>{if(!r)return;const f=Y.bind(C,pt);let l=0;d().revalidateOnFocus&&(l=Date.now()+d().focusThrottleInterval);const p=Ce(r,R,(b,J={})=>{if(b==qt){const g=Date.now();d().revalidateOnFocus&&g>l&&$()&&(l=g+d().focusThrottleInterval,f())}else if(b==Ut)d().revalidateOnReconnect&&$()&&f();else{if(b==Ht)return Y();if(b==xt)return Y(J)}});return j.current=!1,O.current=r,K.current=!0,k({_k:Z}),bt&&(h[r]||(i(H)||X?f():ae(f))),()=>{j.current=!0,p()}},[r]),lt(()=>{let f;function l(){const p=N(A)?A(V().data):A;p&&f!==-1&&(f=setTimeout(v,p))}function v(){!V().error&&(w||d().isVisible())&&(m||d().isOnline())?Y(pt).then(l):l()}return l(),()=>{f&&(clearTimeout(f),f=-1)}},[A,w,m,r]),S.useDebugValue(nt),u&&i(H)&&r){if(!Pt&&X)throw new Error("Fallback data is required when using Suspense in SSR.");F.current=e,L.current=n,j.current=!1;const f=ot[r];if(!i(f)){const l=Lt(f);Et(l)}if(i(et)){const l=Y(pt);i(nt)||(l.status="fulfilled",l.value=!0),Et(l)}else throw et}return{mutate:Lt,get data(){return D.data=!0,nt},get error(){return D.error=!0,et},get isValidating(){return D.isValidating=!0,Gt},get isLoading(){return D.isLoading=!0,Yt}}},Le=_e(ye);export{pe as m,Le as u};
