import{k as e,a as he,e as xe,r as o,ie as g,aG as b,q as P,v as j,cC as W,g as N,t as G,i9 as T,S as I,F as z,aF as w,aU as $,ay as M,I as Q,n as v,cP as K,d as A,aI as C,aw as f,aC as O,iS as U,aH as J,m as X,cQ as Y,cd as Z,cc as ee,az as te,aE as se,c as pe,p as me,it as ge,c9 as je}from"./index-CtazL8yi.js";import{u as we}from"./use-params-Bum5sHW6.js";import{C as ae}from"./custom-breadcrumbs-DCKI5EoT.js";import{T as ne}from"./table-pagination-custom-CrnkiCEU.js";import{R as oe}from"./rhf-autocomplete-on-enter-DMfNrNoq.js";import{g as re}from"./functions-BsdLjZ2v.js";import{a as ie,b as E,c as le,T as de}from"./TableRow-CfQY8bjO.js";import{T as c}from"./TableCell-DPzIV_vu.js";import{T as _}from"./table-body-rowinfo-DLz3YlKp.js";import{C as ce}from"./Card-DTCuhoee.js";import{u as B,I as fe,P as be}from"./PageProvider-C-6fYvmz.js";import{T as ye,a as Se,b as q}from"./TabPanel-DIvN1Gt7.js";import"./TablePagination-vGscDLpy.js";import"./LastPage-BNGOmTNl.js";import"./FormControlLabel-DFxx6sAy.js";import"./errors-wZ747Yys.js";function Pe(){return e.jsx(ae,{heading:"Inventory On Hands",links:[{name:"Stock Overview",href:"#"},{name:"On Hands",href:"#"}],sx:{mb:{xs:3,md:5}}})}const Te=async({store_id:t,keyword:s,status:r,page:n})=>{try{return(await he.get(`${xe.stock_overview.onhands}`)).data}catch(i){throw console.error("OnHandsGetList - error : ",i),new Error("something wrong")}},ue=o.createContext(void 0),V=()=>{const t=o.useContext(ue);if(t===void 0)throw new Error("useContextPage must be used within a PageContext.Provider - onhands-page.tsx");return t},ve=({children:t})=>{const[s,r]=o.useState({keyword:"",store:{id:"",name:""},status:g.all}),n=m=>{r(m)},[i,l]=o.useState(0),u=()=>l(m=>m+1),[d,x]=o.useState(0),y=m=>{x(m)},[a,h]=o.useState(0),k=m=>{h(m)},S=o.useMemo(()=>({onHandsSearch:s,updateOnHandsSearch:n,refreshFlag:i,triggerRefresh:u,page:d,updatePage:y,rowsPerPage:a,updateRowsPerPage:k}),[s,i,d,a]);return e.jsx(ue.Provider,{value:S,children:t})},ke=P({keyword:j(),store:P({id:j(),name:j()}),status:P({id:W(Object.values(g),{message:"invalid survey status!"}),name:j()})}),Ce={keyword:"",store:{id:"",name:""},status:{id:g.all,name:b(g.all)}};function Oe(){const{onHandsSearch:t,updateOnHandsSearch:s}=V(),r=N({resolver:G(ke),defaultValues:Ce}),{control:n,reset:i,handleSubmit:l}=r,u=T({control:n,name:"store"}),d=T({control:n,name:"status"}),x=T({control:n,name:"keyword"});o.useEffect(()=>{i({store:{id:t.store.id,name:t.store.name},status:{id:t.status,name:b(t.status)},keyword:t?.keyword})},[t]),o.useEffect(()=>{u&&t.store.id!==u.id&&s({...t,store:u})},[u,t]),o.useEffect(()=>{t.status!==d.id&&s({...t,status:d.id})},[d,t]),o.useEffect(()=>{const a=setTimeout(()=>{x===""&&s({...t,keyword:""})},300);return()=>clearTimeout(a)},[x]);const y=async a=>{s({...t,keyword:a.keyword})};return e.jsx(I,{sx:{p:2.5},children:e.jsxs(z,{methods:r,onSubmit:l(y),children:[e.jsx("button",{style:{display:"none"},type:"submit"}),e.jsxs(w,{container:!0,spacing:2,children:[e.jsx(w,{xs:12,lg:3,children:e.jsx(oe,{name:"store",debounceSearch:!0,label:"Store",isOptionEqualToValue:(a,h)=>a?.id===h?.id,getOptionLabel:a=>a?.name,fetchFunction:async a=>{const h=await re({keyword:x,page:1});return console.log(h.data),h.data}})}),e.jsx(w,{xs:12,lg:3,children:e.jsx($,{label:"Status",name:"status",getOptionKey:a=>a.id,getOptionLabel:a=>a.name,isOptionEqualToValue:(a,h)=>a.id===h.id,options:Object.values(g).map(a=>({id:a,name:b(a)}))})}),e.jsx(w,{xs:12,lg:6,children:e.jsx(M,{size:"medium",name:"keyword",tooltipTitle:"press enter",placeholder:"Search...",InputProps:{startAdornment:e.jsx(Q,{position:"start",children:e.jsx(v,{icon:"eva:search-fill",sx:{color:"text.disabled"}})})}})})]})]})})}const F=[{id:"order_no",label:"Order No",width:"10%"},{id:"order_date",label:"Date",width:"10%"},{id:"due_date",label:"Due date",width:"10%"},{id:"customer",label:"Customer",width:"10%"},{id:"store",label:"Store",width:"10%"},{id:"shipping",label:"Shipping",width:"10%"},{id:"qty",label:"Qty",width:"10%"},{id:"status",label:"Status",width:"10%"},{id:"action",width:""}];function _e(){return e.jsx(ie,{children:e.jsx(E,{children:F.map(t=>e.jsx(c,{align:t.align||"left",sortDirection:!1,sx:{width:t.width,minWidth:0},children:t.label},t.id))})})}function Ie({no:t,row:s}){const r=K(),{checkAbilities:n}=A();return e.jsxs(E,{hover:!0,children:[e.jsx(c,{sx:{whiteSpace:"nowrap"},children:s.order_no}),e.jsx(c,{sx:{whiteSpace:"nowrap"},children:C(s.order_date)}),e.jsx(c,{sx:{whiteSpace:"nowrap"},children:C(s.due_date)}),e.jsx(c,{sx:{whiteSpace:"nowrap"},children:e.jsxs(I,{sx:{typography:"body2",flex:"1 1 auto",alignItems:"flex-start"},children:[e.jsx(f,{component:"span",sx:{color:"text.default"},children:s.customer_name}),e.jsx(f,{component:"span",sx:{color:"text.disabled"},children:s.customer_email}),e.jsx(f,{component:"span",sx:{color:"text.disabled"},children:s.customer_phone})]})}),e.jsx(c,{sx:{whiteSpace:"nowrap"},children:s.store_name}),e.jsx(c,{sx:{whiteSpace:"nowrap"},children:e.jsx(O,{variant:"soft",color:"default",children:U(s.shipping_type)})}),e.jsx(c,{sx:{whiteSpace:"nowrap"},children:s.qty}),e.jsx(c,{sx:{whiteSpace:"nowrap"},children:e.jsx(O,{variant:"soft",color:J(s.status),children:b(s.status)})}),e.jsxs(c,{sx:{whiteSpace:"nowrap"},children:[n?.("onhands:send-to-surveyor")&&e.jsx(X,{color:r.open?"inherit":"default",onClick:r.onOpen,children:e.jsx(v,{icon:"eva:more-vertical-fill"})}),e.jsx(Y,{open:r.open,anchorEl:r.anchorEl,onClose:r.onClose,slotProps:{arrow:{placement:"right-top"}},children:e.jsx(Z,{children:e.jsxs(ee,{onClick:()=>{},children:[e.jsx(v,{icon:"mynaui:send-solid"}),"Send to surveyor"]})})})]})]})}function Ee({rows:t,status:s}){const{page:r,rowsPerPage:n}=V();return e.jsx(le,{children:s==="loading"?e.jsx(_,{colspan:F.length,text:"loading .."}):t.length===0?e.jsx(_,{colspan:F.length,text:"data not found"}):t.map((i,l)=>e.jsx(Ie,{row:i,no:(r-1)*n+l+1},l))})}function He(){const{onHandsSearch:t,refreshFlag:s,updatePage:r,updateRowsPerPage:n}=V(),[i,l]=o.useState(0),[u,d]=o.useState(0),[x,y]=o.useState(15),[a,h]=o.useState([]),[k,S]=o.useState(!1),m=async()=>{S(!0),await Te({keyword:t.keyword,store_id:t.store.id,status:t.status,page:i+1}).then(p=>{h(p.data),d(p.total),l(p.current_page-1),r(p.current_page),n(x)}).finally(()=>{S(!1)})};o.useEffect(()=>{m()},[t.keyword,t.store,t.status,s,i]);const H=(p,R)=>{l(R)},L=p=>{l(0)};return e.jsxs(ce,{children:[e.jsx(Oe,{}),e.jsx(f,{sx:{position:"relative"},children:e.jsx(te,{children:e.jsxs(de,{size:"medium",sx:{minWidth:0},children:[e.jsx(_e,{}),e.jsx(Ee,{rows:a,status:k?"loading":"finish"})]})})}),e.jsx(ne,{dense:!1,page:i,count:u,rowsPerPage:15,rowsPerPageOptions:[15,25,100],onPageChange:H,onRowsPerPageChange:L})]})}function Le(){return e.jsx(ve,{children:e.jsxs(se,{maxWidth:"xl",children:[e.jsx(Pe,{}),e.jsx(He,{})]})})}const Re=P({keyword:j(),store:P({id:j(),name:j()}),status:P({id:W(Object.values(g),{message:"invalid survey status!"}),name:j()})}),Fe={keyword:"",store:{id:"",name:""},status:{id:g.all,name:b(g.all)}};function De(){const{inTransitSearch:t,updateInTransitSearch:s}=B(),r=N({resolver:G(Re),defaultValues:Fe}),{control:n,reset:i,handleSubmit:l}=r,u=T({control:n,name:"store"}),d=T({control:n,name:"status"}),x=T({control:n,name:"keyword"});o.useEffect(()=>{i({keyword:t?.keyword,status:{id:t.status,name:b(t.status)}})},[t]),o.useEffect(()=>{u&&t.store.id!==u.id&&s({...t,store:u})},[u,t]),o.useEffect(()=>{t.status!==d.id&&s({...t,status:d.id})},[d,t]),o.useEffect(()=>{const a=setTimeout(()=>{x===""&&s({...t,keyword:""})},300);return()=>clearTimeout(a)},[x]);const y=async a=>{s({...t,keyword:a.keyword})};return e.jsx(I,{sx:{p:2.5},children:e.jsxs(z,{methods:r,onSubmit:l(y),children:[e.jsx("button",{style:{display:"none"},type:"submit"}),e.jsxs(w,{container:!0,spacing:2,children:[e.jsx(w,{xs:12,lg:3,children:e.jsx(oe,{name:"store",debounceSearch:!0,label:"Store",isOptionEqualToValue:(a,h)=>a?.id===h?.id,getOptionLabel:a=>a?.name,fetchFunction:async a=>(await re({keyword:x,page:1})).data})}),e.jsx(w,{xs:12,lg:3,children:e.jsx($,{label:"Status",name:"status",getOptionKey:a=>a.id,getOptionLabel:a=>a.name,isOptionEqualToValue:(a,h)=>a.id===h.id,options:Object.values(g).map(a=>({id:a,name:b(a)}))})}),e.jsx(w,{xs:12,lg:6,children:e.jsx(M,{size:"medium",name:"keyword",tooltipTitle:"press enter",placeholder:"Search...",InputProps:{startAdornment:e.jsx(Q,{position:"start",children:e.jsx(v,{icon:"eva:search-fill",sx:{color:"text.disabled"}})})}})})]})]})})}const D=[{id:"order_no",label:"Order No",width:"10%"},{id:"order_date",label:"Date",width:"10%"},{id:"due_date",label:"Due date",width:"10%"},{id:"customer",label:"Customer",width:"10%"},{id:"store",label:"Store",width:"10%"},{id:"shipping",label:"Shipping",width:"10%"},{id:"qty",label:"Qty",width:"10%"},{id:"status",label:"Status",width:"10%"},{id:"action",width:""}];function Ae(){return e.jsx(ie,{children:e.jsx(E,{children:D.map(t=>e.jsx(c,{align:t.align||"left",sortDirection:!1,sx:{width:t.width,minWidth:0},children:t.label},t.id))})})}function Be({no:t,row:s}){const r=pe(),n=K(),{checkAbilities:i}=A(),l=()=>{r.push(me.dashboard.inventory.stock_overview.in_transit_detail(s.order_id))};return e.jsxs(E,{hover:!0,children:[e.jsx(c,{sx:{whiteSpace:"nowrap"},children:s.order_no}),e.jsx(c,{sx:{whiteSpace:"nowrap"},children:C(s.order_date)}),e.jsx(c,{sx:{whiteSpace:"nowrap"},children:C(s.due_date)}),e.jsx(c,{sx:{whiteSpace:"nowrap"},children:e.jsxs(I,{sx:{typography:"body2",flex:"1 1 auto",alignItems:"flex-start"},children:[e.jsx(f,{component:"span",sx:{color:"text.default"},children:s.customer_name}),e.jsx(f,{component:"span",sx:{color:"text.disabled"},children:s.customer_email}),e.jsx(f,{component:"span",sx:{color:"text.disabled"},children:s.customer_phone})]})}),e.jsx(c,{sx:{whiteSpace:"nowrap"},children:s.store_name}),e.jsx(c,{sx:{whiteSpace:"nowrap"},children:e.jsx(O,{variant:"soft",color:"default",children:U(s.shipping_type)})}),e.jsx(c,{sx:{whiteSpace:"nowrap"},children:s.qty}),e.jsx(c,{sx:{whiteSpace:"nowrap"},children:e.jsx(O,{variant:"soft",color:J(s.status),children:b(s.status)})}),e.jsxs(c,{sx:{whiteSpace:"nowrap"},children:[i?.("intransit:view-detail")&&e.jsx(X,{color:n.open?"inherit":"default",onClick:n.onOpen,children:e.jsx(v,{icon:"eva:more-vertical-fill"})}),e.jsx(Y,{open:n.open,anchorEl:n.anchorEl,onClose:n.onClose,slotProps:{arrow:{placement:"right-top"}},children:e.jsx(Z,{children:e.jsxs(ee,{onClick:l,children:[e.jsx(v,{icon:"solar:eye-bold"}),"View detail"]})})})]})]})}function Ve({rows:t,status:s}){const{page:r,rowsPerPage:n}=B();return e.jsx(le,{children:s==="loading"?e.jsx(_,{colspan:D.length,text:"loading .."}):t.length===0?e.jsx(_,{colspan:D.length,text:"data not found"}):t.map((i,l)=>e.jsx(Be,{row:i,no:(r-1)*n+l+1},l))})}function qe(){const{inTransitSearch:t,refreshFlag:s,updatePage:r,updateRowsPerPage:n}=B(),[i,l]=o.useState(0),[u,d]=o.useState(0),[x,y]=o.useState(15),[a,h]=o.useState([]),[k,S]=o.useState(!1),m=async()=>{S(!0),await fe({keyword:t.keyword,store_id:t.store.id,status:t.status,page:i+1}).then(p=>{h(p.data),d(p.total),l(p.current_page-1),r(p.current_page),n(x)}).finally(()=>{S(!1)})};o.useEffect(()=>{m()},[t.keyword,t.store,t.status,s,i]);const H=(p,R)=>{l(R)},L=p=>{l(0)};return e.jsxs(ce,{children:[e.jsx(De,{}),e.jsx(f,{sx:{position:"relative"},children:e.jsx(te,{children:e.jsxs(de,{size:"medium",sx:{minWidth:0},children:[e.jsx(Ae,{}),e.jsx(Ve,{rows:a,status:k?"loading":"finish"})]})})}),e.jsx(ne,{dense:!1,page:i,count:u,rowsPerPage:15,rowsPerPageOptions:[15,25,100],onPageChange:H,onRowsPerPageChange:L})]})}function We(){return e.jsx(ae,{heading:"Inventory In Transit",links:[{name:"Stock Overview",href:"#"},{name:"In Transit",href:"#"}],sx:{mb:{xs:3,md:5}}})}function Ne(){return e.jsxs(e.Fragment,{children:[e.jsx(We,{}),e.jsx(qe,{})]})}function Ge(){return e.jsx(se,{maxWidth:"xl",children:e.jsx(be,{children:e.jsx(Ne,{})})})}function rt(){const{tab_name:t=""}=we(),{checkAbilities:s}=A(),r=[{value:"onhands",label:"On Hands",show:s?.("onhands:view")},{value:"intransit",label:"In Transit",show:s?.("intransit:view")}],n=r.find(d=>d.show),[i,l]=o.useState(t===""?n?.value??"":t),u=(d,x)=>{l(x)};return e.jsxs(ye,{value:i,children:[e.jsx(ge,{maxWidth:"xl",children:e.jsx(Se,{onChange:u,children:r.map(d=>d.show&&e.jsx(je,{value:d.value,label:d.label},d.value))})}),e.jsx(q,{value:"onhands",sx:{p:0},children:e.jsx(Le,{})}),e.jsx(q,{value:"intransit",sx:{p:0},children:e.jsx(Ge,{})})]})}export{rt as default};
