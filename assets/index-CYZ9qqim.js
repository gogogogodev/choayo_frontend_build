import{g3 as Le,r as l,k as e,b8 as Z,aw as j,S as y,bI as F,d2 as V,c_ as ee,bH as te,dk as re,fi as X,aP as Ee,cP as fe,f as P,aC as Ne,m as A,n as f,cQ as be,cd as je,cc as Q,ag as U,dC as ae,u as Re,gy as Ce,aL as z,dD as Ke,l as _,du as Ue,dg as Y,c3 as We,db as _e,bK as Pe,c6 as Be,dj as ze,gz as le,bE as oe,I as Me,c8 as He,fJ as Ge,az as ye,ci as Ve,a_ as ce,cS as Xe,c9 as Ye,bC as qe,da as Je,aY as Qe,dH as Ze,gm as es,gA as ss,aE as ns,aX as as,H as ts,C as rs}from"./index-CtazL8yi.js";import{K,c as os,g as ve,u as ke,C as is,d as ls,D as cs,a as ds,b as us,e as se,f as de,p as ps,r as ms,h as hs,M as xs,S as ue,i as gs,v as fs,j as pe,k as bs,T as js,l as Cs}from"./sortable.esm-DWkyAUDt.js";import{u as ys,m as N}from"./index-DFKKx7j5.js";import{E as vs}from"./empty-content-oGcGfW-8.js";import{u as we}from"./uuidv4-B4SGT1yQ.js";import{C as Se}from"./ClickAwayListener-C7IZGHa6.js";import{C as Te}from"./confirm-dialog-CEcgDmma.js";import{A as ks}from"./AvatarGroup-KAyacIty.js";import{L as ws}from"./ListItem-D6s2wHyy.js";import{u as Ss}from"./use-tabs-jGUpRlgU.js";import{u as Ts}from"./use-date-range-picker-By6KNeHq.js";import{C as Is}from"./custom-date-range-picker-vX0Wf5Y8.js";import{M as Ds}from"./preview-multi-file-DIDrQBye.js";import{U as Os}from"./upload-box-C6nTeGqy.js";import{u as Fs,L as As}from"./use-light-box-CftAMKOe.js";import{u as $s}from"./use-mocked-user-D4Y0Hvke.js";import{F as Ls}from"./FormGroup-3I9bsZvK.js";import{F as Ie}from"./FormControlLabel-DFxx6sAy.js";import{S as q}from"./Skeleton-fN5wJ-1g.js";import"./index-QBukoXJl.js";import"./DatePicker-BqHCM0PQ.js";import"./format-number-CSJE7oq6.js";import"./index-Cwjez_Mi.js";const ne=!1,$="",Es={revalidateIfStale:ne,revalidateOnFocus:ne,revalidateOnReconnect:ne};function Ns(){const{data:s,isLoading:n,error:a,isValidating:t}=ys($,Le,Es);return l.useMemo(()=>{const i=s?.board.tasks??{},h=s?.board.columns??[];return{board:{tasks:i,columns:h},boardLoading:n,boardError:a,boardValidating:t,boardEmpty:!n&&!h.length}},[s?.board.columns,s?.board.tasks,a,n,t])}async function Rs(s){N($,n=>{const{board:a}=n,t=[...a.columns,s],o={...a.tasks,[s.id]:[]};return{...n,board:{...a,columns:t,tasks:o}}},!1)}async function Ks(s,n){N($,a=>{const{board:t}=a,o=t.columns.map(i=>i.id===s?{...i,name:n}:i);return{...a,board:{...t,columns:o}}},!1)}async function Us(s){N($,n=>{const{board:a}=n;return{...n,board:{...a,columns:s}}},!1)}async function Ws(s){N($,n=>{const{board:a}=n,t={...a.tasks,[s]:[]};return{...n,board:{...a,tasks:t}}},!1)}async function _s(s){N($,n=>{const{board:a}=n,t=a.columns.filter(i=>i.id!==s),o=Object.keys(a.tasks).filter(i=>i!==s).reduce((i,h)=>(i[h]=a.tasks[h],i),{});return{...n,board:{...a,columns:t,tasks:o}}},!1)}async function Ps(s,n){N($,a=>{const{board:t}=a,o={...t.tasks,[s]:[n,...t.tasks[s]]};return{...a,board:{...t,tasks:o}}},!1)}async function Bs(s,n){N($,a=>{const{board:t}=a,i=t.tasks[s].map(u=>u.id===n.id?{...u,...n}:u),h={...t.tasks,[s]:i};return{...a,board:{...t,tasks:h}}},!1)}async function me(s){N($,n=>{const{board:a}=n;return{...n,board:{...a,tasks:s}}},!1)}async function zs(s,n){N($,a=>{const{board:t}=a,o={...t.tasks,[s]:t.tasks[s].filter(i=>i.id!==n)};return{...a,board:{...t,tasks:o}}},!1)}const g={item:"mnl__kanban__item",column:"mnl__kanban__column",itemWrap:"mnl__kanban__item__wrap",columnList:"mnl__kanban__column_list",state:{hover:"state-hover",fadeIn:"state-fade-in",sorting:"state-sorting",dragging:"state-dragging",disabled:"state-disabled",dragOverlay:"state-drag-overlay"}},Ms=[K.Down,K.Right,K.Up,K.Left],Hs=(s,{context:{active:n,droppableRects:a,droppableContainers:t,collisionRect:o}})=>{if(Ms.includes(s.code)){if(s.preventDefault(),!n||!o)return;const i=[];t.getEnabled().forEach(r=>{if(!r||r?.disabled)return;const p=a.get(r.id);if(!p)return;const m=r.data.current;if(m){const{type:w,children:x}=m;if(w==="container"&&x?.length>0&&n.data.current?.type!=="container")return}switch(s.code){case K.Down:o.top<p.top&&i.push(r);break;case K.Up:o.top>p.top&&i.push(r);break;case K.Left:o.left>=p.left+p.width&&i.push(r);break;case K.Right:o.left+o.width<=p.left&&i.push(r);break}});const h=os({collisionRect:o,droppableRects:a,droppableContainers:i}),u=ve(h,"id");if(u!=null){const r=t.get(u),p=r?.node.current,m=r?.rect.current;if(p&&m)return r.id==="placeholder"?{x:m.left+(m.width-o.width)/2,y:m.top+(m.height-o.height)/2}:r.data.current?.type==="container"?{x:m.left+20,y:m.top+74}:{x:m.left,y:m.top}}}},Gs=Z(y)(({theme:s})=>({flexShrink:0,height:"100%",borderWidth:1,position:"relative",borderStyle:"solid",borderColor:"transparent",padding:"var(--column-padding)",borderRadius:"var(--column-radius)",backgroundColor:s.vars.palette.background.neutral,[V.dark]:{backgroundColor:s.vars.palette.grey[800]},"&::before":{top:0,left:0,content:'""',width:"100%",height:"100%",position:"absolute",borderRadius:"inherit",backgroundColor:"transparent",transition:s.transitions.create(["background-color"])},[`&.${g.state.hover}`]:{"&::before":{backgroundColor:F(s.vars.palette.grey["500Channel"],.08),[V.dark]:{backgroundColor:F(s.vars.palette.grey["500Channel"],.16)}}},[`&.${g.state.dragOverlay}`]:{backdropFilter:"blur(6px)",borderColor:F(s.vars.palette.grey["500Channel"],.08),backgroundColor:F(s.vars.palette.background.neutralChannel,.48),[V.dark]:{backgroundColor:F(s.vars.palette.grey["800Channel"],.48)}},[`&.${g.state.dragging}`]:{opacity:0}})),Vs=l.forwardRef(({slots:s,stateProps:n,sx:a,...t},o)=>{const i=g.column.concat(n?.hover&&` ${g.state.hover}`||n?.dragOverlay&&` ${g.state.dragOverlay}`||n?.dragging&&` ${g.state.dragging}`||"");return e.jsxs(Gs,{ref:o,className:i,sx:{gap:2.5,width:"var(--column-width)",...a},...t,children:[s?.header&&s.header,s?.action&&s?.action,s?.main&&e.jsx(j,{component:"ul",className:g.columnList,sx:{minHeight:80,display:"flex",gap:"var(--item-gap)",flexDirection:"column"},children:s.main})]})}),De=l.memo(Vs);function Xs({status:s,openAddTask:n,onAddTask:a,onCloseAddTask:t}){const[o,i]=l.useState(""),h=l.useMemo(()=>({id:we(),status:s,name:o.trim()?o:"Untitled",priority:"medium",attachments:[],labels:[],comments:[],assignee:[],due:[null,null],reporter:{id:ee.id(16),name:ee.fullName(16),avatarUrl:ee.image.avatar(16)}}),[s,o]),u=l.useCallback(m=>{i(m.target.value)},[]),r=l.useCallback(m=>{m.key==="Enter"&&(a(h),i(""))},[h,a]),p=l.useCallback(()=>{i(""),t()},[t]);return n?e.jsx(Se,{onClickAway:p,children:e.jsxs("div",{children:[e.jsx(te,{sx:{borderRadius:1.5,bgcolor:"background.default",boxShadow:m=>m.customShadows.z1},children:e.jsx(re,{autoFocus:!0,fullWidth:!0,placeholder:"Untitled",value:o,onChange:u,onKeyUp:r,sx:{px:2,height:56,[`& .${X.input}`]:{p:0,typography:"subtitle2"}}})}),e.jsx(Ee,{sx:{mx:1},children:"Press Enter to create the task."})]})}):null}function Oe({sx:s,...n}){return e.jsx(re,{sx:{[`&.${X.root}`]:{py:.75,borderRadius:1,typography:"h6",borderWidth:2,borderStyle:"solid",borderColor:"transparent",transition:a=>a.transitions.create(["padding-left","border-color"]),[`&.${X.focused}`]:{pl:.75,borderColor:"text.primary"}},[`& .${X.input}`]:{typography:"h6"},...s},...n})}function Fe({columnName:s,totalTasks:n,handleProps:a,onClearColumn:t,onToggleAddTask:o,onDeleteColumn:i,onUpdateColumn:h}){const u=l.useRef(null),r=fe(),p=P(),[m,w]=l.useState(s);l.useEffect(()=>{r.open&&u.current&&u.current.focus()},[r.open]);const x=l.useCallback(T=>{w(T.target.value)},[]),S=l.useCallback(T=>{T.key==="Enter"&&(u.current&&u.current.blur(),h?.(m))},[m,h]);return e.jsxs(e.Fragment,{children:[e.jsxs(y,{direction:"row",alignItems:"center",children:[e.jsx(Ne,{sx:{borderRadius:"50%",borderColor:T=>F(T.vars.palette.grey["500Channel"],.24)},children:n}),e.jsx(Oe,{inputRef:u,placeholder:"Column name",value:m,onChange:x,onKeyUp:S,inputProps:{id:`input-column-${m}`},sx:{mx:1}}),e.jsx(A,{size:"small",color:"inherit",onClick:o,children:e.jsx(f,{icon:"solar:add-circle-bold"})}),e.jsx(A,{size:"small",color:r.open?"inherit":"default",onClick:r.onOpen,children:e.jsx(f,{icon:"solar:menu-dots-bold-duotone"})}),e.jsx(A,{size:"small",...a,children:e.jsx(f,{icon:"nimbus:drag-dots"})})]}),e.jsx(be,{open:r.open,anchorEl:r.anchorEl,onClose:r.onClose,children:e.jsxs(je,{children:[e.jsxs(Q,{onClick:r.onClose,children:[e.jsx(f,{icon:"solar:pen-bold"}),"Rename"]}),e.jsxs(Q,{onClick:()=>{t?.(),r.onClose()},children:[e.jsx(f,{icon:"solar:eraser-bold"}),"Clear"]}),e.jsxs(Q,{onClick:()=>{p.onTrue(),r.onClose()},sx:{color:"error.main"},children:[e.jsx(f,{icon:"solar:trash-bin-trash-bold"}),"Delete"]})]})}),e.jsx(Te,{open:p.value,onClose:p.onFalse,title:"Delete",content:e.jsxs(e.Fragment,{children:["Are you sure want to delete column?",e.jsxs(j,{sx:{typography:"caption",color:"error.main",mt:2},children:[e.jsx("strong",{children:" NOTE: "})," All tasks related to this category will also be deleted."]})]}),action:e.jsx(U,{variant:"contained",color:"error",onClick:()=>{i?.(),p.onFalse()},children:"Delete"})})]})}function Ys({children:s,column:n,tasks:a,disabled:t,sx:o}){const i=P(),{attributes:h,isDragging:u,listeners:r,setNodeRef:p,transition:m,active:w,over:x,transform:S}=ke({id:n.id,data:{type:"container",children:a},animateLayoutChanges:qs}),T=a.map(c=>c.id),L=x?n.id===x.id&&w?.data.current?.type!=="container"||T.includes(x.id):!1,v=l.useCallback(async c=>{try{n.name!==c&&(Ks(n.id,c),ae.success("Update success!",{position:"top-center"}))}catch(b){console.error(b)}},[n.id,n.name]),M=l.useCallback(async()=>{try{Ws(n.id)}catch(c){console.error(c)}},[n.id]),H=l.useCallback(async()=>{try{_s(n.id),ae.success("Delete success!",{position:"top-center"})}catch(c){console.error(c)}},[n.id]),G=l.useCallback(async c=>{try{Ps(n.id,c),i.onFalse()}catch(b){console.error(b)}},[n.id,i]);return e.jsx(De,{ref:t?void 0:p,sx:{transition:m,transform:is.Translate.toString(S),...o},stateProps:{dragging:u,hover:L,handleProps:{...h,...r}},slots:{header:e.jsx(Fe,{handleProps:{...h,...r},totalTasks:a.length,columnName:n.name,onUpdateColumn:v,onClearColumn:M,onDeleteColumn:H,onToggleAddTask:i.onToggle}),main:e.jsx(e.Fragment,{children:s}),action:e.jsx(Xs,{status:n.name,openAddTask:i.value,onAddTask:G,onCloseAddTask:i.onFalse})}})}const qs=s=>ls({...s,wasDragging:!0}),Js=Z(ws)(()=>({"@keyframes fadeIn":{"0%":{opacity:0},"100%":{opacity:1}},transform:"translate3d(var(--translate-x, 0), var(--translate-y, 0), 0) scaleX(var(--scale-x, 1)) scaleY(var(--scale-y, 1))",transformOrigin:"0 0",touchAction:"manipulation",[`&.${g.state.fadeIn}`]:{animation:"fadeIn 500ms ease"},[`&.${g.state.dragOverlay}`]:{zIndex:999}})),Qs=Z(y)(({theme:s})=>({width:"100%",cursor:"grab",outline:"none",overflow:"hidden",position:"relative",transformOrigin:"50% 50%",touchAction:"manipulation",boxShadow:s.customShadows.z1,borderRadius:"var(--item-radius)",WebkitTapHighlightColor:"transparent",backgroundColor:s.vars.palette.common.white,transition:s.transitions.create(["box-shadow"]),[V.dark]:{backgroundColor:s.vars.palette.grey[900]},[`&.${g.state.disabled}`]:{},[`&.${g.state.sorting}`]:{},[`&.${g.state.dragOverlay}`]:{backdropFilter:"blur(6px)",boxShadow:s.customShadows.z20,backgroundColor:F(s.vars.palette.common.whiteChannel,.48),[V.dark]:{backgroundColor:F(s.vars.palette.grey["900Channel"],.48)}},[`&.${g.state.dragging}`]:{opacity:.2,filter:"grayscale(1)"}})),Zs=l.forwardRef(({task:s,stateProps:n,sx:a,...t},o)=>{const i=Re();l.useEffect(()=>{if(n?.dragOverlay)return document.body.style.cursor="grabbing",()=>{document.body.style.cursor=""}},[n?.dragOverlay]);const h=g.itemWrap.concat(n?.fadeIn&&` ${g.state.fadeIn}`||n?.dragOverlay&&` ${g.state.dragOverlay}`||""),u=g.item.concat(n?.dragging&&` ${g.state.dragging}`||n?.disabled&&` ${g.state.disabled}`||n?.sorting&&` ${g.state.sorting}`||n?.dragOverlay&&` ${g.state.dragOverlay}`||""),r=e.jsx(f,{icon:s.priority==="low"&&"solar:double-alt-arrow-down-bold-duotone"||s.priority==="medium"&&"solar:double-alt-arrow-right-bold-duotone"||"solar:double-alt-arrow-up-bold-duotone",sx:{top:4,right:4,position:"absolute",...s.priority==="low"&&{color:"info.main"},...s.priority==="medium"&&{color:"warning.main"},...s.priority==="hight"&&{color:"error.main"}}}),p=!!s?.attachments?.length&&e.jsx(j,{sx:{p:i.spacing(1,1,0,1)},children:e.jsx(j,{component:"img",className:Ce.root,alt:s?.attachments?.[0],src:s?.attachments?.[0],sx:{width:320,height:"auto",borderRadius:1.5,aspectRatio:"4/3",objectFit:"cover"}})}),m=e.jsxs(y,{direction:"row",alignItems:"center",children:[e.jsxs(y,{flexGrow:1,direction:"row",alignItems:"center",sx:{typography:"caption",color:"text.disabled"},children:[e.jsx(f,{width:16,icon:"solar:chat-round-dots-bold",sx:{mr:.25}}),e.jsx(j,{component:"span",sx:{mr:1},children:s?.comments?.length}),e.jsx(f,{width:16,icon:"eva:attach-2-fill",sx:{mr:.25}}),e.jsx(j,{component:"span",children:s?.attachments?.length})]}),e.jsx(ks,{sx:{[`& .${Ke.avatar}`]:{width:24,height:24}},children:s?.assignee?.map(w=>e.jsx(z,{alt:w.name,src:w.avatarUrl},w.id))})]});return e.jsx(Js,{ref:o,disablePadding:!0,className:h,sx:{...!!n?.transition&&{transition:n.transition},...!!n?.transform&&{"--translate-x":`${Math.round(n.transform.x)}px`,"--translate-y":`${Math.round(n.transform.y)}px`,"--scale-x":`${n.transform.scaleX}`,"--scale-y":`${n.transform.scaleY}`}},children:e.jsxs(Qs,{className:u,"data-cypress":"draggable-item",sx:a,tabIndex:0,...n?.listeners,...t,children:[p,e.jsxs(y,{spacing:2,sx:{px:2,py:2.5,position:"relative"},children:[r,e.jsx(_,{variant:"subtitle2",children:s.name}),m]})]})})}),ie=l.memo(Zs);function en({liked:s,onLike:n,taskName:a,onDelete:t,taskStatus:o,onCloseDetails:i}){const h=Ue("up","sm"),u=P(),r=fe(),[p,m]=l.useState(o),w=l.useCallback(x=>{r.onClose(),m(x)},[r]);return e.jsxs(e.Fragment,{children:[e.jsxs(y,{direction:"row",alignItems:"center",sx:{p:x=>x.spacing(2.5,1,2.5,2.5),borderBottom:x=>`solid 1px ${x.vars.palette.divider}`},children:[!h&&e.jsx(Y,{title:"Back",children:e.jsx(A,{onClick:i,sx:{mr:1},children:e.jsx(f,{icon:"eva:arrow-ios-back-fill"})})}),e.jsx(U,{size:"small",variant:"soft",endIcon:e.jsx(f,{icon:"eva:arrow-ios-downward-fill",width:16,sx:{ml:-.5}}),onClick:r.onOpen,children:p}),e.jsxs(y,{direction:"row",justifyContent:"flex-end",flexGrow:1,children:[e.jsx(Y,{title:"Like",children:e.jsx(A,{color:s?"default":"primary",onClick:n,children:e.jsx(f,{icon:"ic:round-thumb-up"})})}),e.jsx(Y,{title:"Delete task",children:e.jsx(A,{onClick:u.onTrue,children:e.jsx(f,{icon:"solar:trash-bin-trash-bold"})})}),e.jsx(A,{children:e.jsx(f,{icon:"eva:more-vertical-fill"})})]})]}),e.jsx(be,{open:r.open,anchorEl:r.anchorEl,onClose:r.onClose,slotProps:{arrow:{placement:"top-right"}},children:e.jsx(je,{children:["To do","In progress","Ready to test","Done"].map(x=>e.jsx(Q,{selected:p===x,onClick:()=>{w(x)},children:x},x))})}),e.jsx(Te,{open:u.value,onClose:u.onFalse,title:"Delete",content:e.jsxs(e.Fragment,{children:["Are you sure want to delete ",e.jsxs("strong",{children:[" ",a," "]}),"?"]}),action:e.jsx(U,{variant:"contained",color:"error",onClick:t,children:"Delete"})})]})}function sn({priority:s,onChangePriority:n}){return e.jsx(y,{direction:"row",flexWrap:"wrap",spacing:1,children:["low","medium","hight"].map(a=>e.jsxs(We,{onClick:()=>n(a),sx:{py:.5,pl:.75,pr:1.25,fontSize:12,borderRadius:1,lineHeight:"20px",textTransform:"capitalize",fontWeight:"fontWeightBold",boxShadow:t=>`inset 0 0 0 1px ${F(t.vars.palette.grey["500Channel"],.24)}`,...a===s&&{boxShadow:t=>`inset 0 0 0 2px ${t.vars.palette.text.primary}`}},children:[e.jsx(f,{icon:a==="low"&&"solar:double-alt-arrow-down-bold-duotone"||a==="medium"&&"solar:double-alt-arrow-right-bold-duotone"||"solar:double-alt-arrow-up-bold-duotone",sx:{mr:.5,...a==="low"&&{color:"info.main"},...a==="medium"&&{color:"warning.main"},...a==="hight"&&{color:"error.main"}}}),a]},a))})}function nn({attachments:s}){const[n,a]=l.useState(s),t=l.useCallback(i=>{a([...n,...i])},[n]),o=l.useCallback(i=>{const h=n.filter(u=>u!==i);a(h)},[n]);return e.jsx(Ds,{thumbnail:!0,files:n,onRemove:i=>o(i),slotProps:{thumbnail:{sx:{width:64,height:64}}},lastNode:e.jsx(Os,{onDrop:t})})}function an({comments:s}){const n=s.filter(t=>t.messageType==="image").map(t=>({src:t.message})),a=Fs(n);return e.jsxs(e.Fragment,{children:[e.jsx(y,{component:"ul",spacing:3,children:s.map(t=>e.jsxs(y,{component:"li",direction:"row",spacing:2,children:[e.jsx(z,{src:t.avatarUrl}),e.jsxs(y,{spacing:t.messageType==="image"?1:.5,flexGrow:1,children:[e.jsxs(y,{direction:"row",alignItems:"center",justifyContent:"space-between",children:[e.jsxs(_,{variant:"subtitle2",children:[" ",t.name]}),e.jsx(_,{variant:"caption",sx:{color:"text.disabled"},children:_e(t.createdAt)})]}),t.messageType==="image"?e.jsx(Pe,{alt:t.message,src:t.message,onClick:()=>a.onOpen(t.message),sx:{borderRadius:1.5,cursor:"pointer",transition:o=>o.transitions.create(["opacity"]),"&:hover":{opacity:.8}}}):e.jsx(_,{variant:"body2",children:t.message})]})]},t.id))}),e.jsx(As,{index:a.selected,slides:n,open:a.open,close:a.onClose})]})}function tn(){const{user:s}=$s();return e.jsxs(y,{direction:"row",spacing:2,sx:{py:3,px:2.5},children:[e.jsx(z,{src:s?.photoURL,alt:s?.displayName,children:s?.displayName?.charAt(0).toUpperCase()}),e.jsxs(te,{variant:"outlined",sx:{p:1,flexGrow:1,bgcolor:"transparent"},children:[e.jsx(re,{fullWidth:!0,multiline:!0,rows:2,placeholder:"Type a message",sx:{px:1}}),e.jsxs(y,{direction:"row",alignItems:"center",children:[e.jsxs(y,{direction:"row",flexGrow:1,children:[e.jsx(A,{children:e.jsx(f,{icon:"solar:gallery-add-bold"})}),e.jsx(A,{children:e.jsx(f,{icon:"eva:attach-2-fill"})})]}),e.jsx(U,{variant:"contained",children:"Comment"})]})]})]})}const he=64;function rn({assignee:s=[],open:n,onClose:a}){const[t,o]=l.useState(""),i=l.useCallback(r=>{o(r.target.value)},[]),h=on({inputData:le,query:t}),u=!h.length&&!!t;return e.jsxs(Be,{fullWidth:!0,maxWidth:"xs",open:n,onClose:a,children:[e.jsxs(ze,{sx:{pb:0},children:["Contacts ",e.jsxs(_,{component:"span",children:["(",le.length,")"]})]}),e.jsx(j,{sx:{px:3,py:2.5},children:e.jsx(oe,{fullWidth:!0,value:t,onChange:i,placeholder:"Search...",InputProps:{startAdornment:e.jsx(Me,{position:"start",children:e.jsx(f,{icon:"eva:search-fill",sx:{color:"text.disabled"}})})}})}),e.jsx(He,{sx:{p:0},children:u?e.jsx(Ge,{query:t,sx:{mt:3,mb:10}}):e.jsx(ye,{sx:{height:he*6,px:2.5},children:e.jsx(j,{component:"ul",children:h.map(r=>{const p=s.map(m=>m.name).includes(r.name);return e.jsxs(j,{component:"li",sx:{gap:2,display:"flex",height:he,alignItems:"center"},children:[e.jsx(z,{src:r.avatarUrl}),e.jsx(Ve,{primaryTypographyProps:{typography:"subtitle2",sx:{mb:.25}},secondaryTypographyProps:{typography:"caption"},primary:r.name,secondary:r.email}),e.jsx(U,{size:"small",color:p?"primary":"inherit",startIcon:e.jsx(f,{width:16,icon:p?"eva:checkmark-fill":"mingcute:add-line",sx:{mr:-.5}}),children:p?"Assigned":"Assign"})]},r.id)})})})})]})}function on({inputData:s,query:n}){return n&&(s=s.filter(a=>a.name.toLowerCase().indexOf(n.toLowerCase())!==-1||a.email.toLowerCase().indexOf(n.toLowerCase())!==-1)),s}const J=["Complete project proposal","Conduct market research","Design user interface mockups","Develop backend api","Implement authentication system"],W=Z("span")(({theme:s})=>({...s.typography.caption,width:100,flexShrink:0,color:s.vars.palette.text.secondary,fontWeight:s.typography.fontWeightSemiBold}));function ln({task:s,openDetails:n,onUpdateTask:a,onDeleteTask:t,onCloseDetails:o}){const i=Ss("overview"),[h,u]=l.useState(s.priority),[r,p]=l.useState(s.name),[m,w]=l.useState(J.slice(0,2)),x=P(),S=P(),[T,L]=l.useState(s.description),v=Ts(ce(s.due[0]),ce(s.due[1])),M=l.useCallback(d=>{p(d.target.value)},[]),H=l.useCallback(d=>{try{d.key==="Enter"&&r&&a({...s,name:r})}catch(R){console.error(R)}},[a,s,r]),G=l.useCallback(d=>{L(d.target.value)},[]),c=l.useCallback(d=>{u(d)},[]),b=d=>{const R=m.includes(d)?m.filter(O=>O!==d):[...m,d];w(R)},I=e.jsx(en,{liked:x.value,taskName:s.name,onLike:x.onToggle,onDelete:t,taskStatus:s.status,onCloseDetails:o}),C=e.jsx(Xe,{value:i.value,onChange:i.onChange,variant:"fullWidth",slotProps:{tab:{px:0}},children:[{value:"overview",label:"Overview"},{value:"subTasks",label:"Subtasks"},{value:"comments",label:`Comments (${s.comments.length})`}].map(d=>e.jsx(Ye,{value:d.value,label:d.label},d.value))}),k=e.jsxs(j,{sx:{gap:3,display:"flex",flexDirection:"column"},children:[e.jsx(Oe,{placeholder:"Task name",value:r,onChange:M,onKeyUp:H,inputProps:{id:`input-task-${r}`}}),e.jsxs(j,{sx:{display:"flex",alignItems:"center"},children:[e.jsx(W,{children:"Reporter"}),e.jsx(z,{alt:s.reporter.name,src:s.reporter.avatarUrl})]}),e.jsxs(j,{sx:{display:"flex"},children:[e.jsx(W,{sx:{height:40,lineHeight:"40px"},children:"Assignee"}),e.jsxs(j,{sx:{gap:1,display:"flex",flexWrap:"wrap"},children:[s.assignee.map(d=>e.jsx(z,{alt:d.name,src:d.avatarUrl},d.id)),e.jsx(Y,{title:"Add assignee",children:e.jsx(A,{onClick:S.onTrue,sx:{bgcolor:d=>F(d.vars.palette.grey["500Channel"],.08),border:d=>`dashed 1px ${d.vars.palette.divider}`},children:e.jsx(f,{icon:"mingcute:add-line"})})}),e.jsx(rn,{assignee:s.assignee,open:S.value,onClose:S.onFalse})]})]}),e.jsxs(j,{sx:{display:"flex"},children:[e.jsx(W,{sx:{height:24,lineHeight:"24px"},children:"Labels"}),!!s.labels.length&&e.jsx(j,{sx:{gap:1,display:"flex",flexWrap:"wrap"},children:s.labels.map(d=>e.jsx(qe,{color:"info",label:d,size:"small",variant:"soft"},d))})]}),e.jsxs(j,{sx:{display:"flex",alignItems:"center"},children:[e.jsx(W,{children:" Due date "}),v.selected?e.jsx(U,{size:"small",onClick:v.onOpen,children:v.shortLabel}):e.jsx(Y,{title:"Add due date",children:e.jsx(A,{onClick:v.onOpen,sx:{bgcolor:d=>F(d.vars.palette.grey["500Channel"],.08),border:d=>`dashed 1px ${d.vars.palette.divider}`},children:e.jsx(f,{icon:"mingcute:add-line"})})}),e.jsx(Is,{variant:"calendar",title:"Choose due date",startDate:v.startDate,endDate:v.endDate,onChangeStartDate:v.onChangeStartDate,onChangeEndDate:v.onChangeEndDate,open:v.open,onClose:v.onClose,selected:v.selected,error:v.error})]}),e.jsxs(j,{sx:{display:"flex",alignItems:"center"},children:[e.jsx(W,{children:"Priority"}),e.jsx(sn,{priority:h,onChangePriority:c})]}),e.jsxs(j,{sx:{display:"flex"},children:[e.jsx(W,{children:" Description "}),e.jsx(oe,{fullWidth:!0,multiline:!0,size:"small",minRows:4,value:T,onChange:G,InputProps:{sx:{typography:"body2"}}})]}),e.jsxs(j,{sx:{display:"flex"},children:[e.jsx(W,{children:"Attachments"}),e.jsx(nn,{attachments:s.attachments})]})]}),D=e.jsxs(j,{sx:{gap:3,display:"flex",flexDirection:"column"},children:[e.jsxs("div",{children:[e.jsxs(_,{variant:"body2",sx:{mb:1},children:[m.length," of ",J.length]}),e.jsx(Je,{variant:"determinate",value:m.length/J.length*100})]}),e.jsx(Ls,{children:J.map(d=>e.jsx(Ie,{control:e.jsx(Qe,{disableRipple:!0,name:d,checked:m.includes(d)}),label:d,onChange:()=>b(d)},d))}),e.jsx(U,{variant:"outlined",startIcon:e.jsx(f,{icon:"mingcute:add-line"}),sx:{alignSelf:"flex-start"},children:"Subtask"})]}),E=e.jsx(e.Fragment,{children:!!s.comments.length&&e.jsx(an,{comments:s.comments})});return e.jsxs(Ze,{open:n,onClose:o,anchor:"right",slotProps:{backdrop:{invisible:!0}},PaperProps:{sx:{width:{xs:1,sm:480}}},children:[I,C,e.jsxs(ye,{fillContent:!0,sx:{py:3,px:2.5},children:[i.value==="overview"&&k,i.value==="subTasks"&&D,i.value==="comments"&&E]}),i.value==="comments"&&e.jsx(tn,{})]})}function cn({task:s,disabled:n,columnId:a,sx:t}){const o=P(),{setNodeRef:i,listeners:h,isDragging:u,isSorting:r,transform:p,transition:m}=ke({id:s?.id}),w=dn(),x=u&&!w,S=l.useCallback(async()=>{try{zs(a,s.id),ae.success("Delete success!",{position:"top-center"})}catch(L){console.error(L)}},[a,s.id]),T=l.useCallback(async L=>{try{Bs(a,L)}catch(v){console.error(v)}},[a]);return e.jsxs(e.Fragment,{children:[e.jsx(ie,{ref:n?void 0:i,task:s,onClick:o.onTrue,stateProps:{transform:p,listeners:h,transition:m,sorting:r,dragging:u,fadeIn:x},sx:{...o.value&&{[`& .${Ce.root}`]:{opacity:.8}},...t}}),e.jsx(ln,{task:s,openDetails:o.value,onCloseDetails:o.onFalse,onUpdateTask:T,onDeleteTask:S})]})}function dn(){const[s,n]=l.useState(!1);return l.useEffect(()=>{const a=setTimeout(()=>n(!0),500);return()=>clearTimeout(a)},[]),s}function un({sx:s,...n}){const[a,t]=l.useState(""),o=P(),i=l.useCallback(p=>{t(p.target.value)},[]),h=l.useCallback(async()=>{try{const p={id:we(),name:a.trim()?a:"Untitled"};Rs(p),t(""),o.onFalse()}catch(p){console.error(p)}},[a,o]),u=l.useCallback(p=>{p.key==="Enter"&&h()},[h]),r=l.useCallback(()=>{t(""),o.onFalse()},[o]);return e.jsxs(e.Fragment,{children:[e.jsx(j,{sx:{width:"var(--column-width)",flex:"0 0 auto",...s},...n,children:o.value?e.jsx(Se,{onClickAway:r,children:e.jsx(oe,{autoFocus:!0,fullWidth:!0,placeholder:"Untitled",value:a,onChange:i,onKeyUp:u,helperText:"Press Enter to create the column.",sx:{[`& .${X.input}`]:{typography:"h6"}}})}):e.jsx(U,{fullWidth:!0,size:"large",color:"inherit",variant:"outlined",startIcon:e.jsx(f,{icon:"mingcute:add-line",sx:{mr:-.5}}),onClick:o.onTrue,children:"Add column"})}),e.jsx(j,{sx:{width:"1px",flexShrink:0}})]})}function pn({amount:s=3,sx:n,...a}){return[...Array(s)].map((t,o)=>e.jsxs(te,{variant:"outlined",sx:{display:"flex",gap:"var(--item-gap)",flexDirection:"column",p:"var(--column-padding)",width:"var(--column-width)",borderRadius:"var(--column-radius)",...n},...a,children:[e.jsx(q,{sx:{pt:"75%",borderRadius:1.5}}),[0].includes(o)&&e.jsx(q,{sx:{pt:"50%",borderRadius:1.5}}),[0,1].includes(o)&&e.jsx(q,{sx:{pt:"25%",borderRadius:1.5}}),[0,1,2].includes(o)&&e.jsx(q,{sx:{pt:"25%",borderRadius:1.5}})]},o))}const mn={sideEffects:ds({styles:{active:{opacity:"0.5"}}})};function hn({columns:s,tasks:n,activeId:a,sx:t}){const o=s.map(r=>r.id),i=s.find(r=>r.id===a),u=Object.values(n).flat().find(r=>r.id===a);return e.jsx(es,{children:e.jsx(cs,{adjustScale:!1,dropAnimation:mn,children:a?e.jsx(e.Fragment,{children:o.includes(a)?e.jsx(xn,{column:i,tasks:n[a],sx:t}):e.jsx(gn,{task:u,sx:t})}):null})})}function xn({column:s,tasks:n,sx:a}){return e.jsx(De,{slots:{header:e.jsx(Fe,{columnName:s.name,totalTasks:n.length}),main:n.map(t=>e.jsx(ie,{task:t},t.id))},stateProps:{dragOverlay:!0},sx:a})}function gn({task:s,sx:n}){return e.jsx(ie,{task:s,sx:n,stateProps:{dragOverlay:!0}})}const xe="placeholder",ge={"--item-gap":"16px","--item-radius":"12px","--column-gap":"24px","--column-width":"336px","--column-radius":"16px","--column-padding":"20px 16px 16px 16px"};function fn(){const{board:s,boardLoading:n,boardEmpty:a}=Ns(),[t,o]=l.useState(!0),i=l.useRef(!1),h=l.useRef(null),[u,r]=l.useState(null),p=s.columns.map(c=>c.id),m=u?p.includes(u):!1,w=us(se(Cs,{activationConstraint:{distance:5}}),se(js,{activationConstraint:{distance:5}}),se(bs,{coordinateGetter:Hs})),x=l.useCallback(c=>{if(u&&u in s.tasks)return de({...c,droppableContainers:c.droppableContainers.filter(k=>k.id in s.tasks)});const b=ps(c),I=b.length>0?b:ms(c);let C=ve(I,"id");if(C!=null){if(C in s.tasks){const k=s.tasks[C].map(D=>D.id);k.length>0&&(C=de({...c,droppableContainers:c.droppableContainers.filter(D=>D.id!==C&&k.includes(D.id))})[0]?.id)}return h.current=C,[{id:C}]}return i.current&&(h.current=u),h.current?[{id:h.current}]:[]},[u,s?.tasks]),S=c=>c in s.tasks?c:Object.keys(s.tasks).find(b=>s.tasks[b].map(I=>I.id).includes(c));l.useEffect(()=>{requestAnimationFrame(()=>{i.current=!1})},[]);const T=({active:c})=>{r(c.id)},L=({active:c,over:b})=>{const I=b?.id;if(I==null||c.id in s.tasks)return;const C=S(I),k=S(c.id);if(!(!C||!k)&&k!==C){const D=s.tasks[k].map(B=>B.id),E=s.tasks[C].map(B=>B.id),d=E.indexOf(I),R=D.indexOf(c.id);let O;if(I in s.tasks)O=E.length+1;else{const $e=b&&c.rect.current.translated&&c.rect.current.translated.top>b.rect.top+b.rect.height?1:0;O=d>=0?d+$e:E.length+1}i.current=!0;const Ae={...s.tasks,[k]:s.tasks[k].filter(B=>B.id!==c.id),[C]:[...s.tasks[C].slice(0,O),s.tasks[k][R],...s.tasks[C].slice(O,s.tasks[C].length)]};me(Ae)}},v=({active:c,over:b})=>{if(c.id in s.tasks&&b?.id){const D=p.indexOf(c.id),E=p.indexOf(b.id),d=pe(s.columns,D,E);Us(d)}const I=S(c.id);if(!I){r(null);return}const C=b?.id;if(C==null){r(null);return}const k=S(C);if(k){const D=s.tasks[I].map(O=>O.id),E=s.tasks[k].map(O=>O.id),d=D.indexOf(c.id),R=E.indexOf(C);if(d!==R){const O={...s.tasks,[k]:pe(s.tasks[k],d,R)};me(O)}}r(null)},M=e.jsx(y,{direction:"row",alignItems:"flex-start",sx:{gap:"var(--column-gap)"},children:e.jsx(pn,{})}),H=e.jsx(vs,{filled:!0,sx:{py:10,maxHeight:{md:480}}}),G=e.jsxs(hs,{id:"dnd-kanban",sensors:w,collisionDetection:x,measuring:{droppable:{strategy:xs.Always}},onDragStart:T,onDragOver:L,onDragEnd:v,children:[e.jsx(y,{sx:{flex:"1 1 auto",overflowX:"auto"},children:e.jsx(y,{sx:{pb:3,display:"unset",...t&&{minHeight:0,display:"flex",flex:"1 1 auto"}},children:e.jsx(y,{direction:"row",sx:{gap:"var(--column-gap)",...t&&{minHeight:0,flex:"1 1 auto",[`& .${g.columnList}`]:{...ss,flex:"1 1 auto"}}},children:e.jsxs(ue,{items:[...p,xe],strategy:gs,children:[s?.columns.map(c=>e.jsx(Ys,{column:c,tasks:s.tasks[c.id],children:e.jsx(ue,{items:s.tasks[c.id],strategy:fs,children:s.tasks[c.id].map(b=>e.jsx(cn,{task:b,columnId:c.id,disabled:m},b.id))})},c.id)),e.jsx(un,{id:xe})]})})})}),e.jsx(hn,{columns:s?.columns,tasks:s?.tasks,activeId:u,sx:ge})]});return e.jsxs(ns,{maxWidth:!1,sx:{...ge,pb:0,pl:{sm:3},pr:{sm:0},flex:"1 1 0",display:"flex",overflow:"hidden",flexDirection:"column"},children:[e.jsxs(y,{direction:"row",alignItems:"center",justifyContent:"space-between",sx:{pr:{sm:3},mb:{xs:3,md:5}},children:[e.jsx(_,{variant:"h4",children:"Kanban"}),e.jsx(Ie,{label:"Column fixed",labelPlacement:"start",control:e.jsx(as,{checked:t,onChange:c=>{o(c.target.checked)},inputProps:{id:"column-fixed-switch"}})})]}),n?M:e.jsx(e.Fragment,{children:a?H:G})]})}const bn={title:`Kanban | Dashboard - ${rs.site.name}`};function Bn(){return e.jsxs(e.Fragment,{children:[e.jsx(ts,{children:e.jsxs("title",{children:[" ",bn.title]})}),e.jsx(fn,{})]})}export{Bn as default};
