import{y as en,z as tn,B as N,D as T,E as nn,G as M,J as on,K as sn,M as $,N as K,O as te,P as Y,Q as J,U as ot,V as Q,W as kt,X as an,Y as rn,Z as cn,_ as dn,$ as j,a0 as ln,a1 as un,a2 as pn,a3 as Bt,a4 as be,a5 as P,a6 as v,a7 as O,a8 as qt,a9 as mn,aa as En,ab as re,ac as Ue,ad as hn,ae as gn,c as fe,af as Ht,g as Se,p as B,r as Le,k as l,F as xe,t as Ie,S as C,l as U,o as ye,L as k,R as se,n as ne,q as Re,v as F,f as $e,d as fn,I as Me,m as De,A as jt}from"./index-CtazL8yi.js";import{u as Wt}from"./use-countdown-CEmCKc5l.js";import{E as Sn,P as xn,S as In}from"./new-password-icon-BLsuMVet.js";import{F as b}from"./fields-DtpCY2Ze.js";const yn=async()=>{const{userAgentData:e}=navigator;if(!e)return navigator.userAgent;const{platform:t="",platformVersion:n="",model:o="",architecture:s="",fullVersionList:i=[]}=await e.getHighEntropyValues(["platform","platformVersion","architecture","model","fullVersionList"]),a=i.map(c=>`${c.brand}/${c.version}`).join(";");return[t,n,s,o,t,a].filter(c=>c).join(" ")||navigator.userAgent};function Rn(e){return Array.from(e,t=>String.fromCodePoint(t)).join("")}const ge={convert(e,t={urlSafe:!1,skipPadding:!1}){const n=typeof e=="string"?e:Rn(e);let o=en()(n);return t.urlSafe&&(o=o.replace(/\+/g,"-").replace(/\//g,"_")),t.skipPadding&&(o=o.replace(/=/g,"")),o}};function Pn(){return tn().getRandomValues(new Uint32Array(1))[0]}function vn(e){const{words:t}=e,{sigBytes:n}=e,o=[];for(let s=0;s<n;s++){const i=t[s>>>2]>>>24-s%4*8&255;o.push((i>>>4).toString(16)),o.push((i&15).toString(16))}return o.join("")}class Ke{constructor(t,n){this.words=[];let o=t;o=this.words=o||[],n!==void 0?this.sigBytes=n:this.sigBytes=o.length*4}random(t){const n=[];for(let o=0;o<t;o+=4)n.push(Pn());return new Ke(n,t)}toString(){return vn(this)}}var f;(function(e){e.EmptySignInUsername="EmptySignInUsername",e.EmptySignInPassword="EmptySignInPassword",e.CustomAuthSignInPassword="CustomAuthSignInPassword",e.EmptySignUpUsername="EmptySignUpUsername",e.EmptySignUpPassword="EmptySignUpPassword",e.EmptyConfirmSignUpUsername="EmptyConfirmSignUpUsername",e.EmptyConfirmSignUpCode="EmptyConfirmSignUpCode",e.EmptyResendSignUpCodeUsername="EmptyresendSignUpCodeUsername",e.EmptyChallengeResponse="EmptyChallengeResponse",e.EmptyConfirmResetPasswordUsername="EmptyConfirmResetPasswordUsername",e.EmptyConfirmResetPasswordNewPassword="EmptyConfirmResetPasswordNewPassword",e.EmptyConfirmResetPasswordConfirmationCode="EmptyConfirmResetPasswordConfirmationCode",e.EmptyResetPasswordUsername="EmptyResetPasswordUsername",e.EmptyVerifyTOTPSetupCode="EmptyVerifyTOTPSetupCode",e.EmptyConfirmUserAttributeCode="EmptyConfirmUserAttributeCode",e.IncorrectMFAMethod="IncorrectMFAMethod",e.EmptyUpdatePassword="EmptyUpdatePassword"})(f||(f={}));const zt={[f.EmptyChallengeResponse]:{message:"challengeResponse is required to confirmSignIn"},[f.EmptyConfirmResetPasswordUsername]:{message:"username is required to confirmResetPassword"},[f.EmptyConfirmSignUpCode]:{message:"code is required to confirmSignUp"},[f.EmptyConfirmSignUpUsername]:{message:"username is required to confirmSignUp"},[f.EmptyConfirmResetPasswordConfirmationCode]:{message:"confirmationCode is required to confirmResetPassword"},[f.EmptyConfirmResetPasswordNewPassword]:{message:"newPassword is required to confirmResetPassword"},[f.EmptyResendSignUpCodeUsername]:{message:"username is required to confirmSignUp"},[f.EmptyResetPasswordUsername]:{message:"username is required to resetPassword"},[f.EmptySignInPassword]:{message:"password is required to signIn"},[f.EmptySignInUsername]:{message:"username is required to signIn"},[f.EmptySignUpPassword]:{message:"password is required to signUp"},[f.EmptySignUpUsername]:{message:"username is required to signUp"},[f.CustomAuthSignInPassword]:{message:"A password is not needed when signing in with CUSTOM_WITHOUT_SRP",recoverySuggestion:"Do not include a password in your signIn call."},[f.IncorrectMFAMethod]:{message:"Incorrect MFA method was chosen. It should be either SMS, TOTP, or EMAIL",recoverySuggestion:"Try to pass SMS, TOTP, or EMAIL as the challengeResponse"},[f.EmptyVerifyTOTPSetupCode]:{message:"code is required to verifyTotpSetup"},[f.EmptyUpdatePassword]:{message:"oldPassword and newPassword are required to changePassword"},[f.EmptyConfirmUserAttributeCode]:{message:"confirmation code is required to confirmUserAttribute"}};var st;(function(e){e.DEFAULT_MSG="Authentication Error",e.EMPTY_EMAIL="Email cannot be empty",e.EMPTY_PHONE="Phone number cannot be empty",e.EMPTY_USERNAME="Username cannot be empty",e.INVALID_USERNAME="The username should either be a string or one of the sign in types",e.EMPTY_PASSWORD="Password cannot be empty",e.EMPTY_CODE="Confirmation code cannot be empty",e.SIGN_UP_ERROR="Error creating account",e.NO_MFA="No valid MFA method provided",e.INVALID_MFA="Invalid MFA type",e.EMPTY_CHALLENGE="Challenge response cannot be empty",e.NO_USER_SESSION="Failed to get the session because the user is empty",e.NETWORK_ERROR="Network Error",e.DEVICE_CONFIG="Device tracking has not been configured in this User Pool",e.AUTOSIGNIN_ERROR="Please use your credentials to sign in",e.OAUTH_ERROR="Couldn't finish OAuth flow, check your User Pool HostedUI settings"})(st||(st={}));var ie;(function(e){e.SignInException="SignInException",e.OAuthSignInError="OAuthSignInException"})(ie||(ie={}));function R(e,t){const{message:n,recoverySuggestion:o}=zt[t];if(!e)throw new N({name:t,message:n,recoverySuggestion:o})}function it(e){return Object.entries(e).map(([t,n])=>({Name:t,Value:n}))}var at;(function(e){e.ConcurrentModificationException="ConcurrentModificationException",e.ForbiddenException="ForbiddenException",e.InternalErrorException="InternalErrorException",e.InvalidParameterException="InvalidParameterException",e.NotAuthorizedException="NotAuthorizedException",e.ResourceNotFoundException="ResourceNotFoundException",e.SoftwareTokenMFANotFoundException="SoftwareTokenMFANotFoundException"})(at||(at={}));var rt;(function(e){e.ForbiddenException="ForbiddenException",e.InternalErrorException="InternalErrorException",e.InvalidParameterException="InvalidParameterException",e.InvalidPasswordException="InvalidPasswordException",e.LimitExceededException="LimitExceededException",e.NotAuthorizedException="NotAuthorizedException",e.PasswordResetRequiredException="PasswordResetRequiredException",e.ResourceNotFoundException="ResourceNotFoundException",e.TooManyRequestsException="TooManyRequestsException",e.UserNotConfirmedException="UserNotConfirmedException",e.UserNotFoundException="UserNotFoundException"})(rt||(rt={}));var ct;(function(e){e.ForbiddenException="ForbiddenException",e.InternalErrorException="InternalErrorException",e.InvalidLambdaResponseException="InvalidLambdaResponseException",e.InvalidParameterException="InvalidParameterException",e.InvalidPasswordException="InvalidPasswordException",e.InvalidUserPoolConfigurationException="InvalidUserPoolConfigurationException",e.NotAuthorizedException="NotAuthorizedException",e.PasswordResetRequiredException="PasswordResetRequiredException",e.ResourceNotFoundException="ResourceNotFoundException",e.TooManyRequestsException="TooManyRequestsException",e.UsernameExistsException="UsernameExistsException",e.UserNotConfirmedException="UserNotConfirmedException",e.UserNotFoundException="UserNotFoundException"})(ct||(ct={}));var dt;(function(e){e.CodeMismatchException="CodeMismatchException",e.ExpiredCodeException="ExpiredCodeException",e.ForbiddenException="ForbiddenException",e.InternalErrorException="InternalErrorException",e.InvalidLambdaResponseException="InvalidLambdaResponseException",e.InvalidParameterException="InvalidParameterException",e.InvalidPasswordException="InvalidPasswordException",e.LimitExceededException="LimitExceededException",e.NotAuthorizedException="NotAuthorizedException",e.ResourceNotFoundException="ResourceNotFoundException",e.TooManyFailedAttemptsException="TooManyFailedAttemptsException",e.TooManyRequestsException="TooManyRequestsException",e.UnexpectedLambdaException="UnexpectedLambdaException",e.UserLambdaValidationException="UserLambdaValidationException",e.UserNotConfirmedException="UserNotConfirmedException",e.UserNotFoundException="UserNotFoundException"})(dt||(dt={}));var lt;(function(e){e.AliasExistsException="AliasExistsException",e.CodeMismatchException="CodeMismatchException",e.ExpiredCodeException="ExpiredCodeException",e.ForbiddenException="ForbiddenException",e.InternalErrorException="InternalErrorException",e.InvalidLambdaResponseException="InvalidLambdaResponseException",e.InvalidParameterException="InvalidParameterException",e.LimitExceededException="LimitExceededException",e.NotAuthorizedException="NotAuthorizedException",e.ResourceNotFoundException="ResourceNotFoundException",e.TooManyFailedAttemptsException="TooManyFailedAttemptsException",e.TooManyRequestsException="TooManyRequestsException",e.UnexpectedLambdaException="UnexpectedLambdaException",e.UserLambdaValidationException="UserLambdaValidationException",e.UserNotFoundException="UserNotFoundException"})(lt||(lt={}));var ut;(function(e){e.ForbiddenException="ForbiddenException",e.InternalErrorException="InternalErrorException",e.InvalidParameterException="InvalidParameterException",e.NotAuthorizedException="NotAuthorizedException",e.PasswordResetRequiredException="PasswordResetRequiredException",e.ResourceNotFoundException="ResourceNotFoundException",e.TooManyRequestsException="TooManyRequestsException",e.UserNotConfirmedException="UserNotConfirmedException",e.UserNotFoundException="UserNotFoundException"})(ut||(ut={}));var pt;(function(e){e.ForbiddenException="ForbiddenException",e.InternalErrorException="InternalErrorException",e.InvalidParameterException="InvalidParameterException",e.NotAuthorizedException="NotAuthorizedException",e.PasswordResetRequiredException="PasswordResetRequiredException",e.ResourceNotFoundException="ResourceNotFoundException",e.TooManyRequestsException="TooManyRequestsException",e.UserNotConfirmedException="UserNotConfirmedException",e.UserNotFoundException="UserNotFoundException"})(pt||(pt={}));var mt;(function(e){e.ForbiddenException="ForbiddenException",e.InternalErrorException="InternalErrorException",e.InvalidParameterException="InvalidParameterException",e.InvalidUserPoolConfigurationException="InvalidUserPoolConfigurationException",e.NotAuthorizedException="NotAuthorizedException",e.PasswordResetRequiredException="PasswordResetRequiredException",e.ResourceNotFoundException="ResourceNotFoundException",e.TooManyRequestsException="TooManyRequestsException",e.UserNotConfirmedException="UserNotConfirmedException",e.UserNotFoundException="UserNotFoundException"})(mt||(mt={}));var Et;(function(e){e.CodeDeliveryFailureException="CodeDeliveryFailureException",e.ForbiddenException="ForbiddenException",e.InternalErrorException="InternalErrorException",e.InvalidEmailRoleAccessPolicyException="InvalidEmailRoleAccessPolicyException",e.InvalidLambdaResponseException="InvalidLambdaResponseException",e.InvalidParameterException="InvalidParameterException",e.InvalidSmsRoleAccessPolicyException="InvalidSmsRoleAccessPolicyException",e.InvalidSmsRoleTrustRelationshipException="InvalidSmsRoleTrustRelationshipException",e.LimitExceededException="LimitExceededException",e.NotAuthorizedException="NotAuthorizedException",e.ResourceNotFoundException="ResourceNotFoundException",e.TooManyRequestsException="TooManyRequestsException",e.UnexpectedLambdaException="UnexpectedLambdaException",e.UserLambdaValidationException="UserLambdaValidationException",e.UserNotFoundException="UserNotFoundException"})(Et||(Et={}));var ht;(function(e){e.ForbiddenException="ForbiddenException",e.InternalErrorException="InternalErrorException",e.InvalidParameterException="InvalidParameterException",e.NotAuthorizedException="NotAuthorizedException",e.PasswordResetRequiredException="PasswordResetRequiredException",e.ResourceNotFoundException="ResourceNotFoundException",e.TooManyRequestsException="TooManyRequestsException",e.UserNotConfirmedException="UserNotConfirmedException",e.UserNotFoundException="UserNotFoundException"})(ht||(ht={}));var gt;(function(e){e.ExternalServiceException="ExternalServiceException",e.InternalErrorException="InternalErrorException",e.InvalidParameterException="InvalidParameterException",e.LimitExceededException="LimitExceededException",e.NotAuthorizedException="NotAuthorizedException",e.ResourceConflictException="ResourceConflictException",e.ResourceNotFoundException="ResourceNotFoundException",e.TooManyRequestsException="TooManyRequestsException"})(gt||(gt={}));var ft;(function(e){e.ExternalServiceException="ExternalServiceException",e.InternalErrorException="InternalErrorException",e.InvalidIdentityPoolConfigurationException="InvalidIdentityPoolConfigurationException",e.InvalidParameterException="InvalidParameterException",e.NotAuthorizedException="NotAuthorizedException",e.ResourceConflictException="ResourceConflictException",e.ResourceNotFoundException="ResourceNotFoundException",e.TooManyRequestsException="TooManyRequestsException"})(ft||(ft={}));var St;(function(e){e.CodeDeliveryFailureException="CodeDeliveryFailureException",e.ForbiddenException="ForbiddenException",e.InternalErrorException="InternalErrorException",e.InvalidEmailRoleAccessPolicyException="InvalidEmailRoleAccessPolicyException",e.InvalidLambdaResponseException="InvalidLambdaResponseException",e.InvalidParameterException="InvalidParameterException",e.InvalidSmsRoleAccessPolicyException="InvalidSmsRoleAccessPolicyException",e.InvalidSmsRoleTrustRelationshipException="InvalidSmsRoleTrustRelationshipException",e.LimitExceededException="LimitExceededException",e.NotAuthorizedException="NotAuthorizedException",e.PasswordResetRequiredException="PasswordResetRequiredException",e.ResourceNotFoundException="ResourceNotFoundException",e.TooManyRequestsException="TooManyRequestsException",e.UnexpectedLambdaException="UnexpectedLambdaException",e.UserLambdaValidationException="UserLambdaValidationException",e.UserNotConfirmedException="UserNotConfirmedException",e.UserNotFoundException="UserNotFoundException"})(St||(St={}));var xt;(function(e){e.ForbiddenException="ForbiddenException",e.InternalErrorException="InternalErrorException",e.InvalidParameterException="InvalidParameterException",e.NotAuthorizedException="NotAuthorizedException",e.PasswordResetRequiredException="PasswordResetRequiredException",e.ResourceNotFoundException="ResourceNotFoundException",e.TooManyRequestsException="TooManyRequestsException",e.UserNotConfirmedException="UserNotConfirmedException"})(xt||(xt={}));var _e;(function(e){e.PasswordResetRequiredException="PasswordResetRequiredException",e.ForbiddenException="ForbiddenException",e.InternalErrorException="InternalErrorException",e.InvalidLambdaResponseException="InvalidLambdaResponseException",e.InvalidParameterException="InvalidParameterException",e.InvalidSmsRoleAccessPolicyException="InvalidSmsRoleAccessPolicyException",e.InvalidSmsRoleTrustRelationshipException="InvalidSmsRoleTrustRelationshipException",e.InvalidUserPoolConfigurationException="InvalidUserPoolConfigurationException",e.NotAuthorizedException="NotAuthorizedException",e.ResourceNotFoundException="ResourceNotFoundException",e.TooManyRequestsException="TooManyRequestsException",e.UnexpectedLambdaException="UnexpectedLambdaException",e.UserLambdaValidationException="UserLambdaValidationException",e.UserNotConfirmedException="UserNotConfirmedException",e.UserNotFoundException="UserNotFoundException"})(_e||(_e={}));var It;(function(e){e.CodeDeliveryFailureException="CodeDeliveryFailureException",e.ForbiddenException="ForbiddenException",e.InternalErrorException="InternalErrorException",e.InvalidEmailRoleAccessPolicyException="InvalidEmailRoleAccessPolicyException",e.InvalidLambdaResponseException="InvalidLambdaResponseException",e.InvalidParameterException="InvalidParameterException",e.InvalidSmsRoleAccessPolicyException="InvalidSmsRoleAccessPolicyException",e.InvalidSmsRoleTrustRelationshipException="InvalidSmsRoleTrustRelationshipException",e.LimitExceededException="LimitExceededException",e.NotAuthorizedException="NotAuthorizedException",e.ResourceNotFoundException="ResourceNotFoundException",e.TooManyRequestsException="TooManyRequestsException",e.UnexpectedLambdaException="UnexpectedLambdaException",e.UserLambdaValidationException="UserLambdaValidationException",e.UserNotFoundException="UserNotFoundException"})(It||(It={}));var yt;(function(e){e.AliasExistsException="AliasExistsException",e.CodeMismatchException="CodeMismatchException",e.ExpiredCodeException="ExpiredCodeException",e.ForbiddenException="ForbiddenException",e.InternalErrorException="InternalErrorException",e.InvalidLambdaResponseException="InvalidLambdaResponseException",e.InvalidParameterException="InvalidParameterException",e.InvalidPasswordException="InvalidPasswordException",e.InvalidSmsRoleAccessPolicyException="InvalidSmsRoleAccessPolicyException",e.InvalidSmsRoleTrustRelationshipException="InvalidSmsRoleTrustRelationshipException",e.InvalidUserPoolConfigurationException="InvalidUserPoolConfigurationException",e.MFAMethodNotFoundException="MFAMethodNotFoundException",e.NotAuthorizedException="NotAuthorizedException",e.PasswordResetRequiredException="PasswordResetRequiredException",e.ResourceNotFoundException="ResourceNotFoundException",e.SoftwareTokenMFANotFoundException="SoftwareTokenMFANotFoundException",e.TooManyRequestsException="TooManyRequestsException",e.UnexpectedLambdaException="UnexpectedLambdaException",e.UserLambdaValidationException="UserLambdaValidationException",e.UserNotConfirmedException="UserNotConfirmedException",e.UserNotFoundException="UserNotFoundException"})(yt||(yt={}));var Rt;(function(e){e.ForbiddenException="ForbiddenException",e.InternalErrorException="InternalErrorException",e.InvalidParameterException="InvalidParameterException",e.NotAuthorizedException="NotAuthorizedException",e.PasswordResetRequiredException="PasswordResetRequiredException",e.ResourceNotFoundException="ResourceNotFoundException",e.UserNotConfirmedException="UserNotConfirmedException",e.UserNotFoundException="UserNotFoundException"})(Rt||(Rt={}));var We;(function(e){e.CodeDeliveryFailureException="CodeDeliveryFailureException",e.InternalErrorException="InternalErrorException",e.InvalidEmailRoleAccessPolicyException="InvalidEmailRoleAccessPolicyException",e.InvalidLambdaResponseException="InvalidLambdaResponseException",e.InvalidParameterException="InvalidParameterException",e.InvalidPasswordException="InvalidPasswordException",e.InvalidSmsRoleAccessPolicyException="InvalidSmsRoleAccessPolicyException",e.InvalidSmsRoleTrustRelationshipException="InvalidSmsRoleTrustRelationshipException",e.NotAuthorizedException="NotAuthorizedException",e.ResourceNotFoundException="ResourceNotFoundException",e.TooManyRequestsException="TooManyRequestsException",e.UnexpectedLambdaException="UnexpectedLambdaException",e.UserLambdaValidationException="UserLambdaValidationException",e.UsernameExistsException="UsernameExistsException"})(We||(We={}));var Pt;(function(e){e.AliasExistsException="AliasExistsException",e.CodeDeliveryFailureException="CodeDeliveryFailureException",e.CodeMismatchException="CodeMismatchException",e.ExpiredCodeException="ExpiredCodeException",e.ForbiddenException="ForbiddenException",e.InternalErrorException="InternalErrorException",e.InvalidEmailRoleAccessPolicyException="InvalidEmailRoleAccessPolicyException",e.InvalidLambdaResponseException="InvalidLambdaResponseException",e.InvalidParameterException="InvalidParameterException",e.InvalidSmsRoleAccessPolicyException="InvalidSmsRoleAccessPolicyException",e.InvalidSmsRoleTrustRelationshipException="InvalidSmsRoleTrustRelationshipException",e.NotAuthorizedException="NotAuthorizedException",e.PasswordResetRequiredException="PasswordResetRequiredException",e.ResourceNotFoundException="ResourceNotFoundException",e.TooManyRequestsException="TooManyRequestsException",e.UnexpectedLambdaException="UnexpectedLambdaException",e.UserLambdaValidationException="UserLambdaValidationException",e.UserNotConfirmedException="UserNotConfirmedException",e.UserNotFoundException="UserNotFoundException"})(Pt||(Pt={}));var vt;(function(e){e.CodeMismatchException="CodeMismatchException",e.EnableSoftwareTokenMFAException="EnableSoftwareTokenMFAException",e.ForbiddenException="ForbiddenException",e.InternalErrorException="InternalErrorException",e.InvalidParameterException="InvalidParameterException",e.InvalidUserPoolConfigurationException="InvalidUserPoolConfigurationException",e.NotAuthorizedException="NotAuthorizedException",e.PasswordResetRequiredException="PasswordResetRequiredException",e.ResourceNotFoundException="ResourceNotFoundException",e.SoftwareTokenMFANotFoundException="SoftwareTokenMFANotFoundException",e.TooManyRequestsException="TooManyRequestsException",e.UserNotConfirmedException="UserNotConfirmedException",e.UserNotFoundException="UserNotFoundException"})(vt||(vt={}));var wt;(function(e){e.AliasExistsException="AliasExistsException",e.CodeMismatchException="CodeMismatchException",e.ExpiredCodeException="ExpiredCodeException",e.ForbiddenException="ForbiddenException",e.InternalErrorException="InternalErrorException",e.InvalidParameterException="InvalidParameterException",e.LimitExceededException="LimitExceededException",e.NotAuthorizedException="NotAuthorizedException",e.PasswordResetRequiredException="PasswordResetRequiredException",e.ResourceNotFoundException="ResourceNotFoundException",e.TooManyRequestsException="TooManyRequestsException",e.UserNotConfirmedException="UserNotConfirmedException",e.UserNotFoundException="UserNotFoundException"})(wt||(wt={}));var Ct;(function(e){e.ForbiddenException="ForbiddenException",e.InternalErrorException="InternalErrorException",e.InvalidParameterException="InvalidParameterException",e.InvalidUserPoolConfigurationException="InvalidUserPoolConfigurationException",e.NotAuthorizedException="NotAuthorizedException",e.PasswordResetRequiredException="PasswordResetRequiredException",e.ResourceNotFoundException="ResourceNotFoundException",e.TooManyRequestsException="TooManyRequestsException",e.UserNotConfirmedException="UserNotConfirmedException",e.UserNotFoundException="UserNotFoundException"})(Ct||(Ct={}));var Nt;(function(e){e.ForbiddenException="ForbiddenException",e.InternalErrorException="InternalErrorException",e.InvalidParameterException="InvalidParameterException",e.InvalidUserPoolConfigurationException="InvalidUserPoolConfigurationException",e.NotAuthorizedException="NotAuthorizedException",e.PasswordResetRequiredException="PasswordResetRequiredException",e.ResourceNotFoundException="ResourceNotFoundException",e.TooManyRequestsException="TooManyRequestsException",e.UserNotConfirmedException="UserNotConfirmedException",e.UserNotFoundException="UserNotFoundException"})(Nt||(Nt={}));const wn=async e=>{const t=e.getConfig().Auth?.Cognito;T(t);const n=await e.Auth.getTokens({forceRefresh:!1});nn(n);const{"cognito:username":o,sub:s}=n.idToken?.payload??{},i={username:o,userId:s},a=Cn(n);return a&&(i.signInDetails=a),i};function Cn(e){return e?.signInDetails}const Vt=async()=>wn(M),L=(e,t)=>on({category:sn.Auth,action:e,...t}),Pe=e=>$(J,Y("InitiateAuth"),te(),{...K,...e}),ke=e=>$(J,Y("RespondToAuthChallenge"),te(),{...K,...e}),Nn=e=>$(J,Y("AssociateSoftwareToken"),te(),{...K,...e});async function ce(e){if(e.AccessToken){const t=ot(e.AccessToken),n=(t.payload.iat||0)*1e3,o=new Date().getTime(),s=n>0?n-o:0;let i,a,r;e.RefreshToken&&(a=e.RefreshToken),e.IdToken&&(i=ot(e.IdToken)),e?.NewDeviceMetadata&&(r=e.NewDeviceMetadata);const c={accessToken:t,idToken:i,refreshToken:a,clockDrift:s,deviceMetadata:r,username:e.username};e?.signInDetails&&(c.signInDetails=e.signInDetails),await Q.setTokens({tokens:c})}else throw new kt({message:"Invalid tokens",name:"InvalidTokens",recoverySuggestion:"Check Cognito UserPool settings"})}const Tn="Unable to get user session following successful sign-in.",de=async()=>{try{an.dispatch("auth",{event:"signedIn",data:await Vt()},"Auth",rn)}catch(e){throw e.name===cn?new N({name:dn,message:Tn,recoverySuggestion:"This most likely is due to auth tokens not being persisted. If you are using cookie store, please ensure cookies can be correctly set from your server."}):e}};function $t(){return{active:!1}}const An=(e,t)=>{switch(t.type){case"SET_USERNAME":return{...e,username:t.value};case"SET_SESSION":return{...e,session:t.value};case"START":return{...e,active:!0};case"RESET":return $t();default:return e}},Fn=e=>{let t=e($t(),{type:"RESET"});return{getState:()=>t,dispatch:n=>{t=e(t,n)}}},G=Fn(An),bn=180*1e3,Ne="CognitoSignInState",W={username:`${Ne}.username`,challengeName:`${Ne}.challengeName`,signInSession:`${Ne}.signInSession`,expiry:`${Ne}.expiry`},Un=(e,t)=>{switch(t.type){case"SET_SIGN_IN_SESSION":return Te({signInSession:t.value}),{...e,signInSession:t.value};case"SET_SIGN_IN_STATE":return Te(t.value),{...t.value};case"SET_CHALLENGE_NAME":return Te({challengeName:t.value}),{...e,challengeName:t.value};case"SET_USERNAME":return Te({username:t.value}),{...e,username:t.value};case"SET_INITIAL_STATE":return Dn();case"RESET_STATE":return Kt(),Ye();default:return e}},Mn=e=>{const t=Number(e),n=Date.now();return t<=n},q=()=>{ee.dispatch({type:"RESET_STATE"})},Kt=()=>{for(const e of Object.values(W))j.removeItem(e)},Ye=()=>({username:void 0,challengeName:void 0,signInSession:void 0}),Dn=()=>{const e=j.getItem(W.expiry);if(!e||Mn(e))return Kt(),Ye();const t=j.getItem(W.username)??void 0,n=j.getItem(W.challengeName)??void 0,o=j.getItem(W.signInSession)??void 0;return{username:t,challengeName:n,signInSession:o}},_n=e=>{let t=e(Ye(),{type:"SET_INITIAL_STATE"});return{getState:()=>t,dispatch:n=>{t=e(t,n)}}},ee=_n(Un);function le(e){ee.dispatch({type:"SET_SIGN_IN_STATE",value:e})}const Te=({challengeName:e,signInSession:t,username:n})=>{n&&j.setItem(W.username,n),e&&j.setItem(W.challengeName,e),t&&(j.setItem(W.signInSession,t),j.setItem(W.expiry,String(Date.now()+bn)))};class z extends kt{constructor(t){super(t),this.constructor=z,Object.setPrototypeOf(this,z.prototype)}}var y;(function(e){e.PasskeyNotSupported="PasskeyNotSupported",e.PasskeyAlreadyExists="PasskeyAlreadyExists",e.InvalidPasskeyRegistrationOptions="InvalidPasskeyRegistrationOptions",e.InvalidPasskeyAuthenticationOptions="InvalidPasskeyAuthenticationOptions",e.RelyingPartyMismatch="RelyingPartyMismatch",e.PasskeyRegistrationFailed="PasskeyRegistrationFailed",e.PasskeyRetrievalFailed="PasskeyRetrievalFailed",e.PasskeyRegistrationCanceled="PasskeyRegistrationCanceled",e.PasskeyAuthenticationCanceled="PasskeyAuthenticationCanceled",e.PasskeyOperationAborted="PasskeyOperationAborted"})(y||(y={}));const Tt="Passkeys may not be supported on this device. Ensure your application is running in a secure context (HTTPS) and Web Authentication API is supported.",je="User may have canceled the ceremony or another interruption has occurred. Check underlying error for details.",At="Ensure your user pool is configured to support the WEB_AUTHN as an authentication factor.",Oe={[y.PasskeyNotSupported]:{message:"Passkeys may not be supported on this device.",recoverySuggestion:Tt},[y.InvalidPasskeyRegistrationOptions]:{message:"Invalid passkey registration options.",recoverySuggestion:At},[y.InvalidPasskeyAuthenticationOptions]:{message:"Invalid passkey authentication options.",recoverySuggestion:At},[y.PasskeyRegistrationFailed]:{message:"Device failed to create passkey.",recoverySuggestion:Tt},[y.PasskeyRetrievalFailed]:{message:"Device failed to retrieve passkey.",recoverySuggestion:"Passkeys may not be available on this device. Try an alternative authentication factor like PASSWORD, EMAIL_OTP, or SMS_OTP."},[y.PasskeyAlreadyExists]:{message:"Passkey already exists in authenticator.",recoverySuggestion:"Proceed with existing passkey or try again after deleting the credential."},[y.PasskeyRegistrationCanceled]:{message:"Passkey registration ceremony has been canceled.",recoverySuggestion:je},[y.PasskeyAuthenticationCanceled]:{message:"Passkey authentication ceremony has been canceled.",recoverySuggestion:je},[y.PasskeyOperationAborted]:{message:"Passkey operation has been aborted.",recoverySuggestion:je},[y.RelyingPartyMismatch]:{message:"Relying party does not match current domain.",recoverySuggestion:"Ensure relying party identifier matches current domain."}},Je=ln(Oe,z),On=e=>{if(e instanceof z)return e;if(e instanceof Error&&e.name==="NotAllowedError"){const{message:t,recoverySuggestion:n}=Oe[y.PasskeyAuthenticationCanceled];return new z({name:y.PasskeyAuthenticationCanceled,message:t,recoverySuggestion:n,underlyingError:e})}return Ln(e)},Ln=e=>{if(e instanceof Error){if(e.name==="AbortError"){const{message:t,recoverySuggestion:n}=Oe[y.PasskeyOperationAborted];return new z({name:y.PasskeyOperationAborted,message:t,recoverySuggestion:n,underlyingError:e})}if(e.name==="SecurityError"){const{message:t,recoverySuggestion:n}=Oe[y.RelyingPartyMismatch];return new z({name:y.RelyingPartyMismatch,message:t,recoverySuggestion:n,underlyingError:e})}}return new z({name:un.Unknown,message:"An unknown error has occurred.",underlyingError:e})},kn=()=>pn()&&window.isSecureContext&&"credentials"in navigator&&typeof window.PublicKeyCredential=="function",he=e=>ge.convert(new Uint8Array(e),{urlSafe:!0,skipPadding:!0}),Ft=e=>Uint8Array.from(Bt.convert(e,{urlSafe:!0}),t=>t.charCodeAt(0)).buffer,Bn=e=>{const t=Ft(e.challenge),n=(e.allowCredentials||[]).map(o=>({...o,id:Ft(o.id)}));return{...e,challenge:t,allowCredentials:n}},qn=e=>{const t={clientDataJSON:he(e.response.clientDataJSON),authenticatorData:he(e.response.authenticatorData),signature:he(e.response.signature)};e.response.userHandle&&(t.userHandle=he(e.response.userHandle));const n={id:e.id,rawId:he(e.rawId),type:e.type,clientExtensionResults:e.getClientExtensionResults(),response:t};return e.authenticatorAttachment&&(n.authenticatorAttachment=e.authenticatorAttachment),n};function Hn(e){Je(e&&e instanceof PublicKeyCredential&&e.response instanceof AuthenticatorAssertionResponse,y.PasskeyRetrievalFailed)}const jn=async e=>{try{const t=kn();Je(t,y.PasskeyNotSupported);const n=Bn(e),o=await navigator.credentials.get({publicKey:n});return Hn(o),qn(o)}catch(t){throw On(t)}},Wn=e=>$(J,Y("ConfirmDevice"),te(),{...K,...e}),Ae={convert(e){return new TextEncoder().encode(e)}};function m(e,t){e!=null&&this.fromString(e,t)}function w(){return new m(null,null)}let X;const zn=0xdeadbeefcafe,bt=(zn&16777215)===15715070;function Vn(e,t,n,o,s,i){for(;--i>=0;){const a=t*this[e++]+n[o]+s;s=Math.floor(a/67108864),n[o++]=a&67108863}return s}function $n(e,t,n,o,s,i){const a=t&32767,r=t>>15;for(;--i>=0;){let c=this[e]&32767;const d=this[e++]>>15,u=r*c+d*a;c=a*c+((u&32767)<<15)+n[o]+(s&1073741823),s=(c>>>30)+(u>>>15)+r*d+(s>>>30),n[o++]=c&1073741823}return s}function Kn(e,t,n,o,s,i){const a=t&16383,r=t>>14;for(;--i>=0;){let c=this[e]&16383;const d=this[e++]>>14,u=r*c+d*a;c=a*c+((u&16383)<<14)+n[o]+s,s=(c>>28)+(u>>14)+r*d,n[o++]=c&268435455}return s}const Ut=typeof navigator<"u";Ut&&bt&&navigator.appName==="Microsoft Internet Explorer"?(m.prototype.am=$n,X=30):Ut&&bt&&navigator.appName!=="Netscape"?(m.prototype.am=Vn,X=26):(m.prototype.am=Kn,X=28);m.prototype.DB=X;m.prototype.DM=(1<<X)-1;m.prototype.DV=1<<X;const Ze=52;m.prototype.FV=Math.pow(2,Ze);m.prototype.F1=Ze-X;m.prototype.F2=2*X-Ze;const Yn="0123456789abcdefghijklmnopqrstuvwxyz",Be=[];let ue,D;ue=48;for(D=0;D<=9;++D)Be[ue++]=D;ue=97;for(D=10;D<36;++D)Be[ue++]=D;ue=65;for(D=10;D<36;++D)Be[ue++]=D;function Mt(e){return Yn.charAt(e)}function Jn(e,t){const n=Be[e.charCodeAt(t)];return n??-1}function Zn(e){for(let t=this.t-1;t>=0;--t)e[t]=this[t];e.t=this.t,e.s=this.s}function Gn(e){this.t=1,this.s=e<0?-1:0,e>0?this[0]=e:e<-1?this[0]=e+this.DV:this.t=0}function Ge(e){const t=w();return t.fromInt(e),t}function Xn(e,t){let n;if(t===16)n=4;else if(t===8)n=3;else if(t===2)n=1;else if(t===32)n=5;else if(t===4)n=2;else throw new Error("Only radix 2, 4, 8, 16, 32 are supported");this.t=0,this.s=0;let o=e.length,s=!1,i=0;for(;--o>=0;){const a=Jn(e,o);if(a<0){e.charAt(o)==="-"&&(s=!0);continue}s=!1,i===0?this[this.t++]=a:i+n>this.DB?(this[this.t-1]|=(a&(1<<this.DB-i)-1)<<i,this[this.t++]=a>>this.DB-i):this[this.t-1]|=a<<i,i+=n,i>=this.DB&&(i-=this.DB)}this.clamp(),s&&m.ZERO.subTo(this,this)}function Qn(){const e=this.s&this.DM;for(;this.t>0&&this[this.t-1]==e;)--this.t}function eo(e){if(this.s<0)return"-"+this.negate().toString(e);let t;if(e==16)t=4;else if(e===8)t=3;else if(e===2)t=1;else if(e===32)t=5;else if(e===4)t=2;else throw new Error("Only radix 2, 4, 8, 16, 32 are supported");const n=(1<<t)-1;let o,s=!1,i="",a=this.t,r=this.DB-a*this.DB%t;if(a-- >0)for(r<this.DB&&(o=this[a]>>r)>0&&(s=!0,i=Mt(o));a>=0;)r<t?(o=(this[a]&(1<<r)-1)<<t-r,o|=this[--a]>>(r+=this.DB-t)):(o=this[a]>>(r-=t)&n,r<=0&&(r+=this.DB,--a)),o>0&&(s=!0),s&&(i+=Mt(o));return s?i:"0"}function to(){const e=w();return m.ZERO.subTo(this,e),e}function no(){return this.s<0?this.negate():this}function oo(e){let t=this.s-e.s;if(t!=0)return t;let n=this.t;if(t=n-e.t,t!=0)return this.s<0?-t:t;for(;--n>=0;)if((t=this[n]-e[n])!=0)return t;return 0}function Xe(e){let t=1,n;return(n=e>>>16)!==0&&(e=n,t+=16),(n=e>>8)!==0&&(e=n,t+=8),(n=e>>4)!==0&&(e=n,t+=4),(n=e>>2)!==0&&(e=n,t+=2),(n=e>>1)!==0&&(e=n,t+=1),t}function so(){return this.t<=0?0:this.DB*(this.t-1)+Xe(this[this.t-1]^this.s&this.DM)}function io(e,t){let n;for(n=this.t-1;n>=0;--n)t[n+e]=this[n];for(n=e-1;n>=0;--n)t[n]=0;t.t=this.t+e,t.s=this.s}function ao(e,t){for(let n=e;n<this.t;++n)t[n-e]=this[n];t.t=Math.max(this.t-e,0),t.s=this.s}function ro(e,t){const n=e%this.DB,o=this.DB-n,s=(1<<o)-1,i=Math.floor(e/this.DB);let a=this.s<<n&this.DM,r;for(r=this.t-1;r>=0;--r)t[r+i+1]=this[r]>>o|a,a=(this[r]&s)<<n;for(r=i-1;r>=0;--r)t[r]=0;t[i]=a,t.t=this.t+i+1,t.s=this.s,t.clamp()}function co(e,t){t.s=this.s;const n=Math.floor(e/this.DB);if(n>=this.t){t.t=0;return}const o=e%this.DB,s=this.DB-o,i=(1<<o)-1;t[0]=this[n]>>o;for(let a=n+1;a<this.t;++a)t[a-n-1]|=(this[a]&i)<<s,t[a-n]=this[a]>>o;o>0&&(t[this.t-n-1]|=(this.s&i)<<s),t.t=this.t-n,t.clamp()}function lo(e,t){let n=0,o=0;const s=Math.min(e.t,this.t);for(;n<s;)o+=this[n]-e[n],t[n++]=o&this.DM,o>>=this.DB;if(e.t<this.t){for(o-=e.s;n<this.t;)o+=this[n],t[n++]=o&this.DM,o>>=this.DB;o+=this.s}else{for(o+=this.s;n<e.t;)o-=e[n],t[n++]=o&this.DM,o>>=this.DB;o-=e.s}t.s=o<0?-1:0,o<-1?t[n++]=this.DV+o:o>0&&(t[n++]=o),t.t=n,t.clamp()}function uo(e,t){const n=this.abs(),o=e.abs();let s=n.t;for(t.t=s+o.t;--s>=0;)t[s]=0;for(s=0;s<o.t;++s)t[s+n.t]=n.am(0,o[s],t,s,0,n.t);t.s=0,t.clamp(),this.s!==e.s&&m.ZERO.subTo(t,t)}function po(e){const t=this.abs();let n=e.t=2*t.t;for(;--n>=0;)e[n]=0;for(n=0;n<t.t-1;++n){const o=t.am(n,t[n],e,2*n,0,1);(e[n+t.t]+=t.am(n+1,2*t[n],e,2*n+1,o,t.t-n-1))>=t.DV&&(e[n+t.t]-=t.DV,e[n+t.t+1]=1)}e.t>0&&(e[e.t-1]+=t.am(n,t[n],e,2*n,0,1)),e.s=0,e.clamp()}function mo(e,t,n){const o=e.abs();if(o.t<=0)return;const s=this.abs();if(s.t<o.t){t?.fromInt(0),n!=null&&this.copyTo(n);return}n===null&&(n=w());const i=w(),a=this.s,r=e.s,c=this.DB-Xe(o[o.t-1]);c>0?(o.lShiftTo(c,i),s.lShiftTo(c,n)):(o.copyTo(i),s.copyTo(n));const d=i.t,u=i[d-1];if(u===0)return;const p=u*(1<<this.F1)+(d>1?i[d-2]>>this.F2:0),E=this.FV/p,h=(1<<this.F1)/p,g=1<<this.F2;let S=n.t,x=S-d;const I=t===null?w():t;for(i.dlShiftTo(x,I),n.compareTo(I)>=0&&(n[n.t++]=1,n.subTo(I,n)),m.ONE.dlShiftTo(d,I),I.subTo(i,i);i.t<d;)i[i.t++]=0;for(;--x>=0;){let A=n[--S]===u?this.DM:Math.floor(n[S]*E+(n[S-1]+g)*h);if((n[S]+=i.am(0,A,n,x,0,d))<A)for(i.dlShiftTo(x,I),n.subTo(I,n);n[S]<--A;)n.subTo(I,n)}t!==null&&(n.drShiftTo(d,t),a!==r&&m.ZERO.subTo(t,t)),n.t=d,n.clamp(),c>0&&n.rShiftTo(c,n),a<0&&m.ZERO.subTo(n,n)}function Eo(e){const t=w();return this.abs().divRemTo(e,null,t),this.s<0&&t.compareTo(m.ZERO)>0&&e.subTo(t,t),t}function ho(){if(this.t<1)return 0;const e=this[0];if((e&1)===0)return 0;let t=e&3;return t=t*(2-(e&15)*t)&15,t=t*(2-(e&255)*t)&255,t=t*(2-((e&65535)*t&65535))&65535,t=t*(2-e*t%this.DV)%this.DV,t>0?this.DV-t:-t}function go(e){return this.compareTo(e)===0}function fo(e,t){let n=0,o=0;const s=Math.min(e.t,this.t);for(;n<s;)o+=this[n]+e[n],t[n++]=o&this.DM,o>>=this.DB;if(e.t<this.t){for(o+=e.s;n<this.t;)o+=this[n],t[n++]=o&this.DM,o>>=this.DB;o+=this.s}else{for(o+=this.s;n<e.t;)o+=e[n],t[n++]=o&this.DM,o>>=this.DB;o+=e.s}t.s=o<0?-1:0,o>0?t[n++]=o:o<-1&&(t[n++]=this.DV+o),t.t=n,t.clamp()}function So(e){const t=w();return this.addTo(e,t),t}function xo(e){const t=w();return this.subTo(e,t),t}function Io(e){const t=w();return this.multiplyTo(e,t),t}function yo(e){const t=w();return this.divRemTo(e,t,null),t}function pe(e){this.m=e,this.mp=e.invDigit(),this.mpl=this.mp&32767,this.mph=this.mp>>15,this.um=(1<<e.DB-15)-1,this.mt2=2*e.t}function Ro(e){const t=w();return e.abs().dlShiftTo(this.m.t,t),t.divRemTo(this.m,null,t),e.s<0&&t.compareTo(m.ZERO)>0&&this.m.subTo(t,t),t}function Po(e){const t=w();return e.copyTo(t),this.reduce(t),t}function vo(e){for(;e.t<=this.mt2;)e[e.t++]=0;for(let t=0;t<this.m.t;++t){let n=e[t]&32767;const o=n*this.mpl+((n*this.mph+(e[t]>>15)*this.mpl&this.um)<<15)&e.DM;for(n=t+this.m.t,e[n]+=this.m.am(0,o,e,t,0,this.m.t);e[n]>=e.DV;)e[n]-=e.DV,e[++n]++}e.clamp(),e.drShiftTo(this.m.t,e),e.compareTo(this.m)>=0&&e.subTo(this.m,e)}function wo(e,t){e.squareTo(t),this.reduce(t)}function Co(e,t,n){e.multiplyTo(t,n),this.reduce(n)}pe.prototype.convert=Ro;pe.prototype.revert=Po;pe.prototype.reduce=vo;pe.prototype.mulTo=Co;pe.prototype.sqrTo=wo;function No(e,t,n){let o=e.bitLength(),s,i=Ge(1);const a=new pe(t);if(o<=0)return i;o<18?s=1:o<48?s=3:o<144?s=4:o<768?s=5:s=6;const r=[];let c=3;const d=s-1,u=(1<<s)-1;if(r[1]=a.convert(this),s>1){const I=w();for(a.sqrTo(r[1],I);c<=u;)r[c]=w(),a.mulTo(I,r[c-2],r[c]),c+=2}let p=e.t-1,E,h=!0,g=w(),S;for(o=Xe(e[p])-1;p>=0;){for(o>=d?E=e[p]>>o-d&u:(E=(e[p]&(1<<o+1)-1)<<d-o,p>0&&(E|=e[p-1]>>this.DB+o-d)),c=s;(E&1)===0;)E>>=1,--c;if((o-=c)<0&&(o+=this.DB,--p),h)r[E].copyTo(i),h=!1;else{for(;c>1;)a.sqrTo(i,g),a.sqrTo(g,i),c-=2;c>0?a.sqrTo(i,g):(S=i,i=g,g=S),a.mulTo(g,r[E],i)}for(;p>=0&&(e[p]&1<<o)===0;)a.sqrTo(i,g),S=i,i=g,g=S,--o<0&&(o=this.DB-1,--p)}const x=a.revert(i);return n(null,x),x}m.prototype.copyTo=Zn;m.prototype.fromInt=Gn;m.prototype.fromString=Xn;m.prototype.clamp=Qn;m.prototype.dlShiftTo=io;m.prototype.drShiftTo=ao;m.prototype.lShiftTo=ro;m.prototype.rShiftTo=co;m.prototype.subTo=lo;m.prototype.multiplyTo=uo;m.prototype.squareTo=po;m.prototype.divRemTo=mo;m.prototype.invDigit=ho;m.prototype.addTo=fo;m.prototype.toString=eo;m.prototype.negate=to;m.prototype.abs=no;m.prototype.compareTo=oo;m.prototype.bitLength=so;m.prototype.mod=Eo;m.prototype.equals=go;m.prototype.add=So;m.prototype.subtract=xo;m.prototype.multiply=Io;m.prototype.divide=yo;m.prototype.modPow=No;m.ZERO=Ge(0);m.ONE=Ge(1);const To=async({a:e,g:t,k:n,x:o,B:s,N:i,U:a})=>new Promise((r,c)=>{t.modPow(o,i,(d,u)=>{if(d){c(d);return}s.subtract(n.multiply(u)).modPow(e.add(a.multiply(o)),i,(p,E)=>{if(p){c(p);return}r(E.mod(i))})})}),Ao="FFFFFFFFFFFFFFFFC90FDAA22168C234C4C6628B80DC1CD129024E088A67CC74020BBEA63B139B22514A08798E3404DDEF9519B3CD3A431B302B0A6DF25F14374FE1356D6D51C245E485B576625E7EC6F44C42E9A637ED6B0BFF5CB6F406B7EDEE386BFB5A899FA5AE9F24117C4B1FE649286651ECE45B3DC2007CB8A163BF0598DA48361C55D39A69163FA8FD24CF5F83655D23DCA3AD961C62F356208552BB9ED529077096966D670C354E4ABC9804F1746C08CA18217C32905E462E36CE3BE39E772C180E86039B2783A2EC07A28FB5C55DF06F4C52C9DE2BCBF6955817183995497CEA956AE515D2261898FA051015728E5A8AAAC42DAD33170D04507A33A85521ABDF1CBA64ECFB850458DBEF0A8AEA71575D060C7DB3970F85A6E1E4C7ABF5AE8CDB0933D71E8C94E04A25619DCEE3D2261AD2EE6BF12FFA06D98A0864D87602733EC86A64521F2B18177B200CBBE117577A615D6C770988C0BAD946E208E24FA074E5AB3143DB5BFCE0FD108E4B82D120A93AD2CAFFFFFFFFFFFFFFFF",Yt={},ze={};for(let e=0;e<256;e++){let t=e.toString(16).toLowerCase();t.length===1&&(t=`0${t}`),Yt[e]=t,ze[t]=e}const ae=e=>{if(e.length%2!==0)throw new Error("Hex encoded strings must have an even number length");const t=new Uint8Array(e.length/2);for(let n=0;n<e.length;n+=2){const o=e.slice(n,n+2).toLowerCase();if(o in ze)t[n/2]=ze[o];else throw new Error(`Cannot decode unrecognized sequence ${o} as hexadecimal`)}return t},Qe=e=>{let t="";for(let n=0;n<e.byteLength;n++)t+=Yt[e[n]];return t},Ve=e=>{const t=new be;t.update(e);const n=t.digestSync(),o=Qe(n);return new Array(64-o.length).join("0")+o},Fe=e=>Ve(ae(e)),Fo=/^[89a-f]/i,H=e=>{if(!(e instanceof m))throw new Error("Not a BigInteger");const t=e.compareTo(m.ZERO)<0;let n=e.abs().toString(16);if(n=n.length%2!==0?`0${n}`:n,n=Fo.test(n)?`00${n}`:n,t){const o=n.split("").map(i=>{const a=~parseInt(i,16)&15;return"0123456789ABCDEF".charAt(a)}).join("");n=new m(o,16).add(m.ONE).toString(16),n.toUpperCase().startsWith("FF8")&&(n=n.substring(2))}return n},bo=({A:e,B:t})=>{const n=new m(Fe(H(e)+H(t)),16);if(n.equals(m.ZERO))throw new Error("U cannot be zero.");return n},Uo=(e,t,n)=>{const o=new be(t);o.update(e);const s=o.digestSync(),i=new be(s);return i.update(n),i.digestSync().slice(0,16)},et=e=>{const t=new Ke().random(e).toString();return ae(t)},Mo=()=>ge.convert(et(40));class Do{constructor({userPoolName:t,a:n,g:o,A:s,N:i}){this.encoder=Ae,this.userPoolName=t,this.a=n,this.g=o,this.A=s,this.N=i,this.k=new m(Fe(`${H(i)}${H(o)}`),16)}getRandomPassword(){if(!this.randomPassword)throw new N({name:"EmptyBigIntegerRandomPassword",message:"random password is empty"});return this.randomPassword}getSaltToHashDevices(){if(!this.saltToHashDevices)throw new N({name:"EmptyBigIntegersaltToHashDevices",message:"saltToHashDevices is empty"});return this.saltToHashDevices}getVerifierDevices(){if(!this.verifierDevices)throw new N({name:"EmptyBigIntegerVerifierDevices",message:"verifyDevices is empty"});return this.verifierDevices}async generateHashDevice(t,n){this.randomPassword=Mo();const o=`${t}${n}:${this.randomPassword}`,s=Ve(o),i=Qe(et(16));return this.saltToHashDevices=H(new m(i,16)),new Promise((a,r)=>{this.g.modPow(new m(Fe(this.saltToHashDevices+s),16),this.N,(c,d)=>{if(c){r(c);return}this.verifierDevices=H(d),a()})})}async getPasswordAuthenticationKey({username:t,password:n,serverBValue:o,salt:s}){if(o.mod(this.N).equals(m.ZERO))throw new Error("B cannot be zero.");const i=bo({A:this.A,B:o}),a=`${this.userPoolName}${t}:${n}`,r=Ve(a),c=new m(Fe(H(s)+r),16),d=await To({a:this.a,g:this.g,k:this.k,x:c,B:o,N:this.N,U:i}),u=this.encoder.convert("Caldera Derived Key"),p=this.encoder.convert(""),E=new Uint8Array(u.byteLength+p.byteLength);return E.set(u,0),E.set(p,u.byteLength),Uo(ae(H(d)),ae(H(i)),E)}}const _o=async({a:e,g:t,N:n})=>new Promise((o,s)=>{t.modPow(e,n,(i,a)=>{if(i){s(i);return}if(a.mod(n).equals(m.ZERO)){s(new Error("Illegal parameter. A mod N cannot be 0."));return}o(a)})}),qe=async e=>{const t=new m(Ao,16),n=new m("2",16),o=Oo(),s=await _o({a:o,g:n,N:t});return new Do({userPoolName:e,a:o,g:n,A:s,N:t})},Oo=()=>{const e=Qe(et(128));return new m(e,16)};async function me({userPoolId:e,userPoolEndpoint:t,newDeviceMetadata:n,accessToken:o}){if(!n)return;const s=e.split("_")[1]||"",i=await qe(s),a=n?.DeviceKey,r=n?.DeviceGroupKey;try{await i.generateHashDevice(r??"",a??"")}catch{return}const c={Salt:ge.convert(ae(i.getSaltToHashDevices())),PasswordVerifier:ge.convert(ae(i.getVerifierDevices()))},d=i.getRandomPassword();try{return await Wn({endpointResolver:P({endpointOverride:t})})({region:v(e)},{AccessToken:o,DeviceName:await yn(),DeviceKey:n?.DeviceKey,DeviceSecretVerifierConfig:c}),{deviceKey:a,deviceGroupKey:r,randomPassword:d}}catch{return}}async function Lo(e){const t=M.getConfig().Auth?.Cognito;T(t);const{username:n,signInSession:o,signInDetails:s,challengeName:i}=ee.getState();if(i!=="WEB_AUTHN"||!n)throw new N({name:ie.SignInException,message:"Unable to proceed due to invalid sign in state."});const{CREDENTIAL_REQUEST_OPTIONS:a}=e;Je(!!a,y.InvalidPasskeyAuthenticationOptions);const r=await jn(JSON.parse(a)),c=ke({endpointResolver:P({endpointOverride:t.userPoolEndpoint})}),{ChallengeName:d,ChallengeParameters:u,AuthenticationResult:p,Session:E}=await c({region:v(t.userPoolId),userAgentValue:L(O.ConfirmSignIn)},{ChallengeName:"WEB_AUTHN",ChallengeResponses:{USERNAME:n,CREDENTIAL:JSON.stringify(r)},ClientId:t.userPoolClientId,Session:o});if(le({signInSession:E,username:n,challengeName:d,signInDetails:s}),p)return await ce({...p,username:n,NewDeviceMetadata:await me({userPoolId:t.userPoolId,userPoolEndpoint:t.userPoolEndpoint,newDeviceMetadata:p.NewDeviceMetadata,accessToken:p.AccessToken}),signInDetails:s}),ee.dispatch({type:"RESET_STATE"}),await de(),{isSignedIn:!0,nextStep:{signInStep:"DONE"}};if(d==="WEB_AUTHN")throw new N({name:ie.SignInException,message:"Sequential WEB_AUTHN challenges returned from underlying service cannot be handled."});return{challengeName:d,challengeParameters:u}}function _({username:e,userPoolId:t,userPoolClientId:n}){if(typeof window>"u")return;const o=window.AmazonCognitoAdvancedSecurityData;if(typeof o>"u")return;const s=o.getData(e,t,n);return s?{EncodedData:s}:{}}const ko=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],Bo=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],Jt=()=>{const e=new Date,t=Bo[e.getUTCDay()],n=ko[e.getUTCMonth()],o=e.getUTCDate();let s=e.getUTCHours();s<10&&(s=`0${s}`);let i=e.getUTCMinutes();i<10&&(i=`0${i}`);let a=e.getUTCSeconds();a<10&&(a=`0${a}`);const r=e.getUTCFullYear();return`${t} ${n} ${o} ${s}:${i}:${a} UTC ${r}`},Zt=({userPoolName:e,username:t,challengeParameters:n,dateNow:o,hkdf:s})=>{const i=Ae.convert(e),a=Ae.convert(t),r=qo(n.SECRET_BLOCK),c=Ae.convert(o),d=new Uint8Array(i.byteLength+a.byteLength+r.byteLength+c.byteLength);d.set(i,0),d.set(a,i.byteLength),d.set(r,i.byteLength+a.byteLength),d.set(c,i.byteLength+a.byteLength+r.byteLength);const u=new be(s);u.update(d);const p=u.digestSync();return ge.convert(p)},qo=e=>{const t="=".repeat((4-e.length%4)%4),n=(e+t).replace(/-/g,"+").replace(/_/g,"/"),o=Bt.convert(n),s=new Uint8Array(o.length);for(let i=0;i<o.length;++i)s[i]=o.charCodeAt(i);return s};async function tt({username:e,config:t,clientMetadata:n,session:o,tokenOrchestrator:s}){const{userPoolId:i,userPoolEndpoint:a}=t,r=t.userPoolClientId,c=await s?.getDeviceMetadata(e);qt(c);const d=await qe(c.deviceGroupKey),u={USERNAME:e,SRP_A:d.A.toString(16),DEVICE_KEY:c.deviceKey},p={ChallengeName:"DEVICE_SRP_AUTH",ClientId:r,ChallengeResponses:u,ClientMetadata:n,Session:o},E=ke({endpointResolver:P({endpointOverride:a})}),{ChallengeParameters:h,Session:g}=await E({region:v(i)},p);return Ho(e,h,n,g,d,t,s)}async function Ho(e,t,n,o,s,{userPoolId:i,userPoolClientId:a,userPoolEndpoint:r},c){const d=await c?.getDeviceMetadata(e);qt(d);const u=new m(t?.SRP_B,16),p=new m(t?.SALT,16),{deviceKey:E}=d,{deviceGroupKey:h}=d,g=await s.getPasswordAuthenticationKey({username:d.deviceKey,password:d.randomPassword,serverBValue:u,salt:p}),S=Jt(),x={USERNAME:t?.USERNAME??e,PASSWORD_CLAIM_SECRET_BLOCK:t?.SECRET_BLOCK,TIMESTAMP:S,PASSWORD_CLAIM_SIGNATURE:Zt({username:E,userPoolName:h,challengeParameters:t,dateNow:S,hkdf:g}),DEVICE_KEY:E},I=_({username:e,userPoolId:i,userPoolClientId:a}),A={ChallengeName:"DEVICE_PASSWORD_VERIFIER",ClientId:a,ChallengeResponses:x,Session:o,ClientMetadata:n,UserContextData:I};return ke({endpointResolver:P({endpointOverride:r})})({region:v(i)},A)}async function Gt(e,t,n,o,s,i,a){const{userPoolId:r,userPoolClientId:c,userPoolEndpoint:d}=i,u=r?.split("_")[1]||"",p=new m(t?.SRP_B,16),E=new m(t?.SALT,16),h=t?.USER_ID_FOR_SRP;if(!h)throw new N({name:"EmptyUserIdForSRPException",message:"USER_ID_FOR_SRP was not found in challengeParameters"});const g=await s.getPasswordAuthenticationKey({username:h,password:e,serverBValue:p,salt:E}),S=Jt(),x={USERNAME:h,PASSWORD_CLAIM_SECRET_BLOCK:t?.SECRET_BLOCK,TIMESTAMP:S,PASSWORD_CLAIM_SIGNATURE:Zt({username:h,userPoolName:u,challengeParameters:t,dateNow:S,hkdf:g})},I=await a.getDeviceMetadata(h);I&&I.deviceKey&&(x.DEVICE_KEY=I.deviceKey);const A=_({username:h,userPoolId:r,userPoolClientId:c}),Z={ChallengeName:"PASSWORD_VERIFIER",ChallengeResponses:x,ClientMetadata:n,Session:o,ClientId:c,UserContextData:A},oe=await ke({endpointResolver:P({endpointOverride:d})})({region:v(r)},Z);return oe.ChallengeName==="DEVICE_SRP_AUTH"?tt({username:h,config:i,clientMetadata:n,session:oe.Session,tokenOrchestrator:a}):oe}async function He(e,t,n,o){try{return await e(...t)}catch(s){if(s instanceof N&&s.name==="ResourceNotFoundException"&&s.message.includes("Device does not exist."))return await o.clearDeviceMetadata(n),e(...t);throw s}}function ve(e){const{dispatch:t}=ee;t({type:"SET_USERNAME",value:e})}async function Xt({username:e,password:t,clientMetadata:n,config:o,tokenOrchestrator:s,authFlow:i,preferredChallenge:a}){const{userPoolId:r,userPoolClientId:c,userPoolEndpoint:d}=o,u=r?.split("_")[1]||"",p=await qe(u),E={USERNAME:e,SRP_A:p.A.toString(16)};i==="USER_AUTH"&&a&&(E.PREFERRED_CHALLENGE=a);const h=_({username:e,userPoolId:r,userPoolClientId:c}),g={AuthFlow:i,AuthParameters:E,ClientMetadata:n,ClientId:c,UserContextData:h},x=await Pe({endpointResolver:P({endpointOverride:d})})({region:v(r),userAgentValue:L(O.SignIn)},g),{ChallengeParameters:I,Session:A}=x,Z=I?.USERNAME??e;return ve(Z),x.ChallengeName==="PASSWORD_VERIFIER"?He(Gt,[t,I,n,A,p,o,s],Z,s):x}const Dt="userAttributes.";function jo(e){return"isSignedIn"in e&&"nextStep"in e}async function Wo(e,t,n,o,s){const{userPoolClientId:i,userPoolId:a,userPoolEndpoint:r}=o,c={USERNAME:e,PASSWORD:t},d=await s.getDeviceMetadata(e);d&&d.deviceKey&&(c.DEVICE_KEY=d.deviceKey);const u=_({username:e,userPoolId:a,userPoolClientId:i}),p={AuthFlow:"USER_PASSWORD_AUTH",AuthParameters:c,ClientMetadata:n,ClientId:i,UserContextData:u},h=await Pe({endpointResolver:P({endpointOverride:r})})({region:v(a),userAgentValue:L(O.SignIn)},p),g=h.ChallengeParameters?.USERNAME??h.ChallengeParameters?.USER_ID_FOR_SRP??e;return ve(g),h.ChallengeName==="DEVICE_SRP_AUTH"?tt({username:g,config:o,clientMetadata:n,session:h.Session,tokenOrchestrator:s}):h}async function zo(e,t,n,o,s){return Xt({username:e,password:t,clientMetadata:n,config:o,tokenOrchestrator:s,authFlow:"USER_SRP_AUTH"})}async function Vo(e,t,n,o){const{userPoolClientId:s,userPoolId:i,userPoolEndpoint:a}=n,r={USERNAME:e},c=await o.getDeviceMetadata(e);c&&c.deviceKey&&(r.DEVICE_KEY=c.deviceKey);const d=_({username:e,userPoolId:i,userPoolClientId:s}),u={AuthFlow:"CUSTOM_AUTH",AuthParameters:r,ClientMetadata:t,ClientId:s,UserContextData:d},E=await Pe({endpointResolver:P({endpointOverride:a})})({region:v(i),userAgentValue:L(O.SignIn)},u),h=E.ChallengeParameters?.USERNAME??e;return ve(h),E.ChallengeName==="DEVICE_SRP_AUTH"?tt({username:h,config:n,clientMetadata:t,session:E.Session,tokenOrchestrator:o}):E}async function $o(e,t,n,o,s){T(o);const{userPoolId:i,userPoolClientId:a,userPoolEndpoint:r}=o,c=i?.split("_")[1]||"",d=await qe(c),u={USERNAME:e,SRP_A:d.A.toString(16),CHALLENGE_NAME:"SRP_A"},p=_({username:e,userPoolId:i,userPoolClientId:a}),E={AuthFlow:"CUSTOM_AUTH",AuthParameters:u,ClientMetadata:n,ClientId:a,UserContextData:p},h=Pe({endpointResolver:P({endpointOverride:r})}),{ChallengeParameters:g,Session:S}=await h({region:v(i),userAgentValue:L(O.SignIn)},E),x=g?.USERNAME??e;return ve(x),He(Gt,[t,g,n,S,d,o,s],x,s)}async function Ee(e){const{challengeName:t,challengeParameters:n,availableChallenges:o}=e,s=M.getConfig().Auth?.Cognito;switch(T(s),t){case"CUSTOM_CHALLENGE":return{isSignedIn:!1,nextStep:{signInStep:"CONFIRM_SIGN_IN_WITH_CUSTOM_CHALLENGE",additionalInfo:n}};case"MFA_SETUP":{const{signInSession:i,username:a}=ee.getState(),r=_t(Ot(n.MFAS_CAN_SETUP))||[],c=Zo(r),d=c.includes("TOTP"),u=c.includes("EMAIL");if(d&&u)return{isSignedIn:!1,nextStep:{signInStep:"CONTINUE_SIGN_IN_WITH_MFA_SETUP_SELECTION",allowedMFATypes:c}};if(u)return{isSignedIn:!1,nextStep:{signInStep:"CONTINUE_SIGN_IN_WITH_EMAIL_SETUP"}};if(d){const p=Nn({endpointResolver:P({endpointOverride:s.userPoolEndpoint})}),{Session:E,SecretCode:h}=await p({region:v(s.userPoolId)},{Session:i});return ee.dispatch({type:"SET_SIGN_IN_SESSION",value:E}),{isSignedIn:!1,nextStep:{signInStep:"CONTINUE_SIGN_IN_WITH_TOTP_SETUP",totpSetupDetails:Ko(h,a)}}}throw new N({name:ie.SignInException,message:`Cannot initiate MFA setup from available types: ${r}`})}case"NEW_PASSWORD_REQUIRED":return{isSignedIn:!1,nextStep:{signInStep:"CONFIRM_SIGN_IN_WITH_NEW_PASSWORD_REQUIRED",missingAttributes:Yo(n.requiredAttributes)}};case"SELECT_MFA_TYPE":return{isSignedIn:!1,nextStep:{signInStep:"CONTINUE_SIGN_IN_WITH_MFA_SELECTION",allowedMFATypes:_t(Ot(n.MFAS_CAN_CHOOSE))}};case"SMS_OTP":case"SMS_MFA":return{isSignedIn:!1,nextStep:{signInStep:"CONFIRM_SIGN_IN_WITH_SMS_CODE",codeDeliveryDetails:{deliveryMedium:n.CODE_DELIVERY_DELIVERY_MEDIUM,destination:n.CODE_DELIVERY_DESTINATION}}};case"SOFTWARE_TOKEN_MFA":return{isSignedIn:!1,nextStep:{signInStep:"CONFIRM_SIGN_IN_WITH_TOTP_CODE"}};case"EMAIL_OTP":return{isSignedIn:!1,nextStep:{signInStep:"CONFIRM_SIGN_IN_WITH_EMAIL_CODE",codeDeliveryDetails:{deliveryMedium:n.CODE_DELIVERY_DELIVERY_MEDIUM,destination:n.CODE_DELIVERY_DESTINATION}}};case"WEB_AUTHN":{const i=await Lo(n);return jo(i)?i:Ee(i)}case"PASSWORD":case"PASSWORD_SRP":return{isSignedIn:!1,nextStep:{signInStep:"CONFIRM_SIGN_IN_WITH_PASSWORD"}};case"SELECT_CHALLENGE":return{isSignedIn:!1,nextStep:{signInStep:"CONTINUE_SIGN_IN_WITH_FIRST_FACTOR_SELECTION",availableChallenges:o}}}throw new N({name:ie.SignInException,message:`An error occurred during the sign in process. ${t} challengeName returned by the underlying service was not addressed.`})}function Ko(e,t){return{sharedSecret:e,getSetupUri:(n,o)=>{const s=`otpauth://totp/${n}:${o??t}?secret=${e}&issuer=${n}`;return new En(s)}}}function we(e){if(e===_e.PasswordResetRequiredException)return{isSignedIn:!1,nextStep:{signInStep:"RESET_PASSWORD"}};if(e===_e.UserNotConfirmedException)return{isSignedIn:!1,nextStep:{signInStep:"CONFIRM_SIGN_UP"}}}function Yo(e){return e?JSON.parse(e).map(n=>n.includes(Dt)?n.replace(Dt,""):n):[]}function Jo(e){if(e==="SMS_MFA")return"SMS";if(e==="SOFTWARE_TOKEN_MFA")return"TOTP";if(e==="EMAIL_OTP")return"EMAIL"}function _t(e){if(e)return e.map(Jo).filter(Boolean)}function Ot(e){return e?JSON.parse(e):[]}function Zo(e){return e.filter(t=>t==="EMAIL"||t==="TOTP")}async function Go(){let e;try{e=await Vt()}catch{}if(e&&e.userId&&e.username)throw new N({name:mn,message:"There is already a signed in user.",recoverySuggestion:"Call signOut before calling signIn again."})}function Ce(e){return ee.getState().username??e}async function Xo(e){const t=M.getConfig().Auth?.Cognito;T(t);const{username:n,password:o,options:s}=e,i={loginId:n,authFlowType:"CUSTOM_WITHOUT_SRP"},a=s?.clientMetadata;R(!!n,f.EmptySignInUsername),R(!o,f.CustomAuthSignInPassword);try{const{ChallengeName:r,ChallengeParameters:c,AuthenticationResult:d,Session:u}=await He(Vo,[n,a,t,Q],n,Q),p=Ce(n);return le({signInSession:u,username:p,challengeName:r,signInDetails:i}),d?(await ce({username:p,...d,NewDeviceMetadata:await me({userPoolId:t.userPoolId,userPoolEndpoint:t.userPoolEndpoint,newDeviceMetadata:d.NewDeviceMetadata,accessToken:d.AccessToken}),signInDetails:i}),q(),await de(),{isSignedIn:!0,nextStep:{signInStep:"DONE"}}):Ee({challengeName:r,challengeParameters:c})}catch(r){q(),re(r);const c=we(r.name);if(c)return c;throw r}}async function Qo(e){const{username:t,password:n,options:o}=e,s={loginId:t,authFlowType:"CUSTOM_WITH_SRP"},i=M.getConfig().Auth?.Cognito;T(i);const a=o?.clientMetadata;R(!!t,f.EmptySignInUsername),R(!!n,f.EmptySignInPassword);try{const{ChallengeName:r,ChallengeParameters:c,AuthenticationResult:d,Session:u}=await $o(t,n,a,i,Q),p=Ce(t);return le({signInSession:u,username:p,challengeName:r,signInDetails:s}),d?(await ce({username:p,...d,NewDeviceMetadata:await me({userPoolId:i.userPoolId,userPoolEndpoint:i.userPoolEndpoint,newDeviceMetadata:d.NewDeviceMetadata,accessToken:d.AccessToken}),signInDetails:s}),q(),await de(),{isSignedIn:!0,nextStep:{signInStep:"DONE"}}):Ee({challengeName:r,challengeParameters:c})}catch(r){q(),re(r);const c=we(r.name);if(c)return c;throw r}}function V(e=!0){G.dispatch({type:"RESET"})}async function Lt(e){const{username:t,password:n}=e,o=M.getConfig().Auth?.Cognito,s={loginId:t,authFlowType:"USER_SRP_AUTH"};T(o);const i=e.options?.clientMetadata;R(!!t,f.EmptySignInUsername),R(!!n,f.EmptySignInPassword);try{const{ChallengeName:a,ChallengeParameters:r,AuthenticationResult:c,Session:d}=await zo(t,n,i,o,Q),u=Ce(t);return le({signInSession:d,username:u,challengeName:a,signInDetails:s}),c?(await ce({username:u,...c,NewDeviceMetadata:await me({userPoolId:o.userPoolId,userPoolEndpoint:o.userPoolEndpoint,newDeviceMetadata:c.NewDeviceMetadata,accessToken:c.AccessToken}),signInDetails:s}),q(),await de(),V(),{isSignedIn:!0,nextStep:{signInStep:"DONE"}}):Ee({challengeName:a,challengeParameters:r})}catch(a){q(),V(),re(a);const r=we(a.name);if(r)return r;throw a}}async function es(e){const{username:t,password:n,options:o}=e,s=M.getConfig().Auth?.Cognito,i={loginId:t,authFlowType:"USER_PASSWORD_AUTH"};T(s);const a=o?.clientMetadata;R(!!t,f.EmptySignInUsername),R(!!n,f.EmptySignInPassword);try{const{ChallengeName:r,ChallengeParameters:c,AuthenticationResult:d,Session:u}=await He(Wo,[t,n,a,s,Q],t,Q),p=Ce(t);return le({signInSession:u,username:p,challengeName:r,signInDetails:i}),d?(await ce({...d,username:p,NewDeviceMetadata:await me({userPoolId:s.userPoolId,userPoolEndpoint:s.userPoolEndpoint,newDeviceMetadata:d.NewDeviceMetadata,accessToken:d.AccessToken}),signInDetails:i}),q(),await de(),V(),{isSignedIn:!0,nextStep:{signInStep:"DONE"}}):Ee({challengeName:r,challengeParameters:c})}catch(r){q(),V(),re(r);const c=we(r.name);if(c)return c;throw r}}async function ts({username:e,clientMetadata:t,config:n,tokenOrchestrator:o,preferredChallenge:s,password:i,session:a}){const{userPoolId:r,userPoolClientId:c,userPoolEndpoint:d}=n,u=_({username:e,userPoolId:r,userPoolClientId:c}),p={USERNAME:e};if(s){if(s==="PASSWORD_SRP")return R(!!i,f.EmptySignInPassword),Xt({username:e,password:i,clientMetadata:t,config:n,tokenOrchestrator:o,authFlow:"USER_AUTH",preferredChallenge:s});s==="PASSWORD"&&(R(!!i,f.EmptySignInPassword),p.PASSWORD=i),p.PREFERRED_CHALLENGE=s}const E={AuthFlow:"USER_AUTH",AuthParameters:p,ClientMetadata:t,ClientId:c,UserContextData:u};a&&(E.Session=a);const g=await Pe({endpointResolver:P({endpointOverride:d})})({region:v(r),userAgentValue:L(O.SignIn)},E);return ve(e),g}async function ns(e){const{username:t,password:n,options:o}=e,s=M.getConfig().Auth?.Cognito,i={loginId:t,authFlowType:"USER_AUTH"};T(s);const a=o?.clientMetadata,r=o?.preferredChallenge;R(!!t,f.EmptySignInUsername);try{const c={username:t,config:s,tokenOrchestrator:Q,clientMetadata:a,preferredChallenge:r,password:n},d=G.getState();d.active&&d.username===t&&(c.session=d.session);const u=await ts(c),p=Ce(t);return le({signInSession:u.Session,username:p,challengeName:u.ChallengeName,signInDetails:i}),u.AuthenticationResult?(await ce({username:p,...u.AuthenticationResult,NewDeviceMetadata:await me({userPoolId:s.userPoolId,userPoolEndpoint:s.userPoolEndpoint,newDeviceMetadata:u.AuthenticationResult.NewDeviceMetadata,accessToken:u.AuthenticationResult.AccessToken}),signInDetails:i}),q(),await de(),V(),{isSignedIn:!0,nextStep:{signInStep:"DONE"}}):Ee({challengeName:u.ChallengeName,challengeParameters:u.ChallengeParameters,availableChallenges:"AvailableChallenges"in u?u.AvailableChallenges:void 0})}catch(c){q(),V(),re(c);const d=we(c.name);if(d)return d;throw c}}async function os(e){V(!1);const t=e.options?.authFlowType;switch(await Go(),t){case"USER_SRP_AUTH":return Lt(e);case"USER_PASSWORD_AUTH":return es(e);case"CUSTOM_WITHOUT_SRP":return Xo(e);case"CUSTOM_WITH_SRP":return Qo(e);case"USER_AUTH":return ns(e);default:return Lt(e)}}const ss=180*1e3;function is(e){const t=Ue.listen("auth-internal",async({payload:o})=>{switch(o.event){case"confirmSignUp":o.data?.isSignUpComplete&&(Ue.dispatch("auth-internal",{event:"autoSignIn"}),t())}}),n=setTimeout(()=>{t(),clearTimeout(n),V()},ss)}const as=()=>async e=>{if(e.statusCode>=300){const t=await hn(e);if(re(t),t.name===We.InvalidParameterException&&/'password'/.test(t.message)&&/Member must not be null/.test(t.message)){const n=f.EmptySignUpPassword,{message:o,recoverySuggestion:s}=zt[n];throw new N({name:n,message:o,recoverySuggestion:s})}throw new N({name:t.name,message:t.message})}return gn(e)},rs=e=>$(J,Y("SignUp"),as(),{...K,...e});async function cs(e){const{username:t,password:n,options:o}=e,s=M.getConfig().Auth?.Cognito,i=s?.signUpVerificationMethod??"code",{clientMetadata:a,validationData:r,autoSignIn:c}=e.options??{};T(s),R(!!t,f.EmptySignUpUsername);const d=typeof c!="boolean"?c:void 0;d?.authFlowType;const{userPoolId:u,userPoolClientId:p,userPoolEndpoint:E}=s,h=rs({endpointResolver:P({endpointOverride:E})}),g={Username:t,Password:void 0,UserAttributes:o?.userAttributes&&it(o?.userAttributes),ClientMetadata:a,ValidationData:r&&it(r),ClientId:p,UserContextData:_({username:t,userPoolId:u,userPoolClientId:p})};n&&(g.Password=n);const{UserSub:S,CodeDeliveryDetails:x,UserConfirmed:I,Session:A}=await h({region:v(u),userAgentValue:L(O.SignUp)},g);(d||c===!0)&&(G.dispatch({type:"START"}),G.dispatch({type:"SET_USERNAME",value:t}),G.dispatch({type:"SET_SESSION",value:A}));const Z={destination:x?.Destination,deliveryMedium:x?.DeliveryMedium,attributeName:x?.AttributeName},nt=!!I,oe=G.getState().active;if(nt)return oe?{isSignUpComplete:!0,nextStep:{signUpStep:"COMPLETE_AUTO_SIGN_IN"},userId:S}:{isSignUpComplete:!0,nextStep:{signUpStep:"DONE"},userId:S};if(oe){if(i==="link")return{isSignUpComplete:!1,nextStep:{signUpStep:"COMPLETE_AUTO_SIGN_IN",codeDeliveryDetails:Z},userId:S};is()}return{isSignUpComplete:!1,nextStep:{signUpStep:"CONFIRM_SIGN_UP",codeDeliveryDetails:Z},userId:S}}const ds=e=>$(J,Y("ForgotPassword"),te(),{...K,...e});async function ls(e){const{username:t}=e;R(!!t,f.EmptyResetPasswordUsername);const n=M.getConfig().Auth?.Cognito;T(n);const{userPoolClientId:o,userPoolId:s,userPoolEndpoint:i}=n,a=e.options?.clientMetadata,r=_({username:t,userPoolId:s,userPoolClientId:o}),u=(await ds({endpointResolver:P({endpointOverride:i})})({region:v(s),userAgentValue:L(O.ResetPassword)},{Username:t,ClientMetadata:a,ClientId:o,UserContextData:r})).CodeDeliveryDetails;return{isPasswordReset:!1,nextStep:{resetPasswordStep:"CONFIRM_RESET_PASSWORD_WITH_CODE",codeDeliveryDetails:{deliveryMedium:u?.DeliveryMedium,destination:u?.Destination,attributeName:u?.AttributeName}}}}const us=e=>$(J,Y("ConfirmForgotPassword"),te(),{...K,...e});async function ps(e){const t=M.getConfig().Auth?.Cognito;T(t);const{userPoolClientId:n,userPoolId:o,userPoolEndpoint:s}=t,{username:i,newPassword:a}=e;R(!!i,f.EmptyConfirmResetPasswordUsername),R(!!a,f.EmptyConfirmResetPasswordNewPassword);const r=e.confirmationCode;R(!!r,f.EmptyConfirmResetPasswordConfirmationCode);const c=e.options?.clientMetadata,d=_({username:i,userPoolId:o,userPoolClientId:n});await us({endpointResolver:P({endpointOverride:s})})({region:v(t.userPoolId),userAgentValue:L(O.ConfirmResetPassword)},{Username:i,ConfirmationCode:r,Password:a,ClientMetadata:c,ClientId:t.userPoolClientId,UserContextData:d})}const ms=e=>$(J,Y("ResendConfirmationCode"),te(),{...K,...e});async function Es(e){const{username:t}=e;R(!!t,f.EmptySignUpUsername);const n=M.getConfig().Auth?.Cognito;T(n);const{userPoolClientId:o,userPoolId:s,userPoolEndpoint:i}=n,a=e.options?.clientMetadata,r=_({username:t,userPoolId:s,userPoolClientId:o}),c=ms({endpointResolver:P({endpointOverride:i})}),{CodeDeliveryDetails:d}=await c({region:v(n.userPoolId),userAgentValue:L(O.ResendSignUpCode)},{Username:t,ClientMetadata:a,ClientId:n.userPoolClientId,UserContextData:r}),{DeliveryMedium:u,AttributeName:p,Destination:E}={...d};return{destination:E,deliveryMedium:u,attributeName:p||void 0}}const hs=e=>$(J,Y("ConfirmSignUp"),te(),{...K,...e});async function gs(e){const{username:t,confirmationCode:n,options:o}=e,s=M.getConfig().Auth?.Cognito;T(s);const{userPoolId:i,userPoolClientId:a,userPoolEndpoint:r}=s,c=o?.clientMetadata;R(!!t,f.EmptyConfirmSignUpUsername),R(!!n,f.EmptyConfirmSignUpCode);const d=_({username:t,userPoolId:i,userPoolClientId:a}),u=hs({endpointResolver:P({endpointOverride:r})}),{Session:p}=await u({region:v(s.userPoolId),userAgentValue:L(O.ConfirmSignUp)},{Username:t,ConfirmationCode:n,ClientMetadata:c,ForceAliasCreation:o?.forceAliasCreation,ClientId:s.userPoolClientId,UserContextData:d});return new Promise((E,h)=>{try{const g={isSignUpComplete:!0,nextStep:{signUpStep:"DONE"}},S=G.getState();if(!S.active||S.username!==t){E(g),V();return}G.dispatch({type:"SET_SESSION",value:p});const x=Ue.listen("auth-internal",({payload:I})=>{switch(I.event){case"autoSignIn":E({isSignUpComplete:!0,nextStep:{signUpStep:"COMPLETE_AUTO_SIGN_IN"}}),x()}});Ue.dispatch("auth-internal",{event:"confirmSignUp",data:g})}catch(g){h(g)}})}const fs=async({username:e,password:t})=>{await os({username:e,password:t})},Ss=async({username:e,password:t,firstName:n,lastName:o})=>{await cs({username:e,password:t,options:{userAttributes:{email:e,given_name:n,family_name:o}}})},xs=async({username:e,confirmationCode:t})=>{await gs({username:e,confirmationCode:t})},Is=async({username:e})=>{await Es({username:e})},Qt=async({username:e})=>{await ls({username:e})},ys=async({username:e,confirmationCode:t,newPassword:n})=>{await ps({username:e,confirmationCode:t,newPassword:n})},Rs=Re({code:F().min(1,{message:"Code is required!"}).min(6,{message:"Code must be at least 6 characters!"}),email:F().min(1,{message:"Email is required!"}).email({message:"Email must be a valid email address!"})});function bs(){const e=fe(),n=Ht().get("email"),{countdown:o,counting:s,startCountdown:i}=Wt(60),a={code:"",email:n||""},r=Se({resolver:Ie(Rs),defaultValues:a}),{watch:c,handleSubmit:d,formState:{isSubmitting:u}}=r,p=c(),E=d(async x=>{try{await xs({username:x.email,confirmationCode:x.code}),e.push(B.auth.amplify.signIn)}catch(I){console.error(I)}}),h=Le.useCallback(async()=>{try{i(),await Is?.({username:p.email})}catch(x){console.error(x)}},[i,p.email]),g=l.jsxs(l.Fragment,{children:[l.jsx(Sn,{sx:{mx:"auto"}}),l.jsxs(C,{spacing:1,sx:{mt:3,mb:5,textAlign:"center",whiteSpace:"pre-line"},children:[l.jsx(U,{variant:"h5",children:"Please check your email!"}),l.jsx(U,{variant:"body2",sx:{color:"text.secondary"},children:`We've emailed a 6-digit confirmation code. 
Please enter the code in the box below to verify your email.`})]})]}),S=l.jsxs(C,{spacing:3,children:[l.jsx(b.Text,{name:"email",label:"Email address",placeholder:"example@gmail.com",InputLabelProps:{shrink:!0},disabled:!0}),l.jsx(b.Code,{name:"code"}),l.jsx(ye,{fullWidth:!0,size:"large",type:"submit",variant:"contained",loading:u,loadingIndicator:"Verify...",children:"Verify"}),l.jsxs(U,{variant:"body2",sx:{mx:"auto"},children:["Dont have a code? ",l.jsxs(k,{variant:"subtitle2",onClick:h,sx:{cursor:"pointer",...s&&{color:"text.disabled",pointerEvents:"none"}},children:["Resend code ",s&&`(${o}s)`]})]}),l.jsxs(k,{component:se,href:B.auth.amplify.signIn,color:"inherit",variant:"subtitle2",sx:{gap:.5,alignSelf:"center",alignItems:"center",display:"inline-flex"},children:[l.jsx(ne,{width:16,icon:"eva:arrow-ios-back-fill"}),"Return to sign in"]})]});return l.jsxs(l.Fragment,{children:[g,l.jsx(xe,{methods:r,onSubmit:E,children:S})]})}const Ps=Re({email:F().min(1,{message:"Email is required!"}).email({message:"Email must be a valid email address!"}),password:F().min(1,{message:"Password is required!"}).min(6,{message:"Password must be at least 6 characters!"})});function Us(){const e=fe(),t=$e(),[n,o]=Le.useState(""),{checkUserSession:s}=fn(),i={email:"",password:""},a=Se({resolver:Ie(Ps),defaultValues:i}),{handleSubmit:r,formState:{isSubmitting:c}}=a,d=r(async E=>{try{await fs({username:E.email,password:E.password}),await s?.(),e.refresh()}catch(h){console.error(h),o(h instanceof Error?h.message:h)}}),u=l.jsxs(C,{spacing:1.5,sx:{mb:5},children:[l.jsx(U,{variant:"h5",children:"Sign in to your account"}),l.jsxs(C,{direction:"row",spacing:.5,children:[l.jsx(U,{variant:"body2",sx:{color:"text.secondary"},children:"Don't have an account?"}),l.jsx(k,{component:se,href:B.auth.amplify.signUp,variant:"subtitle2",children:"Get started"})]})]}),p=l.jsxs(C,{spacing:3,children:[l.jsx(b.Text,{name:"email",label:"Email address",InputLabelProps:{shrink:!0}}),l.jsxs(C,{spacing:1.5,children:[l.jsx(k,{component:se,href:B.auth.amplify.resetPassword,variant:"body2",color:"inherit",sx:{alignSelf:"flex-end"},children:"Forgot password?"}),l.jsx(b.Text,{name:"password",label:"Password",placeholder:"6+ characters",type:t.value?"text":"password",InputLabelProps:{shrink:!0},InputProps:{endAdornment:l.jsx(Me,{position:"end",children:l.jsx(De,{onClick:t.onToggle,edge:"end",children:l.jsx(ne,{icon:t.value?"solar:eye-bold":"solar:eye-closed-bold"})})})}})]}),l.jsx(ye,{fullWidth:!0,color:"inherit",size:"large",type:"submit",variant:"contained",loading:c,loadingIndicator:"Sign in...",children:"Sign in"})]});return l.jsxs(l.Fragment,{children:[u,!!n&&l.jsx(jt,{severity:"error",sx:{mb:3},children:n}),l.jsx(xe,{methods:a,onSubmit:d,children:p})]})}const vs=Re({firstName:F().min(1,{message:"First name is required!"}),lastName:F().min(1,{message:"Last name is required!"}),email:F().min(1,{message:"Email is required!"}).email({message:"Email must be a valid email address!"}),password:F().min(1,{message:"Password is required!"}).min(6,{message:"Password must be at least 6 characters!"})});function Ms(){const[e,t]=Le.useState(""),n=fe(),o=$e(),s={firstName:"",lastName:"",email:"",password:""},i=Se({resolver:Ie(vs),defaultValues:s}),{handleSubmit:a,formState:{isSubmitting:r}}=i,c=a(async E=>{try{await Ss({username:E.email,password:E.password,firstName:E.firstName,lastName:E.lastName});const h=new URLSearchParams({email:E.email}).toString(),g=`${B.auth.amplify.verify}?${h}`;n.push(g)}catch(h){console.error(h),t(h instanceof Error?h.message:h)}}),d=l.jsxs(C,{spacing:1.5,sx:{mb:5},children:[l.jsx(U,{variant:"h5",children:"Get started absolutely free"}),l.jsxs(C,{direction:"row",spacing:.5,children:[l.jsx(U,{variant:"body2",sx:{color:"text.secondary"},children:"Already have an account?"}),l.jsx(k,{component:se,href:B.auth.amplify.signIn,variant:"subtitle2",children:"Sign in"})]})]}),u=l.jsxs(C,{spacing:3,children:[l.jsxs(C,{direction:{xs:"column",sm:"row"},spacing:2,children:[l.jsx(b.Text,{name:"firstName",label:"First name",InputLabelProps:{shrink:!0}}),l.jsx(b.Text,{name:"lastName",label:"Last name",InputLabelProps:{shrink:!0}})]}),l.jsx(b.Text,{name:"email",label:"Email address",InputLabelProps:{shrink:!0}}),l.jsx(b.Text,{name:"password",label:"Password",placeholder:"6+ characters",type:o.value?"text":"password",InputLabelProps:{shrink:!0},InputProps:{endAdornment:l.jsx(Me,{position:"end",children:l.jsx(De,{onClick:o.onToggle,edge:"end",children:l.jsx(ne,{icon:o.value?"solar:eye-bold":"solar:eye-closed-bold"})})})}}),l.jsx(ye,{fullWidth:!0,color:"inherit",size:"large",type:"submit",variant:"contained",loading:r,loadingIndicator:"Create account...",children:"Create account"})]}),p=l.jsxs(U,{component:"div",sx:{mt:3,textAlign:"center",typography:"caption",color:"text.secondary"},children:["By signing up, I agree to ",l.jsx(k,{underline:"always",color:"text.primary",children:"Terms of service"})," and ",l.jsx(k,{underline:"always",color:"text.primary",children:"Privacy policy"}),"."]});return l.jsxs(l.Fragment,{children:[d,!!e&&l.jsx(jt,{severity:"error",sx:{mb:3},children:e}),l.jsx(xe,{methods:i,onSubmit:c,children:u}),p]})}const ws=Re({email:F().min(1,{message:"Email is required!"}).email({message:"Email must be a valid email address!"})});function Ds(){const e=fe(),t={email:""},n=Se({resolver:Ie(ws),defaultValues:t}),{handleSubmit:o,formState:{isSubmitting:s}}=n,i=o(async c=>{try{await Qt({username:c.email});const d=new URLSearchParams({email:c.email}).toString(),u=`${B.auth.amplify.updatePassword}?${d}`;e.push(u)}catch(d){console.error(d)}}),a=l.jsxs(l.Fragment,{children:[l.jsx(xn,{sx:{mx:"auto"}}),l.jsxs(C,{spacing:1,sx:{mt:3,mb:5,textAlign:"center",whiteSpace:"pre-line"},children:[l.jsx(U,{variant:"h5",children:"Forgot your password?"}),l.jsx(U,{variant:"body2",sx:{color:"text.secondary"},children:"Please enter the email address associated with your account and we'll email you a link to reset your password."})]})]}),r=l.jsxs(C,{spacing:3,children:[l.jsx(b.Text,{autoFocus:!0,name:"email",label:"Email address",placeholder:"example@gmail.com",InputLabelProps:{shrink:!0}}),l.jsx(ye,{fullWidth:!0,size:"large",type:"submit",variant:"contained",loading:s,loadingIndicator:"Send request...",children:"Send request"}),l.jsxs(k,{component:se,href:B.auth.amplify.signIn,color:"inherit",variant:"subtitle2",sx:{gap:.5,alignSelf:"center",alignItems:"center",display:"inline-flex"},children:[l.jsx(ne,{width:16,icon:"eva:arrow-ios-back-fill"}),"Return to sign in"]})]});return l.jsxs(l.Fragment,{children:[a,l.jsx(xe,{methods:n,onSubmit:i,children:r})]})}const Cs=Re({code:F().min(1,{message:"Code is required!"}).min(6,{message:"Code must be at least 6 characters!"}),email:F().min(1,{message:"Email is required!"}).email({message:"Email must be a valid email address!"}),password:F().min(1,{message:"Password is required!"}).min(6,{message:"Password must be at least 6 characters!"}),confirmPassword:F().min(1,{message:"Confirm password is required!"})}).refine(e=>e.password===e.confirmPassword,{message:"Passwords do not match!",path:["confirmPassword"]});function _s(){const e=fe(),n=Ht().get("email"),o=$e(),{countdown:s,counting:i,startCountdown:a}=Wt(60),r={code:"",email:n||"",password:"",confirmPassword:""},c=Se({resolver:Ie(Cs),defaultValues:r}),{watch:d,handleSubmit:u,formState:{isSubmitting:p}}=c,E=d(),h=u(async I=>{try{await ys({username:I.email,confirmationCode:I.code,newPassword:I.password}),e.push(B.auth.amplify.signIn)}catch(A){console.error(A)}}),g=Le.useCallback(async()=>{try{a(),await Qt({username:E.email})}catch(I){console.error(I)}},[a,E.email]),S=l.jsxs(l.Fragment,{children:[l.jsx(In,{sx:{mx:"auto"}}),l.jsxs(C,{spacing:1,sx:{mt:3,mb:5,textAlign:"center",whiteSpace:"pre-line"},children:[l.jsx(U,{variant:"h5",children:"Request sent successfully!"}),l.jsx(U,{variant:"body2",sx:{color:"text.secondary"},children:`We've sent a 6-digit confirmation email to your email. 
Please enter the code in below box to verify your email.`})]})]}),x=l.jsxs(C,{spacing:3,children:[l.jsx(b.Text,{name:"email",label:"Email address",placeholder:"example@gmail.com",InputLabelProps:{shrink:!0},disabled:!0}),l.jsx(b.Code,{name:"code"}),l.jsx(b.Text,{name:"password",label:"Password",placeholder:"6+ characters",type:o.value?"text":"password",InputLabelProps:{shrink:!0},InputProps:{endAdornment:l.jsx(Me,{position:"end",children:l.jsx(De,{onClick:o.onToggle,edge:"end",children:l.jsx(ne,{icon:o.value?"solar:eye-bold":"solar:eye-closed-bold"})})})}}),l.jsx(b.Text,{name:"confirmPassword",label:"Confirm new password",type:o.value?"text":"password",InputLabelProps:{shrink:!0},InputProps:{endAdornment:l.jsx(Me,{position:"end",children:l.jsx(De,{onClick:o.onToggle,edge:"end",children:l.jsx(ne,{icon:o.value?"solar:eye-bold":"solar:eye-closed-bold"})})})}}),l.jsx(ye,{fullWidth:!0,size:"large",type:"submit",variant:"contained",loading:p,loadingIndicator:"Update password...",children:"Update password"}),l.jsxs(U,{variant:"body2",sx:{mx:"auto"},children:["Dont have a code? ",l.jsxs(k,{variant:"subtitle2",onClick:g,sx:{cursor:"pointer",...i&&{color:"text.disabled",pointerEvents:"none"}},children:["Resend code ",i&&`(${s}s)`]})]}),l.jsxs(k,{component:se,href:B.authDemo.split.signIn,color:"inherit",variant:"subtitle2",sx:{gap:.5,alignSelf:"center",alignItems:"center",display:"inline-flex"},children:[l.jsx(ne,{width:16,icon:"eva:arrow-ios-back-fill"}),"Return to sign in"]})]});return l.jsxs(l.Fragment,{children:[S,l.jsx(xe,{methods:c,onSubmit:h,children:x})]})}export{Us as A,Ms as a,bs as b,_s as c,Ds as d};
