import{r as i,k as e,l as R,S as w,aw as o,n as T,q as ce,v as Z,fC as J,g as he,t as xe,i9 as K,F as ue,aF as u,ia as ee,az as L,ib as Q,aI as O,aZ as G,aC as me,aH as pe,aL as Y,C as M,L as _,u as te,f9 as ge,a as E,e as F,f as $,a_ as X,H as je,aE as be}from"./index-DtP58muJ.js";import{f as I,c as z,b as k}from"./format-number-Ds7vlrjD.js";import{C as v}from"./Card-DhhypByC.js";import{S as b}from"./Skeleton-2yIQyMsS.js";import{T as ye}from"./table-pagination-custom-DoMFqUCQ.js";import{R as V}from"./rhf-date-picker-CTkMAX-z.js";import{T as N}from"./table-body-rowinfo-3iCgRhmq.js";import{O as fe}from"./functions-9irBVDmM.js";import{C}from"./CardHeader-DrP1HthL.js";import{T as ae,a as we,b as U,c as se}from"./TableRow-BeGZSEnl.js";import{T as y}from"./TableCell-BYy3h6md.js";import{u as re,C as ne,a as ve}from"./chart-legends-DbBkpkD-.js";import{C as W}from"./chart-select-Bf17JgO0.js";import{T as De}from"./table-head-custom-CkAC_7gM.js";import"./TablePagination-DcwzPYld.js";import"./LastPage-CTPAXkYQ.js";import"./FormControlLabel-aYt4PlDo.js";import"./DatePicker-C3EXuF80.js";import"./ListItem-B8SR2-3G.js";import"./MobileDateTimePicker-CzOngS04.js";import"./errors-wZ747Yys.js";const Se=i.createContext(void 0),Ce=({children:t})=>{const s=i.useMemo(()=>({}),[]);return e.jsx(Se.Provider,{value:s,children:t})},B=({title:t,value:s,percentage:a,color:r="primary",isLoading:n=!1})=>e.jsxs(v,{sx:{p:3},children:[e.jsx(R,{variant:"subtitle2",children:n?e.jsx(b,{width:"40%",height:22}):t}),e.jsx(w,{direction:"row",justifyContent:"space-between",alignItems:"center",children:n?e.jsxs(e.Fragment,{children:[e.jsx(b,{variant:"text",width:100,height:48}),e.jsx(w,{direction:"row",alignItems:"end",spacing:.25,children:[...Array(8)].map((x,m)=>e.jsx(o,{sx:{width:4,height:`${Math.random()*20+10}px`,borderRadius:1,backgroundColor:"rgba(0,0,0,0.1)"}},m))})]}):e.jsxs(e.Fragment,{children:[e.jsx(R,{variant:"h3",children:I(s)}),e.jsx(w,{direction:"row",alignItems:"end",spacing:.25,children:[2.25,4.5,3.25,2.75,4,2,3.25,2.75].map((x,m)=>e.jsx(o,{sx:p=>({width:p.spacing(.5),height:p.spacing(x),borderRadius:1,backgroundColor:`${r}.main`})},`dashboard-stat-card-${m}`))})]})}),e.jsx(w,{direction:"row",spacing:.5,alignItems:"center",children:n?e.jsxs(e.Fragment,{children:[e.jsx(b,{variant:"circular",width:20,height:22}),e.jsx(b,{width:40,height:22}),e.jsx(b,{width:100,height:22})]}):e.jsxs(e.Fragment,{children:[e.jsx(T,{icon:`solar:double-alt-arrow-${a>=0?"up":"down"}-bold-duotone`,color:a>=0?"success.main":"error.main"}),e.jsxs(R,{variant:"subtitle2",children:[a,"%"]}),e.jsx(R,{variant:"body2",color:"text.secondary",children:"last 7 days"})]})})]}),Te=ce({start_date:Z(),end_date:Z()}),Ie={start_date:"",end_date:""};function Le(){const[t,s]=i.useState(`${J("YYYY-MM")}-01`),[a,r]=i.useState(J("YYYY-MM-DD"));return e.jsxs(v,{children:[e.jsx(C,{title:"Order List",sx:{mb:3}}),e.jsx(Pe,{start_date:t,end_date:a,onChange:(n,x)=>{s(n),r(x)}}),e.jsx(Oe,{start_date:t,end_date:a})]})}function Pe({start_date:t,end_date:s,onChange:a}){const r=he({resolver:xe(Te),defaultValues:Ie}),{control:n,reset:x,getValues:m}=r;i.useEffect(()=>{x({start_date:t,end_date:s})},[t,s]);const p=K({control:n,name:"start_date"}),g=K({control:n,name:"end_date"});return i.useEffect(()=>{const l=m("start_date"),f=m("end_date");l!==""&&f!==""&&a(l,f)},[p,g]),e.jsx(w,{sx:{px:2.5,mb:3,width:{xs:"100%",md:"50%"}},children:e.jsx(ue,{methods:r,children:e.jsxs(u,{container:!0,spacing:3,children:[e.jsx(u,{xs:6,children:e.jsx(V,{name:"start_date",label:"Start date"})}),e.jsx(u,{xs:6,children:e.jsx(V,{name:"end_date",label:"End date"})})]})})})}function Oe({start_date:t,end_date:s}){const a=ee(c=>c.activeStore),[r,n]=i.useState(0),[x,m]=i.useState(0),[p,g]=i.useState(15),[l,f]=i.useState([]),[D,S]=i.useState(!1),P=async()=>{S(!0),await fe({page:r+1,start_date:Q(`${O(t,"YYYY-MM-DD")} 00:00:01`)?.toString(),end_date:Q(`${O(s,"YYYY-MM-DD")} 23:59:59`)?.toString()}).then(c=>{f(c.data),m(c.total),n(c.current_page-1)}).finally(()=>{S(!1)})};i.useEffect(()=>{P()},[t,s,a,r]);const d=(c,H)=>{n(H)},j=c=>{g(parseInt(c.target.value,10)),n(0)};return e.jsxs(e.Fragment,{children:[e.jsx(L,{children:e.jsxs(ae,{size:"medium",sx:{minWidth:0},children:[e.jsx(Re,{}),e.jsx(Ye,{rows:l,status:D?"loading":"finish"})]})}),e.jsx(ye,{dense:!1,page:r,count:x,rowsPerPage:p,rowsPerPageOptions:[15,25,100],onPageChange:d,onRowsPerPageChange:j})]})}const A=[{id:"code",label:"Code",width:10},{id:"customer",label:"Customer",width:100},{id:"phone",label:"Phone",width:100},{id:"items",label:"Items",width:100},{id:"tanggal",label:"Tanggal",width:100},{id:"tagihan",label:"Tagihan",width:100},{id:"terbayar",label:"Terbayar",width:100},{id:"status",label:"Status",width:100}];function Re(){return e.jsx(we,{children:e.jsx(U,{children:A.map(t=>e.jsx(y,{align:t.align||"left",sortDirection:!1,sx:{width:t.width,minWidth:0},children:t.label},t.id))})})}function Ye({rows:t,status:s}){return e.jsx(se,{children:s==="loading"?e.jsx(N,{text:"loading ..",colspan:A.length}):t.length===0?e.jsx(N,{text:"data not found",colspan:A.length}):t.map((a,r)=>e.jsx(Me,{row:a},r))})}function Me({row:t}){return e.jsxs(U,{hover:!0,children:[e.jsx(y,{sx:{whiteSpace:"nowrap"},children:t.order_no}),e.jsx(y,{sx:{whiteSpace:"nowrap"},children:t.customer?.name??"-"}),e.jsx(y,{sx:{whiteSpace:"nowrap"},children:t.customer?.phone??"-"}),e.jsx(y,{sx:{whiteSpace:"nowrap"},children:t.order_products_count}),e.jsx(y,{sx:{whiteSpace:"nowrap"},children:O(Number(t.date),G.dateTime)}),e.jsx(y,{sx:{whiteSpace:"nowrap"},children:I(t.net_payable_amount)}),e.jsx(y,{sx:{whiteSpace:"nowrap"},children:I(t.amount_paid)}),e.jsx(y,{sx:{whiteSpace:"nowrap"},children:e.jsx(me,{variant:"soft",color:pe(t.status),children:t.status})})]})}function _e({isLoading:t,rows:s}){return t?e.jsx(b,{variant:"rounded",sx:{width:"100%",height:384}}):e.jsxs(v,{children:[e.jsx(C,{title:"Product",subheader:"5 best selling products"}),e.jsx(L,{sx:{minHeight:384,maxHeight:384},children:e.jsx(o,{sx:{p:3,gap:3,display:"flex",flexDirection:"column"},children:s.map((a,r)=>e.jsx(Ee,{item:a},r))})})]})}function Ee({item:t}){return e.jsxs(o,{sx:{gap:2,display:"flex",alignItems:"center"},children:[e.jsx(Y,{variant:"rounded",alt:t.name,src:`${M.site.basePath}/assets/icons/empty/ic-folder-empty.svg`,sx:{width:48,height:48,flexShrink:0}}),e.jsxs(o,{sx:{gap:.5,minWidth:0,display:"flex",flex:"1 1 auto",flexDirection:"column"},children:[e.jsx(_,{noWrap:!0,sx:{color:"text.primary",typography:"subtitle2"},children:t.name}),e.jsxs(o,{sx:{gap:.5,display:"flex",typography:"body2",color:"text.secondary",alignItems:"center"},children:[e.jsx(T,{width:16,icon:"ep:sell",sx:{color:"text.disabled"}}),e.jsx(o,{component:"span",sx:{color:"inherit"},children:I(t.total)})]})]})]})}function Fe({isLoading:t,rows:s}){return t?e.jsx(b,{variant:"rounded",sx:{width:"100%",height:384}}):e.jsxs(v,{children:[e.jsx(C,{title:"Customer",subheader:"5 most ordered customers"}),e.jsx(L,{sx:{minHeight:384,maxHeight:384},children:e.jsx(o,{sx:{p:3,gap:3,display:"flex",flexDirection:"column"},children:s.map((a,r)=>e.jsx(He,{item:a},r))})})]})}function He({item:t}){return e.jsxs(o,{sx:{gap:2,display:"flex",alignItems:"center"},children:[e.jsx(Y,{alt:t.name,src:`${M.site.basePath}/assets/icons/glass/ic-glass-users.svg`,sx:{width:48,height:48,flexShrink:0}}),e.jsxs(o,{sx:{gap:.5,minWidth:0,display:"flex",flex:"1 1 auto",flexDirection:"column"},children:[e.jsx(_,{noWrap:!0,sx:{color:"text.primary",typography:"subtitle2"},children:t.name}),e.jsxs(w,{spacing:1,direction:"row",alignItems:"center",divider:e.jsx(o,{sx:{width:4,height:4,borderRadius:"50%",bgcolor:"text.disabled"}}),children:[e.jsxs(o,{sx:{gap:.5,display:"flex",typography:"body2",color:"text.secondary",alignItems:"center"},children:[e.jsx(T,{width:16,icon:"lets-icons:bag-alt",sx:{color:"text.disabled"}}),e.jsx(o,{component:"span",sx:{color:"inherit"},children:I(t.totalOrder)})]}),e.jsxs(o,{sx:{gap:.5,display:"flex",typography:"body2",color:"text.secondary",alignItems:"center"},children:[e.jsx(T,{width:13,icon:"subway:coin",sx:{color:"text.disabled"}}),e.jsx(o,{component:"span",sx:{color:"inherit"},children:z(t.totalValue)})]})]})]})]})}function $e({isLoading:t,rows:s}){return t?e.jsx(b,{variant:"rounded",sx:{width:"100%",height:384}}):e.jsxs(v,{children:[e.jsx(C,{title:"Stores",subheader:"5 stores with the highest revenue"}),e.jsx(L,{sx:{minHeight:384,maxHeight:384},children:e.jsx(o,{sx:{p:3,gap:3,display:"flex",flexDirection:"column"},children:s.map((a,r)=>e.jsx(ke,{item:a},r))})})]})}function ke({item:t}){return e.jsxs(o,{sx:{gap:2,display:"flex",alignItems:"center"},children:[e.jsx(Y,{alt:t.name,src:"/assets/images/avatar/avatar-2.webp",sx:{width:48,height:48,flexShrink:0}}),e.jsxs(o,{sx:{gap:.5,minWidth:0,display:"flex",flex:"1 1 auto",flexDirection:"column"},children:[e.jsx(_,{noWrap:!0,sx:{color:"text.primary",typography:"subtitle2"},children:t.name}),e.jsxs(w,{spacing:1,direction:"row",alignItems:"center",divider:e.jsx(o,{sx:{width:4,height:4,borderRadius:"50%",bgcolor:"text.disabled"}}),children:[e.jsxs(o,{sx:{gap:.5,display:"flex",typography:"body2",color:"text.secondary",alignItems:"center"},children:[e.jsx(T,{width:16,icon:"gridicons:product",sx:{color:"text.disabled"}}),e.jsx(o,{component:"span",sx:{color:"inherit"},children:I(t.totalOrder)})]}),e.jsxs(o,{sx:{gap:.5,display:"flex",typography:"body2",color:"text.secondary",alignItems:"center"},children:[e.jsx(T,{width:13,icon:"subway:coin",sx:{color:"text.disabled"}}),e.jsx(o,{component:"span",sx:{color:"inherit"},children:z(t.totalValue)})]})]})]})]})}function We({isLoading:t,rows:s}){return t?e.jsx(b,{variant:"rounded",sx:{width:"100%",height:260}}):e.jsxs(v,{children:[e.jsx(C,{title:"Birthday",subheader:"customers will have a birthday this month",sx:{mb:3}}),e.jsx(L,{sx:{minHeight:260,maxHeight:260},children:e.jsx(o,{sx:{p:3,gap:3,display:"flex",flexDirection:"column"},children:s.map((a,r)=>e.jsx(Be,{item:a},r))})})]})}function Be({item:t}){return e.jsxs(o,{sx:{gap:2,display:"flex",alignItems:"center"},children:[e.jsx(Y,{alt:t.name,src:`${M.site.basePath}/assets/icons/empty/ic-email-selected.svg`,sx:{width:48,height:48,flexShrink:0}}),e.jsxs(o,{sx:{gap:.5,minWidth:0,display:"flex",flex:"1 1 auto",flexDirection:"column"},children:[e.jsx(_,{noWrap:!0,sx:{color:"text.primary",typography:"subtitle2"},children:t.name}),e.jsxs(o,{sx:{gap:.5,display:"flex",typography:"body2",color:"text.secondary",alignItems:"center"},children:[e.jsx(T,{width:16,icon:"tabler:calendar",sx:{color:"text.disabled"}}),e.jsx(o,{component:"span",sx:{color:"inherit"},children:O(t.birthDate,G.date)})]})]})]})}function Ne({title:t,subheader:s,chart:a,isLoading:r=!1,...n}){const x=te(),m=a.colors??[x.palette.success.lighter,x.palette.success.light,x.palette.success.dark,x.palette.success.darker],p=a.series.map(l=>l.value),g=re({chart:{sparkline:{enabled:!0}},colors:m,labels:a.series.map(l=>l.label),stroke:{width:0},tooltip:{y:{formatter:l=>k(l),title:{formatter:l=>`${l}`}}},plotOptions:{pie:{donut:{size:"72%",labels:{value:{formatter:l=>k(l)},total:{formatter:l=>{const f=l.globals.seriesTotals.reduce((D,S)=>D+S,0);return k(f)}}}}}},...a.options});return e.jsxs(v,{...n,children:[r?e.jsxs(o,{sx:{p:3},children:[e.jsx(b,{variant:"text",width:"40%",height:28}),e.jsx(b,{variant:"text",width:"60%",height:22,sx:{mt:.5}})]}):e.jsx(C,{title:t,subheader:s}),r?e.jsx(b,{variant:"circular",animation:"wave",sx:{flex:1,my:6,mx:3,height:{xs:240,xl:260}}}):e.jsx(ne,{type:"donut",series:p,options:g,height:{xs:240,xl:260},sx:{my:6,mx:"auto",flex:1}})]})}function Ae({title:t,subheader:s,filterValues:a,chartDaily:r,chartMonthly:n,isLoading:x=!1,...m}){const p=te(),[g,l]=i.useState(),f=re({colors:[p.palette.success.main,p.palette.warning.main],xaxis:{categories:a.timeInterval.data==="monthly"?n?.categories:r?.categories}}),D=a.timeInterval.data==="monthly"?n?.series.map(d=>d.name):r?.series.map(d=>d.name),S=r?.series.map(d=>d.data.map(j=>j.name)).flat(),P=["monthly","daily"];return i.useEffect(()=>{if(a.timeInterval.data==="monthly"&&n!==null){const d=n.series.find(j=>j.name===a.year.data);l(d)}else if(a.timeInterval.data==="daily"&&r!==null){const j=r?.series.find(c=>c.name===a.year.data)?.data.find(c=>c.name===a.month.data);j&&l({name:j.name,data:[j.data]})}},[r,n]),e.jsxs(v,{...m,children:[e.jsx(C,{title:t,subheader:s,action:e.jsxs(w,{spacing:1,direction:"row",children:[e.jsx(W,{options:D??[],value:a.year.data,onChange:a.year.setData}),e.jsx(W,{options:P,value:a.timeInterval.data,onChange:a.timeInterval.setData,renderLabel:d=>ge(d)}),a.timeInterval.data==="daily"&&e.jsx(W,{options:S??[],value:a.month.data,onChange:a.month.setData})]}),sx:{mb:3}}),g&&e.jsx(ve,{colors:f?.colors,labels:g.data.map(d=>d.name),values:g.data.map(d=>z(d.data.reduce((j,c)=>j+c,0))),sx:{px:3,gap:3}}),g&&g?.data?.length>0?e.jsx(ne,{type:"area",series:g.data,options:f,height:320,sx:{py:2.5,pl:1,pr:2.5}}):e.jsx(w,{sx:{height:340},alignItems:"center",justifyContent:"center",children:"No Data"})]})}const Ge=async()=>{try{return(await E.get(`${F.dashboard.data}`)).data}catch{throw new Error("unexpected error occurred")}},ze=async()=>{try{return(await E.get(`${F.dashboard.revenue}?timeInterval=monthly`)).data}catch{throw new Error("unexpected error occurred")}},Ue=async()=>{try{return(await E.get(`${F.dashboard.revenue}?timeInterval=daily`)).data}catch{throw new Error("unexpected error occurred")}},qe=async()=>{try{return(await E.get(`${F.dashboard.customer}`)).data}catch{throw new Error("unexpected error occurred")}};function Ze({isLoading:t,rows:s}){const a=[{id:"no",label:"No",align:"left"},{id:"name",label:"Seller",align:"left"},{id:"lastOrder",label:"Last Order",align:"left"}];return t?e.jsx(b,{variant:"rounded",sx:{width:"100%",height:260}}):e.jsxs(v,{children:[e.jsx(C,{title:"Need Attention",subheader:"longest customer haven't visited",sx:{mb:3}}),e.jsx(L,{sx:{minHeight:260,maxHeight:260},children:e.jsxs(ae,{stickyHeader:!0,sx:{minWidth:640},children:[e.jsx(De,{headLabel:a}),e.jsx(se,{children:s.length===0?e.jsx(N,{text:"data not found",colspan:a.length}):s.map((r,n)=>e.jsx(Je,{no:n+1,item:r},n))})]})})]})}function Je({no:t,item:s}){return e.jsxs(U,{children:[e.jsx(y,{align:"left",children:t}),e.jsx(y,{align:"left",children:s.name}),e.jsx(y,{align:"left",children:O(s.lastOrder,G.dateTime)})]})}const Ke={title:`Dashboard - ${M.site.name}`};function bt(){const t=ee(h=>h.activeStore),s=$(!0),a=$(!0),r=$(!0),[n,x]=i.useState(),[m,p]=i.useState(null),[g,l]=i.useState(null),[f,D]=i.useState(0),[S,P]=i.useState(),[d,j]=i.useState(X().format("YYYY")),[c,H]=i.useState("monthly"),[q,oe]=i.useState(X().format("MMM"));i.useEffect(()=>{s.onTrue(),(async()=>{const h=await Ge();x(h),s.onFalse()})()},[t]),i.useEffect(()=>{a.onTrue(),(async()=>{if(c==="monthly"){const h=await ze();D(h.growth),p(h),l(null)}else{const h=await Ue();D(h.growth),l(h),p(null)}a.onFalse()})()},[t,d,c,q]),i.useEffect(()=>{r.onTrue(),(async()=>{const h=await qe();P(h.data),r.onFalse()})()},[t]);const ie=i.useCallback(h=>{j(h)},[]),le=i.useCallback(h=>{H(h)},[]),de=i.useCallback(h=>{oe(h)},[]);return e.jsxs(e.Fragment,{children:[e.jsx(je,{children:e.jsxs("title",{children:[" ",Ke.title]})}),e.jsx(Ce,{children:e.jsx(be,{maxWidth:"xl",children:e.jsxs(u,{container:!0,spacing:3,children:[e.jsx(u,{xs:12,md:4,children:e.jsx(B,{title:"Monthly Sales",value:n?.monthlySales.value??0,percentage:n?.monthlySales.percentage??0,color:"success",isLoading:s.value})}),e.jsx(u,{xs:12,md:4,children:e.jsx(B,{title:"Total Customers",value:n?.totalCustomers.value??0,percentage:n?.totalCustomers.percentage??0,color:"info",isLoading:s.value})}),e.jsx(u,{xs:12,md:4,children:e.jsx(B,{title:"Total Orders",value:n?.totalOrders.value??0,percentage:n?.totalOrders.percentage??0,color:"error",isLoading:s.value})}),e.jsx(u,{xs:12,md:8,children:e.jsx(Ae,{title:"Revenue",subheader:`(${f}%) than last year`,filterValues:{year:{data:d,setData:ie},timeInterval:{data:c,setData:le},month:{data:q,setData:de}},chartMonthly:m,chartDaily:g,isLoading:a.value})}),e.jsx(u,{xs:12,md:4,children:e.jsx(Ne,{title:"Sales Categories",subheader:"Product Sales by Category",chart:{series:n?.saleByCategory??[]},sx:{height:"100%",display:"flex",flexDirection:"column"},isLoading:s.value})}),e.jsx(u,{xs:12,md:4,children:e.jsx(_e,{isLoading:s.value,rows:n?.topFiveProducts??[]})}),e.jsx(u,{xs:12,md:4,children:e.jsx(Fe,{isLoading:s.value,rows:n?.topFiveCustomers??[]})}),e.jsx(u,{xs:12,md:4,children:e.jsx($e,{isLoading:s.value,rows:n?.topFiveStoreRevenue??[]})}),e.jsx(u,{xs:12,md:8,children:e.jsx(Ze,{isLoading:r.value,rows:S??[]})}),e.jsx(u,{xs:12,md:4,children:e.jsx(We,{isLoading:s.value,rows:n?.upcomingBirthday??[]})}),e.jsx(u,{xs:12,children:e.jsx(Le,{})})]})})})]})}export{bt as default};
