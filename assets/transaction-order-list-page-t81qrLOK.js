import{k as t,c as Z,d as W,r as l,p as $,L as q,aI as p,aZ as J,aC as _,iO as K,iP as Q,aG as G,aH as N,f as y,g as X,t as tt,S as F,F as et,aF as w,ay as at,I as st,n as m,dg as rt,ag as T,gN as nt,cc as R,o as k,l as B,dC as it,ia as O,ie as ot,bI as E,ca as lt,c9 as dt,cb as ct,aw as ut,az as ht,ib as I,R as xt,H as mt,C as pt,aE as ft}from"./index-DtP58muJ.js";import{u as Y,O as gt,a as jt,P as bt}from"./schema-DQhWclB9.js";import{T as wt}from"./table-pagination-custom-DoMFqUCQ.js";import{a as M,b as St,O as yt}from"./functions-9irBVDmM.js";import{a as Tt,b as U,c as vt,T as Lt}from"./TableRow-BeGZSEnl.js";import{T as d}from"./TableCell-BYy3h6md.js";import{T as A}from"./table-body-rowinfo-3iCgRhmq.js";import{f as z}from"./format-number-Ds7vlrjD.js";import{R as H}from"./rhf-date-picker-CTkMAX-z.js";import{B as Ct}from"./ButtonGroup-Bt9CCMsf.js";import{S as Pt}from"./Skeleton-2yIQyMsS.js";import{C as _t}from"./Card-DhhypByC.js";import{C as Ft}from"./custom-breadcrumbs-C-JLSHAz.js";import"./schemas-wXp1Tq2Y.js";import"./schemas-BYVi3ewV.js";import"./TablePagination-DcwzPYld.js";import"./LastPage-CTPAXkYQ.js";import"./FormControlLabel-aYt4PlDo.js";import"./errors-wZ747Yys.js";import"./DatePicker-C3EXuF80.js";import"./ListItem-B8SR2-3G.js";import"./MobileDateTimePicker-CzOngS04.js";import"./getValidReactChildren-BiSV1uXg.js";const D=[{id:"code",label:"Code",width:10},{id:"customer",label:"Customer",width:100},{id:"phone",label:"Phone",width:100},{id:"items",label:"Items",width:100},{id:"tanggal",label:"Date",width:100},{id:"tagihan",label:"Bill amount",width:100},{id:"terbayar",label:"Paid amount",width:100},{id:"payment_status",label:"Payment",width:100},{id:"status",label:"Status",width:100}];function Dt(){return t.jsx(Tt,{children:t.jsx(U,{children:D.map(e=>t.jsx(d,{align:e.align||"left",sortDirection:!1,sx:{width:e.width,minWidth:0},children:e.label},e.id))})})}function Ot({row:e}){const r=Z(),{checkAbilities:a}=W(),i=l.useCallback(c=>{a?.("order-detail:view")&&r.push(`${$.dashboard.transaction.order.details(c)}`)},[r]);return t.jsxs(U,{hover:!0,onClick:()=>i(e.id),sx:{cursor:"pointer"},children:[t.jsx(d,{sx:{whiteSpace:"nowrap"},children:a?.("order-detail:view")?t.jsx(q,{color:"inherit",underline:"always",children:e.order_no}):t.jsx(t.Fragment,{children:e.order_no})}),t.jsx(d,{sx:{whiteSpace:"nowrap"},children:e.customer?.name??"-"}),t.jsx(d,{sx:{whiteSpace:"nowrap"},children:e.customer?.phone??"-"}),t.jsx(d,{sx:{whiteSpace:"nowrap"},children:e.order_products_count}),t.jsx(d,{sx:{whiteSpace:"nowrap"},children:p(Number(e.date),J.dateTime)}),t.jsx(d,{sx:{whiteSpace:"nowrap"},children:z(e.net_payable_amount)}),t.jsx(d,{sx:{whiteSpace:"nowrap"},children:z(e.amount_paid)}),t.jsx(d,{sx:{whiteSpace:"nowrap"},children:t.jsx(_,{variant:"soft",color:Q(e.payment_status),children:K(e.payment_status)})}),t.jsx(d,{sx:{whiteSpace:"nowrap"},children:t.jsx(_,{variant:"soft",color:N(e.status),children:G(e.status)})})]})}function Yt({rows:e,status:r}){return t.jsx(vt,{children:r==="loading"?t.jsx(A,{text:"loading ..",colspan:D.length}):e.length===0?t.jsx(A,{text:"data not found",colspan:D.length}):e.map((a,i)=>t.jsx(Ot,{row:a},i))})}function Rt(){const e=l.useRef(null),r=y(!1),a=y(!1),i=y(!1),{orderListRefreshFlagUpdate:c,orderListStatusFilter:u,orderListToolbarSearchValueUpdate:b}=Y(),f=X({resolver:tt(jt),defaultValues:gt}),{watch:S,reset:s,handleSubmit:n,formState:{errors:h}}=f,x=async o=>{b(o),c()},g=async o=>{o.start_date?.message&&it.warning(o.start_date?.message,{position:"top-center"})},v=async o=>{a.onTrue(),await M({start_date:p(o.start_date,"YYYY-M-D")??"",end_date:p(o.end_date,"YYYY-M-D")??"",status:u?.status??"",file_type:"pdf"}).finally(()=>{a.onFalse()})},L=async o=>{i.onTrue(),await M({start_date:p(o.start_date,"YYYY-M-D")??"",end_date:p(o.end_date,"YYYY-M-D")??"",status:u?.status??"",file_type:"xlsx"}).finally(()=>{i.onFalse()})};return t.jsxs(t.Fragment,{children:[t.jsx(F,{sx:{p:2.5},children:t.jsx(et,{methods:f,children:t.jsxs(w,{container:!0,spacing:2,children:[t.jsx(w,{xs:12,lg:4,children:t.jsx(at,{size:"medium",name:"keyword",placeholder:"Search order...",InputProps:{startAdornment:t.jsx(st,{position:"start",children:t.jsx(m,{icon:"eva:search-fill",sx:{color:"text.disabled"}})})}})}),t.jsx(w,{xs:12,lg:3,children:t.jsx(H,{name:"start_date",label:"Start Date",hideErrorMessage:!0})}),t.jsx(w,{xs:12,lg:3,children:t.jsx(H,{name:"end_date",label:"End Date"})}),t.jsx(w,{xs:12,lg:2,children:t.jsxs(F,{spacing:1,direction:"row",sx:{height:"100%",alignItems:"stretch"},children:[t.jsx(rt,{title:"search",arrow:!0,children:t.jsx("span",{style:{display:"flex",flex:1},children:t.jsx(T,{fullWidth:!0,color:"info",variant:"outlined",sx:{height:"100%"},onClick:n(x,g),children:t.jsx(m,{icon:"material-symbols:search-rounded"})})})}),t.jsxs(Ct,{variant:"outlined","aria-label":"Print actions",color:"primary",ref:e,onClick:r.onToggle,children:[t.jsx(T,{size:"medium",startIcon:t.jsx(m,{icon:"hugeicons:printer"}),children:"Print"}),t.jsx(T,{size:"medium",children:t.jsx(m,{icon:"ion:md-arrow-dropdown"})})]})]})})]})})}),t.jsxs(nt,{open:r.value,anchorEl:e.current,onClose:r.onFalse,anchorOrigin:{vertical:"bottom",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"right"},slotProps:{paper:{sx:{mt:1,borderRadius:1,minWidth:e.current?.offsetWidth||160}}},children:[t.jsx(R,{sx:{p:0},children:t.jsx(k,{disabled:!0,fullWidth:!0,size:"medium",type:"submit",color:"info",variant:"contained",loading:a.value,startIcon:t.jsx(m,{icon:"mingcute:pdf-fill"}),onClick:n(v,g),children:t.jsx(B,{variant:"subtitle2",children:"Pdf"})})}),t.jsx(R,{sx:{p:0},children:t.jsx(k,{fullWidth:!0,size:"medium",type:"submit",color:"info",variant:"contained",loading:i.value,startIcon:t.jsx(m,{icon:"ri:file-excel-2-fill"}),onClick:n(L,g),children:t.jsx(B,{variant:"subtitle2",children:"Excel"})})})]})]})}function kt(){const{orderListStatusFilterUpdate:e}=Y(),r=O(s=>s.activeStore),a=y(),[i,c]=l.useState([]),[u,b]=l.useState(ot.all),f=async()=>{a.onTrue(),await St().then(s=>{const n=s.sort((h,x)=>h.status==="All"?-1:x.status==="All"?1:0);c(n)}).finally(()=>{a.onFalse()})};l.useEffect(()=>{f()},[r]);const S=(s,n)=>{b(n);const h=i.find(x=>x.status===n);h&&e(h)};return a.value?t.jsx(F,{spacing:2,direction:"row",sx:{px:2.5,py:1.2,boxShadow:s=>`inset 0 -2px 0 0 ${E(s.vars.palette.grey["500Channel"],.08)}`},children:Array.from({length:4}).map((s,n)=>t.jsx(Pt,{variant:"rectangular",sx:{width:100,height:30}},n))}):t.jsx(lt,{value:u,scrollButtons:!0,onChange:S,sx:{boxShadow:s=>`inset 0 -2px 0 0 ${E(s.vars.palette.grey["500Channel"],.08)}`,[`& .${ct.scrollButtons}`]:{"&.Mui-disabled":{opacity:.3}}},children:i.map((s,n)=>t.jsx(dt,{value:s.status,label:G(s.status),iconPosition:"end",icon:t.jsx(_,{variant:s.status===u&&"filled"||"soft",color:N(s.status),children:s.count})},n))})}function Bt(){const{orderListRefreshFlag:e,orderListStatusFilter:r,orderListToolbarSearchValue:a}=Y(),i=O(j=>j.activeStore),[c,u]=l.useState(0),[b,f]=l.useState(0),[S,s]=l.useState(15),[n,h]=l.useState([]),[x,g]=l.useState(!1),v=async()=>{g(!0);const j=a?I(`${p(a.start_date,"YYYY-MM-DD")} 00:00:01`)?.toString():"",C=a?I(`${p(a.end_date,"YYYY-MM-DD")} 23:59:59`)?.toString():"",V=a?a.keyword:"";await yt({status:r?.status??"",page:c+1,start_date:j,end_date:C,keyword:V}).then(P=>{h(P.data),f(P.total),u(P.current_page-1)}).finally(()=>{g(!1)})};l.useEffect(()=>{v()},[e,c,r,i]);const L=(j,C)=>{u(C)},o=j=>{s(parseInt(j.target.value,10)),u(0)};return t.jsxs(_t,{children:[t.jsx(kt,{}),t.jsx(Rt,{}),t.jsx(ut,{sx:{position:"relative"},children:t.jsx(ht,{children:t.jsxs(Lt,{size:"medium",sx:{minWidth:0},children:[t.jsx(Dt,{}),t.jsx(Yt,{rows:n,status:x?"loading":"finish"})]})})}),t.jsx(wt,{dense:!1,page:c,count:b,rowsPerPage:S,rowsPerPageOptions:[15,25,100],onPageChange:L,onRowsPerPageChange:o})]})}function Et(){const{checkAbilities:e}=W(),r=O(a=>a.activeStore);return t.jsx(Ft,{heading:"Order List",links:[{name:"Transaction",href:"#"},{name:"Order List",href:"#"}],action:e?.("order:create")&&t.jsx(T,{size:"medium",variant:"contained",component:xt,disabled:r?.id==="",startIcon:t.jsx(m,{icon:"mingcute:add-line"}),href:$.dashboard.transaction.order.details("new"),children:"New Order"}),sx:{mb:{xs:3,md:5}}})}function It(){return t.jsxs(bt,{children:[t.jsx(Et,{}),t.jsx(Bt,{})]})}const Mt={title:`Transaction - Order List - ${pt.site.name}`};function le(){return t.jsxs(t.Fragment,{children:[t.jsx(mt,{children:t.jsxs("title",{children:[" ",Mt.title]})}),t.jsx(ft,{maxWidth:"xl",children:t.jsx(It,{})})]})}export{le as default};
