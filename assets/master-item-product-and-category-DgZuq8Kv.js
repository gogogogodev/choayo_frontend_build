import{f as M,r as a,k as e,q as k,aA as A,v as h,cC as Ie,i7 as X,g as N,t as L,c6 as Y,F as $,dj as Z,c8 as J,aF as x,ay as T,aU as Be,is as le,bZ as ee,ag as V,o as se,bH as de,aw as W,az as te,cP as ne,d as I,m as z,n as C,cQ as oe,cd as ae,cc as E,cD as ue,fs as ze,S as he,I as Ce,H as Se,C as me,aE as _e,d$ as Ge,d_ as H,fA as Ue,l as Oe,aC as Qe,dC as Xe,it as Ye,c9 as Ze}from"./index-DtP58muJ.js";import{C as G}from"./errors-wZ747Yys.js";import{F as ie}from"./form-caption-DmEucZqR.js";import{A as Je,a as es,b as Ne,c as ss,C as Le,d as ts,e as ns}from"./functions-CtLgfECa.js";import{T as Fe}from"./table-pagination-custom-DoMFqUCQ.js";import{a as xe,b as O,T as re,c as ce}from"./TableRow-BeGZSEnl.js";import{T as f}from"./TableCell-BYy3h6md.js";import{f as $e}from"./format-number-Ds7vlrjD.js";import{T as K}from"./table-body-rowinfo-3iCgRhmq.js";import{C as Te}from"./Card-DhhypByC.js";import{C as ke}from"./custom-breadcrumbs-C-JLSHAz.js";import{D as os}from"./divider-zaWZkuz6.js";import{R as as}from"./rhf-switch-zGDsqso1.js";import{a as Q}from"./rhf-checkbox-DPISWm_F.js";import{R as Ae}from"./rhf-autocomplete-on-enter-DZm-8Fkx.js";import{p as is,a as rs,b as cs,c as ls,d as qe,e as ds,f as us,g as hs}from"./product-icon-P7cd-ly2.js";import{T as ye,P as ms}from"./product-table-head-DfHN3w3w.js";import{T as xs,a as ps,b as je}from"./TabPanel-CcPv7mqK.js";import"./TablePagination-DcwzPYld.js";import"./LastPage-CTPAXkYQ.js";import"./FormControlLabel-aYt4PlDo.js";import"./FormGroup-BxqFH-77.js";const He=a.createContext(void 0),q=()=>{const t=a.useContext(He);if(t===void 0)throw new Error("useContextSearch must be used within a PageContext.Provider");return t},gs=({children:t})=>{const n=M(),s=M(),[o,i]=a.useState(0),r=()=>i(y=>y+1),[c,d]=a.useState({refresh_number:0}),l=y=>{r()},[p,v]=a.useState(""),m=y=>{v(y)},[b,P]=a.useState(null),w=y=>{P(y)},[g,S]=a.useState(null),u=y=>{S(y)},[j,_]=a.useState(0),D=y=>{_(y)},[F,R]=a.useState(0),pe=y=>{R(y)},ge=a.useMemo(()=>({isDialogFormOpen:n,isDialogFormAddOnsPriceOpen:s,refreshFlag:o,triggerRefresh:r,refreshFlagAddOnsPrice:c,triggerRefreshAddOnsPrice:l,addOnsFormValues:b,updateAddOnsFormValues:w,addOnsPriceFormValues:g,updateAddOnsPriceFormValues:u,keyword:p,updateKeyword:m,page:j,updatePage:D,rowsPerPage:F,updateRowsPerPage:pe}),[n,s,o,b,p,j,F]);return e.jsx(He.Provider,{value:ge,children:t})};k({id:h(),name:h().min(1,{message:"Name is required!"})});const js=k({id:h().nullable(),name:h().min(1,{message:"Name is required!"}),sku:h().min(1,{message:"SKU is required!"}),price_type:Ie(Object.values(A),{message:"invalid price type!"}),price_value:h().min(1,{message:"Price is required!"})}),fe={id:null,name:"",sku:"",price_type:A.absolute,price_value:"0"},fs=k({id:h().nullable(),store_id:h().nullable(),store_name:h(),addon_id:h(),price_type:Ie(Object.values(A),{message:"invalid price type!"}),price_value:h().min(1,{message:"Price is required!"})}),be={id:null,store_id:null,store_name:"",addon_id:"",price_type:A.absolute,price_value:"0"},bs=k({keyword:h()}),Ps={keyword:""};function ys(){const{showSweetDialog:t}=X(),{isDialogFormOpen:n,addOnsFormValues:s,updateAddOnsFormValues:o,triggerRefresh:i}=q(),[r,c]=a.useState("New Add-Ons"),d=N({resolver:L(js),defaultValues:fe}),{reset:l,handleSubmit:p,formState:{isSubmitting:v,isDirty:m}}=d;a.useEffect(()=>{s&&(c("Edit Add-ons"),l({id:s.id,name:s.name,sku:s.sku??"",price_type:s.price_type??fe.price_type,price_value:s.price}))},[s]);const b=()=>{l(fe),o(null),n.onFalse()},P=async w=>{await Je(w).then(()=>{b(),i(),t({icon:"success",title:"Data saved successfully",description:"Saved successfully"})}).catch(g=>{g instanceof G&&Object.keys(g.validationErrors).forEach(S=>{d.setError(S,{type:"manual",message:g.validationErrors[S][0]})})})};return e.jsx(Y,{open:n.value,children:e.jsxs($,{methods:d,onSubmit:p(P),children:[e.jsx(Z,{children:r}),e.jsx(J,{sx:{overflow:"visible"},children:e.jsxs(x,{container:!0,spacing:3,children:[e.jsx(x,{xs:12,children:e.jsx(T,{name:"name",label:"Name",size:"medium"})}),e.jsx(x,{xs:12,children:e.jsx(T,{name:"sku",label:"SKU",size:"medium"})}),e.jsx(x,{xs:4,children:e.jsx(Be,{name:"price_type",label:"Price Type",options:[{label:le(A.absolute),value:A.absolute},{label:le(A.percentage),value:A.percentage}],onChange:(w,g)=>d.setValue("price_type",g?.value??"",{shouldDirty:!0})})}),e.jsx(x,{xs:8,children:e.jsx(T,{name:"price_value",label:"Price",size:"medium",moneyFormat:!0,fullWidth:!0})}),e.jsx(x,{xs:12,children:e.jsx(ie,{caption:"Fill in the form above and correct it again correctly"})})]})}),e.jsxs(ee,{children:[e.jsx(V,{onClick:b,variant:"outlined",color:"inherit",children:"Cancel"}),e.jsx(se,{size:"medium",type:"submit",disabled:!m,variant:"contained",loading:v,children:"Save"})]})]})})}const Me=[{id:"no",label:"No",width:10},{id:"addons",label:"Add-Ons",width:100},{id:"",width:10}];function vs(){return e.jsx(xe,{children:e.jsx(O,{children:Me.map(t=>e.jsx(f,{align:t.align||"left",sortDirection:!1,sx:{width:t.width,minWidth:0},children:t.label},t.id))})})}function ws({is_open:t,addon_id:n,rows:s}){return e.jsx(de,{children:e.jsx(W,{sx:{position:"relative"},children:e.jsx(de,{variant:"outlined",sx:{position:"relative",overflow:"hidden"},children:e.jsx(te,{children:e.jsxs(re,{size:"medium",sx:{minWidth:0},children:[e.jsx(Cs,{}),e.jsx(Ss,{rows:s,addon_id:n,status:"finish"})]})})})})})}const ve=[{id:"no",label:"NO",width:10},{id:"store_name",label:"Store Name",width:100},{id:"store_price",label:"Store Price",width:100},{id:"",label:"",width:10}];function Cs(){return e.jsx(xe,{children:e.jsx(O,{children:ve.map(t=>e.jsx(f,{align:t.align||"left",sortDirection:!1,sx:{width:t.width,minWidth:0},children:t.label},t.id))})})}function Ss({rows:t,addon_id:n,status:s}){return e.jsx(ce,{children:s==="loading"?e.jsx(K,{text:"loading ..",colspan:ve.length}):t.length===0?e.jsx(K,{text:"data not found",colspan:ve.length}):t.map((o,i)=>e.jsx(_s,{no:i+1,addon_id:n,row:o},i))})}function _s({no:t,addon_id:n,row:s}){const o=ne(),{checkAbilities:i}=I(),{isDialogFormAddOnsPriceOpen:r,updateAddOnsPriceFormValues:c}=q();return e.jsxs(O,{hover:!0,children:[e.jsx(f,{sx:{whiteSpace:"nowrap"},children:t}),e.jsx(f,{sx:{whiteSpace:"nowrap"},children:s.store.name}),e.jsx(f,{sx:{whiteSpace:"nowrap"},children:$e(s.price)}),e.jsxs(f,{sx:{whiteSpace:"nowrap"},align:"right",children:[e.jsx(z,{color:o.open?"inherit":"default",onClick:o.onOpen,children:e.jsx(C,{icon:"eva:more-vertical-fill"})}),e.jsx(oe,{open:o.open,anchorEl:o.anchorEl,onClose:o.onClose,slotProps:{arrow:{placement:"right-top"}},children:i?.("addons:edit")&&e.jsx(ae,{children:e.jsxs(E,{onClick:()=>{o.onClose(),c({...s,addon_id:n}),r.onTrue()},children:[e.jsx(C,{icon:"solar:pen-bold"}),"Edit"]})})})]})]})}function Fs({no:t,row:n}){const s=ne(),o=M(),{showConfirmDialog:i}=ue(),{checkAbilities:r,checkAbilitiesMultiple:c}=I(),{isDialogFormOpen:d,updateAddOnsFormValues:l,triggerRefresh:p}=q(),v=e.jsxs(O,{hover:!0,children:[e.jsx(f,{sx:{whiteSpace:"nowrap"},children:t}),e.jsx(f,{sx:{whiteSpace:"nowrap"},children:n.name}),e.jsxs(f,{sx:{whiteSpace:"nowrap"},align:"right",children:[e.jsx(z,{color:o.value?"inherit":"default",onClick:o.onToggle,sx:{...o.value&&{bgcolor:"action.hover"}},children:e.jsx(C,{icon:"eva:arrow-ios-downward-fill"})}),c?.(["addons:delete","addons:edit"])&&e.jsx(z,{color:s.open?"inherit":"default",onClick:s.onOpen,children:e.jsx(C,{icon:"eva:more-vertical-fill"})}),e.jsx(oe,{open:s.open,anchorEl:s.anchorEl,onClose:s.onClose,slotProps:{arrow:{placement:"right-top"}},children:e.jsxs(ae,{children:[r?.("addons:delete")&&e.jsxs(E,{onClick:()=>{s.onClose(),i({title:"Delete Category",description:"Anda yakin? Data akan dihapus permanent.",confirmBtnText:"Delete",onConfirm:async()=>{await es(n.id),p()}})},sx:{color:"error.main"},children:[e.jsx(C,{icon:"solar:trash-bin-trash-bold"}),"Delete"]}),r?.("addons:edit")&&e.jsxs(E,{onClick:()=>{s.onClose(),d.onTrue(),l(n)},children:[e.jsx(C,{icon:"solar:pen-bold"}),"Edit"]})]})})]})]}),m=e.jsx(O,{children:e.jsx(f,{sx:{border:"none"},colSpan:Me.length,children:e.jsx(ze,{unmountOnExit:!0,timeout:"auto",in:o.value,children:e.jsx(ws,{addon_id:n.id,rows:n.prices,is_open:o.value})})})});return e.jsxs(e.Fragment,{children:[v,m]})}function De({text:t}){return e.jsx(O,{hover:!0,children:e.jsx(f,{sx:{whiteSpace:"nowrap"},align:"center",colSpan:3,children:t})})}function Ts({rows:t,status:n}){const{page:s,rowsPerPage:o}=q();return e.jsx(ce,{children:n==="loading"?e.jsx(De,{text:"loading .."}):t.length===0?e.jsx(De,{text:"data not found"}):t.map((i,r)=>e.jsx(Fs,{row:i,no:(s-1)*o+r+1},i.id))})}function ks(){const{keyword:t,updateKeyword:n}=q(),s=N({resolver:L(bs),defaultValues:Ps}),{watch:o,reset:i,handleSubmit:r}=s;a.useEffect(()=>{i({keyword:t})},[t,i]);const c=o();a.useEffect(()=>{const l=setTimeout(()=>{c.keyword===""&&n("")},300);return()=>clearTimeout(l)},[c.keyword,n]);const d=async l=>{n(l.keyword)};return e.jsx(he,{sx:{p:2.5},children:e.jsx($,{methods:s,onSubmit:r(d),children:e.jsx(T,{size:"medium",name:"keyword",tooltipTitle:"press enter",placeholder:"Search add-ons...",InputProps:{startAdornment:e.jsx(Ce,{position:"start",children:e.jsx(C,{icon:"eva:search-fill",sx:{color:"text.disabled"}})})}})})})}function Os(){const{keyword:t,refreshFlag:n,updatePage:s,updateRowsPerPage:o}=q(),[i,r]=a.useState(0),[c,d]=a.useState(0),[l,p]=a.useState(15),[v,m]=a.useState([]),[b,P]=a.useState(!1),w=async()=>{P(!0);const u=await Ne({keyword:t,page:i+1});P(!1),m(u.data),d(u.total),r(u.current_page-1),s(u.current_page),o(l)};a.useEffect(()=>{w()},[t,n,i]);const g=(u,j)=>{r(j)},S=u=>{p(parseInt(u.target.value,10)),r(0)};return e.jsxs(Te,{children:[e.jsx(ks,{}),e.jsx(W,{sx:{position:"relative"},children:e.jsx(te,{children:e.jsxs(re,{size:"medium",sx:{minWidth:0},children:[e.jsx(vs,{}),e.jsx(Ts,{rows:v,status:b?"loading":"finish"})]})})}),e.jsx(Fe,{dense:!1,page:i,count:c,rowsPerPage:l,rowsPerPageOptions:[15,25,100],onPageChange:g,onRowsPerPageChange:S})]})}function As(){const{checkAbilities:t}=I(),{isDialogFormOpen:n}=q();return e.jsx(ke,{heading:"Add Ons",links:[{name:"Master",href:"#"},{name:"Add Ons",href:"#"}],action:t?.("addons:create")&&e.jsx(V,{size:"medium",variant:"contained",onClick:n.onTrue,startIcon:e.jsx(C,{icon:"mingcute:add-line"}),children:"New Add-Ons"}),sx:{mb:{xs:3,md:5}}})}function Ds(){const{showSweetDialog:t}=X(),{isDialogFormAddOnsPriceOpen:n,addOnsPriceFormValues:s,updateAddOnsPriceFormValues:o,refreshFlagAddOnsPrice:i,triggerRefreshAddOnsPrice:r}=q(),[c,d]=a.useState("New Add-Ons"),l=N({resolver:L(fs),defaultValues:be}),{reset:p,handleSubmit:v,formState:{isSubmitting:m,isDirty:b,errors:P}}=l;console.log(P),a.useEffect(()=>{s&&(d("Edit Add-ons"),p({id:s.id,store_id:s.store_id,store_name:s.store.name,addon_id:s.addon_id,price_type:s.price_type??be.price_type,price_value:s.price}))},[s]);const w=()=>{p(be),o(null),n.onFalse()},g=async S=>{await ss().then(()=>{r({refresh_number:i.refresh_number+1,addon_id:S.addon_id??""}),t({icon:"success",title:"Data saved successfully",description:"Saved successfully"}),w()}).catch(u=>{u instanceof G&&Object.keys(u.validationErrors).forEach(j=>{l.setError(j,{type:"manual",message:u.validationErrors[j][0]})})})};return e.jsx(Y,{open:n.value,children:e.jsxs($,{methods:l,onSubmit:v(g),children:[e.jsx(Z,{children:c}),e.jsx(J,{sx:{overflow:"visible"},children:e.jsxs(x,{container:!0,spacing:3,children:[e.jsx(x,{xs:12,children:e.jsx(T,{name:"store_name",label:"Store Name",size:"medium",disabled:!0})}),e.jsx(x,{xs:4,children:e.jsx(Be,{name:"price_type",label:"Price Type",options:[{label:le(A.absolute),value:A.absolute},{label:le(A.percentage),value:A.percentage}],onChange:(S,u)=>l.setValue("price_type",u?.value??"",{shouldDirty:!0})})}),e.jsx(x,{xs:8,children:e.jsx(T,{name:"price_value",label:"Price",size:"medium",moneyFormat:!0,fullWidth:!0})}),e.jsx(x,{xs:12,children:e.jsx(ie,{caption:"Fill in the form above and correct it again correctly"})})]})}),e.jsxs(ee,{children:[e.jsx(V,{onClick:w,variant:"outlined",color:"inherit",children:"Cancel"}),e.jsx(se,{size:"medium",type:"submit",disabled:!b,variant:"contained",loading:m,children:"Save"})]})]})})}const Es={title:`Master Item - Add Ons - ${me.site.name}`};function Rs(){return e.jsxs(e.Fragment,{children:[e.jsx(Se,{children:e.jsxs("title",{children:[" ",Es.title]})}),e.jsx(_e,{maxWidth:"xl",children:e.jsxs(gs,{children:[e.jsx(As,{}),e.jsx(Os,{}),e.jsx(ys,{}),e.jsx(Ds,{})]})})]})}const We=a.createContext(void 0),B=()=>{const t=a.useContext(We);if(t===void 0)throw new Error("useContextSearch must be used within a PageContext.Provider");return t},Vs=({children:t})=>{const n=M(),s=M(),[o,i]=a.useState(0),r=()=>i(y=>y+1),[c,d]=a.useState({refresh_number:0}),l=y=>{d(ht=>({refresh_number:y.refresh_number,product_id:y.product_id}))},[p,v]=a.useState(null),m=y=>{v(y)},[b,P]=a.useState(null),w=y=>{P(y)},[g,S]=a.useState(""),u=y=>{S(y)},[j,_]=a.useState(0),D=y=>{_(y)},[F,R]=a.useState(0),pe=y=>{R(y)},ge=a.useMemo(()=>({isDialogFormOpen:n,isDialogFormProductPriceOpen:s,refreshFlag:o,triggerRefresh:r,refreshFlagProductPrice:c,triggerRefreshProductPrice:l,productFormValues:p,updateProductFormValues:m,productPriceFormValues:b,updateProductPriceFormValues:w,keyword:g,updateKeyword:u,page:j,updatePage:D,rowsPerPage:F,updateRowsPerPage:pe}),[n,s,o,c,p,g,j,F]);return e.jsx(We.Provider,{value:ge,children:t})},Is=k({id:h().nullable(),category:k({id:h(),name:h()}),name:h().min(1,{message:"Name is required!"}),sku:h().min(1,{message:"SKU is required!"}),price:h().min(1,{message:"Price is required!"}),estimated_days:h().min(1,{message:"Work Estimation is required!"}),is_active:H(),is_pressing:H(),is_drying:H(),is_washing:H(),is_qc:H(),is_packing:H(),add_ons:Ge(k({add_on:k({id:h(),name:h()}),price:h().optional()})).optional()}).refine(t=>t.category.id,{message:"Category is required",path:["category"]}),Pe={id:null,category:{id:"",name:""},name:"",sku:"",price:"0",estimated_days:"0",is_active:!0,is_pressing:!1,is_drying:!1,is_washing:!1,is_qc:!1,is_packing:!1,add_ons:[{add_on:{id:"",name:""},price:""}]},Bs=k({id:h().nullable(),product_id:h().nullable(),store_id:h().nullable(),store_name:h(),price:h().min(1,{message:"Price is required!"}),is_active:H()}),Ee={id:null,product_id:null,store_id:null,store_name:"",price:"0",is_active:!0},zs=k({keyword:h()}),Ns={keyword:""};function Ls(){const{showSweetDialog:t}=X(),{isDialogFormOpen:n,productFormValues:s,updateProductFormValues:o,triggerRefresh:i}=B(),[r,c]=a.useState("New Product"),d=N({resolver:L(Is),defaultValues:Pe}),{reset:l,handleSubmit:p,watch:v,formState:{isSubmitting:m,isDirty:b,errors:P}}=d,{fields:w,append:g,remove:S}=Ue({control:d.control,name:"add_ons"});a.useEffect(()=>{s?(l({id:s.id,category:s.category?{id:s.category.id,name:s.category.name}:{id:"",name:""},name:s.name,price:s.price,estimated_days:String(s.estimated_days),sku:s.sku,is_active:s.is_active,is_pressing:s.is_pressing,is_drying:s.is_drying,is_washing:s.is_washing??!1,is_qc:s.is_qc??!1,is_packing:s.is_packing??!1,add_ons:s.addons.length>0?s.addons.map(_=>({add_on:{id:_.id,name:_.name},price:_.price})):Pe.add_ons}),s.id===""?c("Copy Product"):c("Edit Product")):c("New Product")},[s]);const u=()=>{l(Pe),o(null),n.onFalse()},j=async _=>{const D=is(_);await rs(D).then(()=>{u(),i(),t({icon:"success",title:"Data saved successfully",description:"Saved successfully"})}).catch(F=>{F instanceof G&&Object.keys(F.validationErrors).forEach(R=>{d.setError(R,{type:"manual",message:F.validationErrors[R][0]})})})};return e.jsx(Y,{open:n.value,children:e.jsxs($,{methods:d,onSubmit:p(j),children:[e.jsx(Z,{children:r}),e.jsx(J,{sx:{overflow:"visible"},children:e.jsx(W,{sx:{pt:1,overflowY:"auto",overflowX:"hidden",maxHeight:me.dialog.maxHeight},children:e.jsxs(x,{container:!0,spacing:3,children:[e.jsxs(x,{xs:12,display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"end",children:[e.jsx(as,{name:"is_active",label:"",sx:{mr:0}}),e.jsx(Oe,{variant:"body2",sx:{color:"text.disabled"},children:"Active"})]}),e.jsx(x,{xs:12,children:e.jsx(Ae,{name:"category",debounceSearch:!0,label:"Category",getOptionLabel:_=>_?.name,isOptionEqualToValue:(_,D)=>_?.id===D?.id,fetchFunction:async _=>(await Le({keyword:_,page:1})).data})}),e.jsx(x,{xs:12,children:e.jsx(T,{name:"name",label:"Name",size:"medium"})}),e.jsx(x,{xs:12,children:e.jsx(T,{name:"sku",label:"SKU",size:"medium"})}),e.jsx(x,{xs:12,children:e.jsx(T,{name:"price",label:"Price",size:"medium",fullWidth:!0,moneyFormat:!0})}),e.jsx(x,{xs:12,children:e.jsx(T,{name:"estimated_days",label:"Work Estimation (days)",size:"medium",fullWidth:!0})}),e.jsxs(x,{xs:12,sx:{pl:1.8,display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(6em, 1fr))"},children:[e.jsx(Q,{name:"is_washing",label:"Washing"}),e.jsx(Q,{name:"is_drying",label:"Drying"}),e.jsx(Q,{name:"is_pressing",label:"Pressing"}),e.jsx(Q,{name:"is_qc",label:"Qc"}),e.jsx(Q,{name:"is_packing",label:"Packing"})]}),e.jsx(x,{xs:12,children:e.jsx(os,{children:e.jsx(Oe,{variant:"body2",color:"GrayText",children:"Add-Ons"})})}),w.map((_,D)=>e.jsx(x,{xs:12,children:e.jsxs(he,{direction:"row",spacing:2,alignItems:"center",children:[e.jsx(Ae,{label:"Add-on",debounceSearch:!0,name:`add_ons.${D}.add_on`,getOptionLabel:F=>F?.name,isOptionEqualToValue:(F,R)=>F?.id===R?.id,fetchFunction:async F=>(await Ne({keyword:F,page:1})).data}),e.jsx(z,{color:"default",onClick:()=>S(D),children:e.jsx(C,{icon:"material-symbols:close-rounded"})})]})},_.id)),e.jsx(x,{xs:12,children:e.jsx(V,{onClick:()=>g({add_on:{id:"",name:""},price:""}),startIcon:e.jsx(C,{icon:"ic:round-plus"}),variant:"soft",color:"inherit",children:"Ads On"})}),e.jsx(x,{xs:12,children:e.jsx(ie,{caption:"Fill in the form above and correct it again correctly"})})]})})}),e.jsxs(ee,{children:[e.jsx(V,{onClick:u,variant:"outlined",color:"inherit",children:"Cancel"}),e.jsx(se,{size:"medium",type:"submit",disabled:!b,variant:"contained",loading:m,children:"Save"})]})]})})}function $s(){const{keyword:t,updateKeyword:n}=B(),s=N({resolver:L(zs),defaultValues:Ns}),{watch:o,reset:i,handleSubmit:r}=s;a.useEffect(()=>{i({keyword:t})},[t,i]);const c=o();a.useEffect(()=>{const l=setTimeout(()=>{c.keyword===""&&n("")},300);return()=>clearTimeout(l)},[c.keyword,n]);const d=async l=>{n(l.keyword)};return e.jsx(he,{sx:{p:2.5},children:e.jsx($,{methods:s,onSubmit:r(d),children:e.jsx(T,{size:"medium",name:"keyword",tooltipTitle:"press enter",placeholder:"Search store...",InputProps:{startAdornment:e.jsx(Ce,{position:"start",children:e.jsx(C,{icon:"eva:search-fill",sx:{color:"text.disabled"}})})}})})})}function qs({is_open:t,product_id:n}){const{refreshFlagProductPrice:s}=B(),[o,i]=a.useState(!1),[r,c]=a.useState([]),d=async()=>{i(!0),await cs(n).then(l=>{c(l)}).finally(()=>{i(!1)})};return a.useEffect(()=>{t&&d()},[t]),a.useEffect(()=>{s.product_id===n&&d()},[s.refresh_number]),e.jsx(de,{sx:{width:"100%"},children:e.jsx(W,{sx:{position:"relative",width:"100%"},children:e.jsx(de,{variant:"outlined",sx:{position:"relative",overflow:"hidden"},children:e.jsx(te,{children:e.jsxs(re,{size:"small",children:[e.jsx(Hs,{}),e.jsx(Ms,{rows:r,status:o?"loading":"finish"})]})})})})})}const we=[{id:"no",label:"NO",width:"5%"},{id:"store_name",label:"Store Name",width:"25%"},{id:"store_price",label:"Store Price",width:"25%"},{id:"status",label:"Status",width:"40%"},{id:"",label:"",width:"5%"}];function Hs(){return e.jsx(xe,{children:e.jsx(O,{children:we.map(t=>e.jsx(f,{align:t.align||"left",sortDirection:!1,sx:{width:t.width,minWidth:0},children:t.label},t.id))})})}function Ms({rows:t,status:n}){return e.jsx(ce,{children:n==="loading"?e.jsx(K,{text:"loading ..",colspan:we.length}):t.length===0?e.jsx(K,{text:"data not found",colspan:we.length}):t.map((s,o)=>e.jsx(Ws,{no:o+1,row:s},o))})}function Ws({no:t,row:n}){const s=ne(),{showConfirmDialog:o}=ue(),{checkAbilities:i,checkAbilitiesMultiple:r}=I(),{isDialogFormProductPriceOpen:c,updateProductPriceFormValues:d,refreshFlagProductPrice:l,triggerRefreshProductPrice:p}=B(),v=m=>{o({title:m.is_active===!0?"Inactivate":"Activate",description:`Anda yakin? Data akan ${m.is_active===!0?"dinon-aktifkan.":"diaktifkan."}`,confirmBtnText:"Confirm",onConfirm:async()=>{const b=ls(m);b.is_active=!m.is_active,await qe(b).then(()=>{p({refresh_number:l.refresh_number+1,product_id:m.product_id??""})}).catch(P=>{P instanceof G&&Object.keys(P.validationErrors).forEach(w=>{Xe.error(P.validationErrors[w][0],{position:"top-center"})})})}})};return e.jsxs(O,{hover:!0,children:[e.jsx(f,{sx:{whiteSpace:"nowrap"},children:t}),e.jsx(f,{sx:{whiteSpace:"nowrap"},children:n.store_name}),e.jsx(f,{sx:{whiteSpace:"nowrap"},children:$e(n.price)}),e.jsx(f,{sx:{whiteSpace:"nowrap"},children:e.jsx(Qe,{variant:"soft",color:n.is_active===!0&&"success"||n.is_active===!1&&"secondary"||"default",children:n.is_active===!0?"active":"in-active"})}),e.jsxs(f,{sx:{whiteSpace:"nowrap"},align:"right",children:[r?.(["product-store:activate","product-store:edit"])&&e.jsx(z,{color:s.open?"inherit":"default",onClick:s.onOpen,children:e.jsx(C,{icon:"eva:more-vertical-fill"})}),e.jsxs(oe,{open:s.open,anchorEl:s.anchorEl,onClose:s.onClose,slotProps:{arrow:{placement:"right-top"}},children:[i?.("product-store:activate")&&e.jsxs(E,{onClick:()=>{s.onClose(),v(n)},sx:{color:n.is_active===!0?"error.main":"info.main"},children:[e.jsx(C,{icon:n.is_active===!0?"solar:lock-bold":"solar:lock-unlocked-bold"}),n.is_active===!0?"In-Active":"Activate"]}),e.jsx(ae,{children:i?.("product-store:edit")&&e.jsxs(E,{onClick:()=>{s.onClose(),d(n),c.onTrue()},children:[e.jsx(C,{icon:"solar:pen-bold"}),"Edit"]})})]})]})]})}function Ks({no:t,row:n}){const s=ne(),o=M(),{showConfirmDialog:i}=ue(),{checkAbilities:r,checkAbilitiesMultiple:c}=I(),{isDialogFormOpen:d,updateProductFormValues:l,triggerRefresh:p}=B(),v=e.jsxs(O,{hover:!0,children:[e.jsx(f,{sx:{whiteSpace:"nowrap"},children:t}),e.jsx(f,{sx:{whiteSpace:"nowrap"},children:n.name}),e.jsx(f,{sx:{whiteSpace:"nowrap"},children:n.category?.name??"-"}),e.jsx(f,{sx:{whiteSpace:"nowrap"},children:n.addons.map(b=>b.name).join(", ")}),e.jsx(f,{sx:{whiteSpace:"nowrap"},children:n.estimated_days}),e.jsxs(f,{sx:{whiteSpace:"nowrap"},align:"right",children:[c?.(["product:delete","product:copy","product:edit"])&&e.jsx(z,{color:o.value?"inherit":"default",onClick:o.onToggle,sx:{...o.value&&{bgcolor:"action.hover"}},children:e.jsx(C,{icon:"eva:arrow-ios-downward-fill"})}),e.jsx(z,{color:s.open?"inherit":"default",onClick:s.onOpen,children:e.jsx(C,{icon:"eva:more-vertical-fill"})}),e.jsx(oe,{open:s.open,onClose:s.onClose,anchorEl:s.anchorEl,slotProps:{arrow:{placement:"right-top"}},children:e.jsxs(ae,{children:[r?.("product:delete")&&e.jsxs(E,{onClick:()=>{s.onClose(),i({title:"Delete Product",description:"Anda yakin? Data akan dihapus permanent.",confirmBtnText:"Delete",onConfirm:async()=>{await ds(n.id),p()}})},sx:{color:"error.main"},children:[e.jsx(C,{icon:"solar:trash-bin-trash-bold"}),"Delete"]}),r?.("product:copy")&&e.jsxs(E,{onClick:()=>{s.onClose(),d.onTrue(),n.id="",l(n)},children:[e.jsx(C,{icon:"iconamoon:copy-fill"}),"Copy"]}),r?.("product:edit")&&e.jsxs(E,{onClick:()=>{s.onClose(),d.onTrue(),l(n)},children:[e.jsx(C,{icon:"solar:pen-bold"}),"Edit"]})]})})]})]}),m=e.jsx(O,{children:e.jsx(f,{sx:{border:"none"},colSpan:ye.length,children:e.jsx(ze,{unmountOnExit:!0,timeout:"auto",in:o.value,children:e.jsx(qs,{product_id:n.id,is_open:o.value})})})});return e.jsxs(e.Fragment,{children:[v,r?.("product-store:view")&&m]})}function Gs({rows:t,status:n}){const{page:s,rowsPerPage:o}=B();return e.jsx(ce,{children:n==="loading"?e.jsx(K,{text:"loading ..",colspan:ye.length}):t.length===0?e.jsx(K,{text:"data not found",colspan:ye.length}):t.map((i,r)=>e.jsx(Ks,{row:i,no:(s-1)*o+r+1},i.id))})}function Us(){const{keyword:t,refreshFlag:n,updatePage:s,updateRowsPerPage:o}=B(),[i,r]=a.useState(0),[c,d]=a.useState(0),[l,p]=a.useState(15),[v,m]=a.useState([]),[b,P]=a.useState(!1),w=async()=>{P(!0),await us({keyword:t,page:i+1}).then(u=>{m(u.data),d(u.total),r(u.current_page-1),s(u.current_page),o(l)}).finally(()=>{P(!1)})};a.useEffect(()=>{w()},[t,n,i]);const g=(u,j)=>{r(j)},S=u=>{p(parseInt(u.target.value,10)),r(0)};return e.jsxs(Te,{children:[e.jsx($s,{}),e.jsx(W,{sx:{position:"relative"},children:e.jsx(te,{children:e.jsxs(re,{size:"medium",sx:{minWidth:0},children:[e.jsx(ms,{}),e.jsx(Gs,{rows:v,status:b?"loading":"finish"})]})})}),e.jsx(Fe,{dense:!1,page:i,count:c,rowsPerPage:l,rowsPerPageOptions:[15,25,100],onPageChange:g,onRowsPerPageChange:S})]})}function Qs(){const{checkAbilities:t}=I(),{isDialogFormOpen:n}=B();return e.jsx(ke,{heading:"Product",links:[{name:"Master",href:"#"},{name:"Product",href:"#"}],action:t?.("product:create")&&e.jsx(V,{size:"medium",variant:"contained",onClick:n.onTrue,startIcon:e.jsx(C,{icon:"mingcute:add-line"}),children:"New Product"}),sx:{mb:{xs:3,md:5}}})}function Xs(){const{showSweetDialog:t}=X(),{isDialogFormProductPriceOpen:n,productPriceFormValues:s,updateProductPriceFormValues:o,refreshFlagProductPrice:i,triggerRefreshProductPrice:r}=B(),c=N({resolver:L(Bs),defaultValues:Ee}),{reset:d,handleSubmit:l,watch:p,formState:{isSubmitting:v,isDirty:m,errors:b}}=c;a.useEffect(()=>{s&&d({id:s.id,product_id:s.product_id,store_id:s.store_id,store_name:s.store_name,price:s.price,is_active:s.is_active})},[s]);const P=()=>{o(null),d(Ee),n.onFalse()},w=async g=>{const S=hs(g);await qe(S).then(()=>{P(),r({refresh_number:i.refresh_number+1,product_id:g.product_id??""}),t({icon:"success",title:"Data saved successfully",description:"Saved successfully"})}).catch(u=>{u instanceof G&&Object.keys(u.validationErrors).forEach(j=>{c.setError(j,{type:"manual",message:u.validationErrors[j][0]})})})};return e.jsx(Y,{open:n.value,children:e.jsxs($,{methods:c,onSubmit:l(w),children:[e.jsx(Z,{children:"Edit Price"}),e.jsx(J,{sx:{overflow:"visible"},children:e.jsx(W,{sx:{pt:1,overflowY:"auto",overflowX:"hidden"},children:e.jsxs(x,{container:!0,spacing:3,children:[e.jsx(x,{xs:12,children:e.jsx(T,{name:"store_name",label:"Store Name",size:"medium",disabled:!0})}),e.jsx(x,{xs:12,children:e.jsx(T,{name:"price",label:"Price",size:"medium"})}),e.jsx(x,{xs:12,children:e.jsx(ie,{caption:"Fill in the form above and correct it again correctly"})})]})})}),e.jsxs(ee,{children:[e.jsx(V,{onClick:P,variant:"outlined",color:"inherit",children:"Cancel"}),e.jsx(se,{size:"medium",type:"submit",disabled:!m,variant:"contained",loading:v,children:"Save"})]})]})})}const Ys={title:`Master Item - Product - ${me.site.name}`};function Zs(){return e.jsxs(e.Fragment,{children:[e.jsx(Se,{children:e.jsxs("title",{children:[" ",Ys.title]})}),e.jsx(_e,{maxWidth:"xl",children:e.jsxs(Vs,{children:[e.jsx(Qs,{}),e.jsx(Us,{}),e.jsx(Ls,{}),e.jsx(Xs,{})]})})]})}const Ke=a.createContext(void 0),U=()=>{const t=a.useContext(Ke);if(t===void 0)throw new Error("useContextSearch must be used within a PageContext.Provider");return t},Js=({children:t})=>{const n=M(),[s,o]=a.useState(0),i=()=>o(j=>j+1),[r,c]=a.useState(""),d=j=>{c(j)},[l,p]=a.useState(null),v=j=>{p(j)},[m,b]=a.useState(0),P=j=>{b(j)},[w,g]=a.useState(0),S=j=>{g(j)},u=a.useMemo(()=>({isDialogFormOpen:n,refreshFlag:s,triggerRefresh:i,categoryFormValues:l,updateCategoryFormValues:v,keyword:r,updateKeyword:d,page:m,updatePage:P,rowsPerPage:w,updateRowsPerPage:S}),[n,s,l,r,m,w]);return e.jsx(Ke.Provider,{value:u,children:t})};function et(){const{checkAbilities:t}=I(),{isDialogFormOpen:n}=U();return e.jsx(ke,{heading:"Category",links:[{name:"Master",href:"#"},{name:"Category",href:"#"}],action:t?.("category:create")&&e.jsx(V,{size:"medium",variant:"contained",onClick:n.onTrue,startIcon:e.jsx(C,{icon:"mingcute:add-line"}),children:"New Category"}),sx:{mb:{xs:3,md:5}}})}k({id:h(),name:h().min(1,{message:"Name is required!"})});const st=k({id:h().nullable(),name:h().min(1,{message:"Name is required!"})}),Re={id:null,name:""},tt=k({keyword:h()}),nt={keyword:""};function ot(){const{showSweetDialog:t}=X(),{isDialogFormOpen:n,categoryFormValues:s,updateCategoryFormValues:o,triggerRefresh:i}=U(),[r,c]=a.useState("New Category"),d=N({resolver:L(st),defaultValues:Re}),{reset:l,handleSubmit:p,formState:{isSubmitting:v,isDirty:m}}=d;a.useEffect(()=>{s&&(c("Edit Category"),l({id:s.id,name:s.name}))},[s]);const b=()=>{l(Re),o(null),n.onFalse()},P=async w=>{await ts(w).then(()=>{b(),i(),t({icon:"success",title:"Data saved successfully",description:"Saved successfully"})}).catch(g=>{g instanceof G&&Object.keys(g.validationErrors).forEach(S=>{d.setError(S,{type:"manual",message:g.validationErrors[S][0]})})})};return e.jsx(Y,{open:n.value,children:e.jsxs($,{methods:d,onSubmit:p(P),children:[e.jsx(Z,{children:r}),e.jsx(J,{sx:{overflow:"visible"},children:e.jsxs(x,{container:!0,spacing:3,children:[e.jsx(x,{xs:12,children:e.jsx(T,{name:"name",label:"Name",size:"medium"})}),e.jsx(x,{xs:12,children:e.jsx(ie,{caption:"Fill in the form above and correct it again correctly"})})]})}),e.jsxs(ee,{children:[e.jsx(V,{onClick:b,variant:"outlined",color:"inherit",children:"Cancel"}),e.jsx(se,{size:"medium",type:"submit",disabled:!m,variant:"contained",loading:v,children:"Save"})]})]})})}function at(){const t=[{id:"no",label:"No",width:10},{id:"category",label:"Category",width:100},{id:"",width:10}];return e.jsx(xe,{children:e.jsx(O,{children:t.map(n=>e.jsx(f,{align:n.align||"left",sortDirection:!1,sx:{width:n.width,minWidth:0},children:n.label},n.id))})})}function it({no:t,row:n}){const s=ne(),{showConfirmDialog:o}=ue(),{checkAbilities:i,checkAbilitiesMultiple:r}=I(),{isDialogFormOpen:c,updateCategoryFormValues:d,triggerRefresh:l}=U();return e.jsxs(O,{hover:!0,children:[e.jsx(f,{sx:{whiteSpace:"nowrap"},children:t}),e.jsx(f,{sx:{whiteSpace:"nowrap"},children:n.name}),e.jsxs(f,{sx:{whiteSpace:"nowrap"},align:"right",children:[r?.(["category:delete","category:edit"])&&e.jsx(z,{color:s.open?"inherit":"default",onClick:s.onOpen,children:e.jsx(C,{icon:"eva:more-vertical-fill"})}),e.jsx(oe,{open:s.open,anchorEl:s.anchorEl,onClose:s.onClose,slotProps:{arrow:{placement:"right-top"}},children:e.jsxs(ae,{children:[i?.("category:delete")&&e.jsxs(E,{onClick:()=>{s.onClose(),o({title:"Delete Category",description:"Anda yakin? Data akan dihapus permanent.",confirmBtnText:"Delete",onConfirm:async()=>{await ns(n.id),l()}})},sx:{color:"error.main"},children:[e.jsx(C,{icon:"solar:trash-bin-trash-bold"}),"Delete"]}),i?.("category:edit")&&e.jsxs(E,{onClick:()=>{s.onClose(),c.onTrue(),d(n)},children:[e.jsx(C,{icon:"solar:pen-bold"}),"Edit"]})]})})]})]})}function Ve({text:t}){return e.jsx(O,{hover:!0,children:e.jsx(f,{sx:{whiteSpace:"nowrap"},align:"center",colSpan:3,children:t})})}function rt({rows:t,status:n}){const{page:s,rowsPerPage:o}=U();return e.jsx(ce,{children:n==="loading"?e.jsx(Ve,{text:"loading .."}):t.length===0?e.jsx(Ve,{text:"data not found"}):t.map((i,r)=>e.jsx(it,{row:i,no:(s-1)*o+r+1},i.id))})}function ct(){const{keyword:t,updateKeyword:n}=U(),s=N({resolver:L(tt),defaultValues:nt}),{watch:o,reset:i,handleSubmit:r}=s;a.useEffect(()=>{i({keyword:t})},[t,i]);const c=o();a.useEffect(()=>{const l=setTimeout(()=>{c.keyword===""&&n("")},300);return()=>clearTimeout(l)},[c.keyword,n]);const d=async l=>{n(l.keyword)};return e.jsx(he,{sx:{p:2.5},children:e.jsx($,{methods:s,onSubmit:r(d),children:e.jsx(T,{size:"medium",name:"keyword",tooltipTitle:"press enter",placeholder:"Search category...",InputProps:{startAdornment:e.jsx(Ce,{position:"start",children:e.jsx(C,{icon:"eva:search-fill",sx:{color:"text.disabled"}})})}})})})}function lt(){const{keyword:t,refreshFlag:n,updatePage:s,updateRowsPerPage:o}=U(),[i,r]=a.useState(0),[c,d]=a.useState(0),[l,p]=a.useState(15),[v,m]=a.useState([]),[b,P]=a.useState(!1),w=async()=>{P(!0);const u=await Le({keyword:t,page:i+1});P(!1),m(u.data),d(u.total),r(u.current_page-1),s(u.current_page),o(l)};a.useEffect(()=>{w()},[t,n,i]);const g=(u,j)=>{r(j)},S=u=>{p(parseInt(u.target.value,10)),r(0)};return e.jsxs(Te,{children:[e.jsx(ct,{}),e.jsx(W,{sx:{position:"relative"},children:e.jsx(te,{children:e.jsxs(re,{size:"medium",sx:{minWidth:0},children:[e.jsx(at,{}),e.jsx(rt,{rows:v,status:b?"loading":"finish"})]})})}),e.jsx(Fe,{dense:!1,page:i,count:c,rowsPerPage:l,rowsPerPageOptions:[15,25,100],onPageChange:g,onRowsPerPageChange:S})]})}const dt={title:`Master Item - Category - ${me.site.name}`};function ut(){return e.jsxs(e.Fragment,{children:[e.jsx(Se,{children:e.jsxs("title",{children:[" ",dt.title]})}),e.jsx(_e,{maxWidth:"xl",children:e.jsxs(Js,{children:[e.jsx(et,{}),e.jsx(lt,{}),e.jsx(ot,{})]})})]})}function Vt(){const{checkAbilities:t}=I(),n=[{value:"product",label:"Product",show:t?.("product:view")},{value:"category",label:"Category",show:t?.("category:view")},{value:"add_ons",label:"Add Ons",show:t?.("addons:view")}],s=n.find(c=>c.show),[o,i]=a.useState(s?.value??""),r=(c,d)=>{i(d)};return e.jsxs(xs,{value:o,children:[e.jsx(Ye,{maxWidth:"xl",children:e.jsx(ps,{onChange:r,children:n.map(c=>c.show&&e.jsx(Ze,{value:c.value,label:c.label},c.value))})}),e.jsx(je,{value:"product",sx:{p:0},children:e.jsx(Zs,{})}),e.jsx(je,{value:"category",sx:{p:0},children:e.jsx(ut,{})}),e.jsx(je,{value:"add_ons",sx:{p:0},children:e.jsx(Rs,{})})]})}export{Vt as default};
