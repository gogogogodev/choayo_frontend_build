import{c as U,r as o,g as _,t as N,q as g,dC as R,p as T,k as e,F as I,S as i,v as d,d$ as L,fv as V,as as j,l,gj as M,bC as v,aL as f,gf as z,dX as H,aX as W,o as X}from"./index-DtP58muJ.js";import{F as r}from"./fields-bN1H1Pph.js";import{s as m}from"./schema-helper-IMZGb521.js";import{C as D}from"./Card-DhhypByC.js";import{C}from"./CardHeader-DrP1HthL.js";import{F as B}from"./FormControlLabel-aYt4PlDo.js";const $=g({name:d().min(1,{message:"Name is required!"}),content:m.editor({message:{required_error:"Content is required!"}}),images:m.files({message:{required_error:"Images is required!"}}),tourGuides:L(g({id:d(),name:d(),avatarUrl:d(),phoneNumber:d()})).nonempty({message:"Must have at least 1 guide!"}),available:g({startDate:m.date({message:{required_error:"Start date is required!"}}),endDate:m.date({message:{required_error:"End date is required!"}})}),durations:d().min(1,{message:"Durations is required!"}),destination:m.objectOrNull({message:{required_error:"Destination is required!"}}),services:d().array().min(2,{message:"Must have at least 2 items!"}),tags:d().array().min(2,{message:"Must have at least 2 items!"})}).refine(t=>!V(t.available.startDate,t.available.endDate),{message:"End date cannot be earlier than start date!",path:["available.endDate"]});function ee({currentTour:t}){const S=U(),x=o.useMemo(()=>({name:t?.name||"",content:t?.content||"",images:t?.images||[],tourGuides:t?.tourGuides||[],available:{startDate:t?.available.startDate||null,endDate:t?.available.endDate||null},durations:t?.durations||"",destination:t?.destination||"",services:t?.services||[],tags:t?.tags||[]}),[t]),b=_({mode:"all",resolver:N($),defaultValues:x}),{watch:y,reset:u,setValue:c,handleSubmit:E,formState:{isSubmitting:k}}=b,h=y();o.useEffect(()=>{t&&u(x)},[t,x,u]);const q=E(async s=>{try{await new Promise(a=>setTimeout(a,500)),u(),R.success(t?"Update success!":"Create success!"),S.push(T.dashboard.tour.root),console.info("DATA",s)}catch(a){console.error(a)}}),A=o.useCallback(s=>{const a=h.images&&h.images?.filter(n=>n!==s);c("images",a,{shouldValidate:!0})},[c,h.images]),O=o.useCallback(()=>{c("images",[],{shouldValidate:!0})},[c]),w=e.jsxs(D,{children:[e.jsx(C,{title:"Details",subheader:"Title, short description, image...",sx:{mb:3}}),e.jsx(j,{}),e.jsxs(i,{spacing:3,sx:{p:3},children:[e.jsxs(i,{spacing:1.5,children:[e.jsx(l,{variant:"subtitle2",children:"Name"}),e.jsx(r.Text,{name:"name",placeholder:"Ex: Adventure Seekers Expedition..."})]}),e.jsxs(i,{spacing:1.5,children:[e.jsx(l,{variant:"subtitle2",children:"Content"}),e.jsx(r.Editor,{name:"content",sx:{maxHeight:480}})]}),e.jsxs(i,{spacing:1.5,children:[e.jsx(l,{variant:"subtitle2",children:"Images"}),e.jsx(r.Upload,{multiple:!0,thumbnail:!0,name:"images",maxSize:3145728,onRemove:A,onRemoveAll:O,onUpload:()=>console.info("ON UPLOAD")})]})]})]}),F=e.jsxs(D,{children:[e.jsx(C,{title:"Properties",subheader:"Additional functions and attributes...",sx:{mb:3}}),e.jsx(j,{}),e.jsxs(i,{spacing:3,sx:{p:3},children:[e.jsxs("div",{children:[e.jsx(l,{variant:"subtitle2",sx:{mb:1.5},children:"Tour guide"}),e.jsx(r.Autocomplete,{multiple:!0,name:"tourGuides",placeholder:"+ Tour Guides",disableCloseOnSelect:!0,options:M,getOptionLabel:s=>s.name,isOptionEqualToValue:(s,a)=>s.id===a.id,renderOption:(s,a)=>o.createElement("li",{...s,key:a.id},e.jsx(f,{alt:a.avatarUrl,src:a.avatarUrl,sx:{mr:1,width:24,height:24,flexShrink:0}},a.id),a.name),renderTags:(s,a)=>s.map((n,p)=>o.createElement(v,{...a({index:p}),key:n.id,size:"small",variant:"soft",label:n.name,avatar:e.jsx(f,{alt:n.name,src:n.avatarUrl})}))})]}),e.jsxs(i,{spacing:1.5,children:[e.jsx(l,{variant:"subtitle2",children:"Available"}),e.jsxs(i,{direction:{xs:"column",md:"row"},spacing:2,children:[e.jsx(r.DatePicker,{name:"available.startDate",label:"Start date"}),e.jsx(r.DatePicker,{name:"available.endDate",label:"End date"})]})]}),e.jsxs(i,{spacing:1.5,children:[e.jsx(l,{variant:"subtitle2",children:"Duration"}),e.jsx(r.Text,{name:"durations",placeholder:"Ex: 2 days, 4 days 3 nights..."})]}),e.jsxs(i,{spacing:1.5,children:[e.jsx(l,{variant:"subtitle2",children:"Destination"}),e.jsx(r.CountrySelect,{fullWidth:!0,name:"destination",placeholder:"+ Destination"})]}),e.jsxs(i,{spacing:1,children:[e.jsx(l,{variant:"subtitle2",children:"Services"}),e.jsx(r.MultiCheckbox,{name:"services",options:z,sx:{display:"grid",gridTemplateColumns:"repeat(2, 1fr)"}})]}),e.jsxs(i,{spacing:1.5,children:[e.jsx(l,{variant:"subtitle2",children:"Tags"}),e.jsx(r.Autocomplete,{name:"tags",placeholder:"+ Tags",multiple:!0,freeSolo:!0,disableCloseOnSelect:!0,options:H.map(s=>s),getOptionLabel:s=>s,renderOption:(s,a)=>o.createElement("li",{...s,key:a},a),renderTags:(s,a)=>s.map((n,p)=>o.createElement(v,{...a({index:p}),key:n,label:n,size:"small",color:"info",variant:"soft"}))})]})]})]}),P=e.jsxs(i,{direction:"row",alignItems:"center",flexWrap:"wrap",children:[e.jsx(B,{control:e.jsx(W,{defaultChecked:!0,inputProps:{id:"publish-switch"}}),label:"Publish",sx:{flexGrow:1,pl:3}}),e.jsx(X,{type:"submit",variant:"contained",size:"large",loading:k,sx:{ml:2},children:t?"Save changes":"Create tour"})]});return e.jsx(I,{methods:b,onSubmit:q,children:e.jsxs(i,{spacing:{xs:3,md:5},sx:{mx:"auto",maxWidth:{xs:720,xl:880}},children:[w,F,P]})})}export{ee as T};
