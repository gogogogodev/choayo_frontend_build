import{f as m,r as a,cB as c,k as R,a as d,e as l,cG as G,q as u,v as t,cC as _,d$ as b,i_ as I}from"./index-DL1FC2Xw.js";import{a as L,C as N}from"./errors-wZ747Yys.js";const k=a.createContext(void 0),B=()=>{const e=a.useContext(k);if(e===void 0)throw new Error("useContextPage must be used within a PageContext.Provider");return e},K=({children:e})=>{const r=m(),[o,s]=a.useState(0),i=()=>s(n=>n+1),[y,P]=a.useState(""),w=n=>{P(n)},[f,x]=a.useState(0),T=n=>{x(n)},[v,D]=a.useState(0),E=n=>{D(n)},[g,O]=a.useState({keyword:"",status:c.all}),F=n=>{O(n)},p=m(!1),S=m(!1),[h,j]=a.useState(null),$=n=>{j(n),n.status!==c.normal&&p.onTrue()},C=a.useMemo(()=>({openDialogQR:r,refreshFlag:o,triggerRefresh:i,keyword:y,updateKeyword:w,page:f,updatePage:T,rowsPerPage:v,updateRowsPerPage:E,productToSurveySearch:g,updateProductToSurveySearch:F,disabledAllInput:p,openDialogEditProduct:S,productSurveyDetail:h,productSurveyDetailSet:$}),[r,o,y,f,v,g,p,S,h]);return R.jsx(k.Provider,{value:C,children:e})},U=async({keyword:e,status:r,page:o})=>{try{return(await d.get(`${l.product_survey.to_survey}?search=${e}&status=${r}&page=${o}&order_by=created_at&order_direction=desc`)).data}catch(s){throw console.error("ProductToSurveyGetList - error : ",s),new Error("something wrong")}},A=async({keyword:e,page:r})=>{try{return(await d.get(`${l.product_survey.recent_survey}?search=${e}&page=${r}&order_by=created_at&order_direction=desc`)).data}catch(o){throw console.error("ProductRecentSurveyGetList - error : ",o),new Error("something wrong")}},M=async e=>{try{return(await d.get(`${l.product_survey.to_survey}/${e}`)).data}catch(r){throw r.status===404?new L(r.data):(console.error("ProductSurveyDetailGet - error : ",r),new Error("something wrong"))}},Q=e=>{const r=[];for(let s=0;s<e.files.length;s++)r.push({fileObj:null,caption:e.files[s].caption,fileInfo:{url:e.files[s].url,name:e.files[s].original_name,extention:e.files[s].extention}});const o=e.remarks.length>0?e.remarks.map(s=>({id:s.id??"",name:s.name})):[];return{order_product_id:e.order_product_id,product_name:e.product_name,product_sku:e.product_sku,product_category:e.product_category,brand:{id:e.brand_id,name:e.brand},color:{id:e.color_id,name:e.color},remarks:o,survey_status:e.status,survey_note:e.notes,need_confirmation:e.need_customer_confirmation?"1":"0",confirmation_note:e.production_note,feedback_status:e.feedback_status,feedback_notes:e.feedback_notes,pictures:r}},z=async(e,r)=>{try{const o=V(r);await d.post(`${l.product_survey.process}`,o,{headers:{"content-type":"multipart/form-data"}})}catch(o){if(o.status===422){if(o.data&&o.data.errors)throw new N(o.data.errors)}else throw console.error("RevokeRequestOtp - error : ",o),new Error("Oops, an error occurred while saving data!")}},H=e=>{const r=e.need_confirmation=="1",o=[];e.pictures.forEach(i=>{i.fileObj&&o.push(i.fileObj)});const s=e.remarks?.map(i=>i.id);return{order_product_id:e.order_product_id,brand_id:e.brand.id,color_id:e.color.id,remarks:s??[],notes:e.survey_note,caption:[],file:o,need_confirmation:r,confirmation_note:e.confirmation_note}},V=e=>{var r=new FormData;return r.append("order_product_id",e.order_product_id),r.append("brand_id",e.brand_id),r.append("color_id",e.color_id),r.append("remarks",JSON.stringify(e.remarks)),r.append("notes",e.notes),r.append("caption",JSON.stringify(e.caption)),r.append("need_confirmation",JSON.stringify(e.need_confirmation)),r.append("confirmation_note",e.confirmation_note),e.file.forEach(o=>{r.append("file[]",o)}),r},W=u({keyword:t(),status:u({id:_(Object.values(c),{message:"invalid survey status!"}),name:t()})}),X={keyword:"",status:{id:c.all,name:G(c.all)}},Y=u({order_product_id:t(),product_category:t(),product_name:t(),product_sku:t(),brand:u({id:t(),name:t()}),color:u({id:t(),name:t()}),remarks:b(u({id:t(),name:t()})).optional(),survey_status:_(Object.values(c),{message:"invalid survey status!"}),survey_note:t().max(255,"maksimal 255 karakter"),need_confirmation:t(),confirmation_note:t().max(255,"maksimal 255 karakter"),feedback_status:_(Object.values(c),{message:"invalid survey feedback status!"}),feedback_notes:t(),pictures:b(u({caption:t(),fileInfo:u({url:t(),name:t(),extention:t()}).nullable(),fileObj:I(File).nullable()})).min(1,"Foto wajib disertakan!")}),Z={order_product_id:"",product_category:"",product_name:"",product_sku:"",brand:{id:"",name:""},color:{id:"",name:""},remarks:[],survey_status:c.normal,survey_note:"",need_confirmation:"0",confirmation_note:"",feedback_status:c.normal,feedback_notes:"",pictures:[]};export{U as P,X as T,z as U,W as a,A as b,K as c,H as d,Z as e,Y as f,Q as g,M as h,B as u};
