import{k as e,p as B,ik as l,q as c,v as i,cC as $,il as S,C,aI as K,a as E,e as A,f as y,r as f,h as U,g as N,t as Y,aF as r,F as J,l as x,ay as t,I as Q,m as X,n as w,im as Z,io as ee,ip as v,i8 as se,o as k,bE as re,i as ae,dC as ie,H as ne,aE as oe}from"./index-CtazL8yi.js";import{C as te}from"./custom-breadcrumbs-DCKI5EoT.js";import{a as le}from"./format-number-CSJE7oq6.js";import{C as D}from"./errors-wZ747Yys.js";import{D as P}from"./divider-Dpf_2KZP.js";import{F as de}from"./form-caption-CV7um5w2.js";import{R as b}from"./rhf-autocomplete-on-enter-DMfNrNoq.js";import{R as me}from"./rhf-radio-group-DX9-_-9m.js";import{R as ce}from"./rhf-upload-C3OgFPC3.js";import{R as xe}from"./rhf-date-picker-2a_P4JNL.js";import{s as pe}from"./schema-helper-BI0i4TVU.js";import{C as j}from"./Card-DTCuhoee.js";import{S as p}from"./Skeleton-fN5wJ-1g.js";import"./RadioGroup-rk33BBJn.js";import"./FormGroup-3I9bsZvK.js";import"./FormControlLabel-DFxx6sAy.js";import"./upload-B6rOCRw-.js";import"./index-Cwjez_Mi.js";import"./placeholder-CbRedPRL.js";import"./preview-multi-file-DIDrQBye.js";import"./upload-avatar-CfvSEq0I.js";import"./DatePicker-BqHCM0PQ.js";import"./ListItem-D6s2wHyy.js";import"./MobileDateTimePicker-Cmz-Um3i.js";function ue(){return e.jsx(te,{heading:"Profile",links:[{name:"Dashboard",href:B.dashboard.root},{name:"Profile",href:"#"}],sx:{mb:{xs:3,md:5}}})}const he=c({id:i(),photoURL:pe.file({message:{required_error:"Avatar is required!"}}).nullable(),email:i().min(1,{message:"Email is required!"}),password:i().nullable(),name_prefix:c({label:i(),value:i()}),name:i(),name_suffix:c({label:i(),value:i()}),gender:$(Object.values(l),{message:'Gender must be either "M" or "F"!'}),birth_date:i(),birth_place:i(),phone:i(),address_text:i(),address_description:i(),address_kode_pos:i(),address_name:i(),wilayah:c({kecamatan_id:i(),kelurahan_id:i(),full_name:i()})}).refine(s=>!((s.address_text!==""||s.address_description!==""||s.address_name!=="")&&s.wilayah.full_name===""),{message:"Address is required",path:["wilayah"]}),F={id:"",photoURL:"",email:"",password:null,name_prefix:{label:"",value:""},name:"",name_suffix:{label:"",value:""},gender:l.M,birth_date:"",birth_place:"",phone:"",address_text:"",address_description:"",address_kode_pos:"",address_name:"",wilayah:{kecamatan_id:"",kelurahan_id:"",full_name:""}},fe=async()=>{try{return(await E.get(`${A.profile}`)).data}catch(s){throw console.error("ProfileGet - error : ",s),new Error("something wrong")}},be=(s,n)=>({id:s.id,photoURL:`${C.site.basePath}/assets/illustrations/characters/profile-1.png`,email:s.person.email??"",password:null,name_prefix:{label:s.person?.name_prefix??"",value:s.person?.name_prefix??""},name:s.person?.name??"",name_suffix:{label:s.person?.name_suffix??"",value:s.person?.name_suffix??""},gender:s.person?.gender??l.M,birth_date:s.person?.birth_date??"",birth_place:s.person?.birth_place??"",phone:S(s.person?.phone??""),address_text:s.person?.address?.text??"",address_description:s.person?.address?.description??"",address_kode_pos:s.person?.address?.kode_pos??"0",address_name:s.person?.address?.name??"",wilayah:s.person?.address?{kecamatan_id:String(s.person?.address.kecamatan_id??""),kelurahan_id:String(s.person?.address.kelurahan_id??""),full_name:String(s.person?.address.full_name??"")}:n.wilayah}),je=async s=>{try{await E.post(`${A.profile}/${s.id}?_method=PUT`,s)}catch(n){throw n.status===422?n.data&&n.data.errors?new D(n.data.errors):n:(console.error("ProfileFormSubmit - error : ",n),new Error("something wrong"))}},_e=s=>({id:s.id??"",email:s.email,password:s.password??void 0,name_prefix:s.name_prefix.value,name:s.name,name_suffix:s.name_suffix.value,gender:s.gender,birth_date:K(s.birth_date,"YYYY-MM-DD")??"",birth_place:s.birth_place,phone:s.phone!==""?`62${s.phone}`:"",address:s.wilayah.full_name!==""?{name:s.address_name,kecamatan_id:s.wilayah.kecamatan_id??"",kelurahan_id:s.wilayah.kelurahan_id,full_name:s.wilayah.full_name,text:s.address_text,description:s.address_description,kode_pos:s.address_kode_pos,latitude:"0",longitude:"0"}:null});function ge(){const s=y(!0),n=y(),[u,T]=f.useState(U("mobile-websocket-key")),[R,_]=f.useState(!1),G=()=>{_(!0),setTimeout(()=>{ae("mobile-websocket-key",u),_(!1)},1e3)},h=N({resolver:Y(he),defaultValues:F}),{reset:I,watch:L,setValue:M,handleSubmit:z,formState:{isSubmitting:O,isDirty:V}}=h,g=async a=>{a&&s.onTrue(),await fe().then(o=>{I(be(o,F))}).finally(()=>{s.onFalse()})};f.useEffect(()=>{g(!0)},[]);const W=async a=>{const o=_e(a);await je(o).then(()=>{ie.success("data saved successfully!",{position:"top-center"}),g(!1)}).catch(d=>{d instanceof D&&Object.keys(d.validationErrors).forEach(m=>{h.setError(m,{type:"manual",message:d.validationErrors[m][0]})})})};return e.jsxs(r,{container:!0,spacing:3,children:[e.jsx(r,{xs:12,children:e.jsx(J,{methods:h,onSubmit:z(W),children:e.jsxs(r,{container:!0,spacing:3,children:[e.jsx(r,{xs:12,md:4,children:e.jsx(j,{sx:{pt:5,pb:5,px:3,textAlign:"center"},children:e.jsx(ce,{name:"photoURL",maxSize:3145728,helperText:e.jsxs(x,{variant:"caption",sx:{mt:3,mx:"auto",display:"block",textAlign:"center",color:"text.disabled"},children:["Allowed *.jpeg, *.jpg, *.png, *.gif",e.jsx("br",{})," max size of ",le(3145728)]})})})}),e.jsx(r,{xs:12,md:8,children:e.jsx(j,{sx:{p:3},children:s.value?e.jsxs(r,{container:!0,spacing:3,children:[e.jsx(r,{xs:12,children:e.jsx(p,{variant:"rounded",sx:{width:"100%",height:60}})}),e.jsx(r,{xs:12,children:e.jsx(p,{variant:"rounded",sx:{width:"100%",height:60}})}),e.jsx(r,{xs:12,children:e.jsx(p,{variant:"rounded",sx:{width:"100%",height:60}})}),e.jsx(r,{xs:12,children:e.jsx(p,{variant:"rounded",sx:{width:"100%",height:60}})})]}):e.jsxs(r,{container:!0,spacing:3,children:[e.jsx(r,{xs:12,md:6,children:e.jsx(t,{name:"email",label:"Email",size:"medium"})}),e.jsx(r,{xs:12,md:6,children:e.jsx(t,{type:n.value?"text":"password",name:"password",label:"Password",size:"medium",disabled:L("id")==="",InputProps:{endAdornment:e.jsx(Q,{position:"end",children:e.jsx(X,{onClick:n.onToggle,edge:"end",children:e.jsx(w,{icon:n.value?"solar:eye-bold":"solar:eye-closed-bold"})})})}})}),e.jsx(r,{xs:12,md:4,children:e.jsx(b,{name:"name_prefix",debounceSearch:!0,label:"Prefix",isOptionEqualToValue:(a,o)=>a?.value===o?.value,getOptionLabel:a=>a?.label,fetchFunction:async a=>await Z()})}),e.jsx(r,{xs:12,md:4,children:e.jsx(t,{name:"name",label:"Name",size:"medium"})}),e.jsx(r,{xs:12,md:4,children:e.jsx(b,{name:"name_suffix",debounceSearch:!0,label:"Suffix",isOptionEqualToValue:(a,o)=>a?.value===o?.value,getOptionLabel:a=>a?.label,fetchFunction:async()=>await ee()})}),e.jsx(r,{xs:12,children:e.jsx(me,{row:!0,sx:{px:.2},name:"gender",label:"Gender",options:[{label:v(l.M),value:l.M},{label:v(l.F),value:l.F}]})}),e.jsx(r,{xs:12,md:6,children:e.jsx(xe,{name:"birth_date",label:"Birth Date"})}),e.jsx(r,{xs:12,md:6,children:e.jsx(t,{name:"birth_place",label:"Birth Place",size:"medium"})}),e.jsx(r,{xs:12,children:e.jsx(t,{name:"phone",label:"Phone",size:"medium",onChange:a=>{M("phone",S(a.target.value),{shouldDirty:!0})},InputProps:{startAdornment:e.jsx(x,{sx:{pr:2},color:"text.disabled",children:"+62"})}})}),e.jsx(r,{xs:12,children:e.jsx(P,{children:e.jsx(x,{variant:"body2",color:"GrayText",children:"Address Section"})})}),e.jsx(r,{xs:12,children:e.jsx(b,{name:"wilayah",debounceSearch:!0,label:"Address",getOptionLabel:a=>a?.full_name,sx:{"& .MuiAutocomplete-popupIndicator":{transform:"none"}},popupIcon:e.jsx(w,{icon:"eva:search-fill",sx:{color:"text.disabled"}}),fetchFunction:async a=>se({keyword:a}),isOptionEqualToValue:(a,o)=>a?.kelurahan_id===o?.kelurahan_id,filterOptions:(a,o)=>{const d=o.inputValue.toLowerCase().trim().replace(/,/g,"").split(/\s+/);return a.filter(m=>{const q=m.full_name.toLowerCase().replace(/,/g,"");return d.every(H=>new RegExp(`\\b${H}`,"i").test(q))})}})}),e.jsx(r,{xs:12,children:e.jsx(t,{name:"address_text",label:"Address Full",size:"medium"})}),e.jsx(r,{xs:12,children:e.jsx(t,{name:"address_description",label:"Address Description",size:"medium"})}),e.jsx(r,{xs:6,children:e.jsx(t,{name:"address_kode_pos",label:"Address Postal Code",size:"medium"})}),e.jsx(r,{xs:6,children:e.jsx(t,{name:"address_name",label:"Address Name",size:"medium"})}),e.jsx(r,{xs:12,children:e.jsx(de,{caption:"Fill in the form above and correct it again correctly"})}),e.jsx(r,{xs:12,display:"flex",justifyContent:"flex-end",children:e.jsx(k,{size:"medium",type:"submit",disabled:!V,variant:"contained",loading:O,children:"Save"})})]})})})]})})}),e.jsxs(r,{container:!0,xs:12,children:[e.jsx(r,{xs:12,md:4}),e.jsxs(r,{container:!0,spacing:3,xs:12,md:8,children:[e.jsx(r,{xs:12,children:e.jsx(P,{children:e.jsx(x,{variant:"body2",color:"GrayText",children:"Print Key Mobile"})})}),e.jsx(r,{xs:12,children:e.jsx(j,{sx:{p:3},children:e.jsxs(r,{container:!0,spacing:3,children:[e.jsx(r,{xs:12,children:e.jsx(re,{onChange:a=>{a.target.value.length<=4&&T(a.target.value)},value:u,label:"Print Key Mobile",fullWidth:!0})}),e.jsx(r,{xs:12,display:"flex",justifyContent:"flex-end",children:e.jsx(k,{size:"medium",disabled:!u,variant:"contained",loading:R,onClick:()=>G(),children:"Save"})})]})})})]})]})]})}const ye={title:`Dashboard - Profile - ${C.site.name}`};function Ke(){return e.jsxs(e.Fragment,{children:[e.jsx(ne,{children:e.jsxs("title",{children:[" ",ye.title]})}),e.jsxs(oe,{maxWidth:"xl",children:[e.jsx(ue,{}),e.jsx(ge,{})]})]})}export{Ke as default};
