import{r as n,f as R,k as e,i7 as L,g as _,t as k,c6 as A,F as T,dj as G,c8 as z,aw as I,C as B,aF as a,im as H,ay as l,io as N,ik as b,ip as D,l as E,il as q,i8 as M,n as K,bZ as W,ag as X,o as Y}from"./index-DL1FC2Xw.js";import{C as Z}from"./errors-wZ747Yys.js";import{D as $}from"./divider-oAQn-qZp.js";import{R as F}from"./rhf-autocomplete-on-enter-kdiwxQrI.js";import{R as J}from"./rhf-radio-group-c3xmrwMe.js";import{R as Q}from"./rhf-date-picker-CcRSy6lj.js";import{F as U}from"./form-caption-DFg98poz.js";import{c as ee,a as se,b as ae,d as te}from"./functions-BoFIsn5X.js";import{C as P,a as oe}from"./schemas-CENM9CnB.js";const S=n.createContext(void 0),he=()=>{const i=n.useContext(S);if(i===void 0)throw new Error("useContextPage must be used within a PageContext.Provider");return i},re=()=>n.useContext(S)??null,fe=({children:i})=>{const x=R(),[r,C]=n.useState(0),p=()=>C(o=>o+1),[h,c]=n.useState(""),d=o=>{c(o)},[m,v]=n.useState(null),w=o=>{v(o)},[f,y]=n.useState(0),g=o=>{y(o)},[j,s]=n.useState(0),t=o=>{s(o)},u=n.useMemo(()=>({isDialogFormOpen:x,refreshFlag:r,triggerRefresh:p,keyword:h,updateKeyword:d,customerFormValues:m,updateCustomerFormValues:w,page:f,updatePage:g,rowsPerPage:j,updateRowsPerPage:t}),[x,r,h,m,f,j]);return e.jsx(S.Provider,{value:u,children:i})};function ge(i){const{showSweetDialog:x}=L(),r=re(),[C,p]=n.useState("New Customer"),h=r?r.isDialogFormOpen.value:i.openDialog||!1,c=r?r.customerFormValues:i.formValues,d=_({resolver:k(oe),defaultValues:P}),{reset:m,setValue:v,handleSubmit:w,formState:{isSubmitting:f,isDirty:y}}=d;n.useEffect(()=>{c?(p("Edit Customer"),m(ee(c,P))):p("New Customer")},[c]);const g=()=>{r&&(r.updateCustomerFormValues(null),r.isDialogFormOpen.onFalse()),m(P),i.onClose?.()},j=async s=>{const t=ae(s);await te(t).then(()=>{r&&r.triggerRefresh(),x({icon:"success",title:"Data saved successfully",description:"Saved successfully"}),i.onSubmit?.(),g()}).catch(u=>{u instanceof Z&&Object.keys(u.validationErrors).forEach(o=>{d.setError(o,{type:"manual",message:u.validationErrors[o][0]})})})};return e.jsx(A,{open:h,children:e.jsxs(T,{methods:d,onSubmit:w(j),children:[e.jsx(G,{children:C}),e.jsx(z,{sx:{overflow:"visible"},children:e.jsx(I,{sx:{pt:1,overflowY:"auto",overflowX:"hidden",maxHeight:B.dialog.maxHeight},children:e.jsxs(a,{container:!0,spacing:3,children:[e.jsx(a,{xs:12,md:4,children:e.jsx(F,{name:"name_prefix",debounceSearch:!0,label:"Prefix",isOptionEqualToValue:(s,t)=>s?.value===t?.value,getOptionLabel:s=>s?.label,fetchFunction:async s=>await H()})}),e.jsx(a,{xs:12,md:4,children:e.jsx(l,{name:"name",label:"Name",size:"medium"})}),e.jsx(a,{xs:12,md:4,children:e.jsx(F,{name:"name_suffix",debounceSearch:!0,label:"Suffix",isOptionEqualToValue:(s,t)=>s?.value===t?.value,getOptionLabel:s=>s?.label,fetchFunction:async()=>await N()})}),e.jsx(a,{xs:12,children:e.jsx(J,{row:!0,sx:{px:.2},name:"gender",label:"Gender",options:[{label:D(b.M),value:b.M},{label:D(b.F),value:b.F}]})}),e.jsx(a,{xs:12,md:6,children:e.jsx(l,{name:"phone",size:"medium",label:"Phone",onChange:s=>{v("phone",q(s.target.value),{shouldDirty:!0})},InputProps:{startAdornment:e.jsx(E,{sx:{pr:2},color:"text.disabled",children:"+62"})}})}),e.jsx(a,{xs:12,md:6,children:e.jsx(l,{name:"email",label:"Email",size:"medium"})}),e.jsx(a,{xs:12,md:6,children:e.jsx(Q,{name:"birth_date",label:"Birth Date"})}),e.jsx(a,{xs:12,md:6,children:e.jsx(l,{name:"birth_place",label:"Birth Place",size:"medium"})}),e.jsx(a,{xs:12,children:e.jsx(F,{label:"Customer Level",debounceSearch:!0,name:"level",isOptionEqualToValue:(s,t)=>s?.id===t?.id,getOptionLabel:s=>s?.name,fetchFunction:async s=>(await se({keyword:s,page:1})).data})}),e.jsx(a,{xs:12,children:e.jsx($,{children:e.jsx(E,{variant:"body2",color:"GrayText",children:"Address Section"})})}),e.jsx(a,{xs:12,children:e.jsx(F,{name:"wilayah",debounceSearch:!0,label:"Address",getOptionLabel:s=>s?.full_name,sx:{"& .MuiAutocomplete-popupIndicator":{transform:"none"}},popupIcon:e.jsx(K,{icon:"eva:search-fill",sx:{color:"text.disabled"}}),fetchFunction:async s=>await M({keyword:s}),isOptionEqualToValue:(s,t)=>s?.kelurahan_id===t?.kelurahan_id,filterOptions:(s,t)=>{const u=t.inputValue.toLowerCase().trim().replace(/,/g,"").split(/\s+/);return s.filter(o=>{const V=o.full_name.toLowerCase().replace(/,/g,"");return u.every(O=>new RegExp(`\\b${O}`,"i").test(V))})}})}),e.jsx(a,{xs:12,children:e.jsx(l,{name:"address_text",label:"Address Full",size:"medium"})}),e.jsx(a,{xs:12,children:e.jsx(l,{name:"address_description",label:"Address Description",size:"medium"})}),e.jsx(a,{xs:12,children:e.jsx(l,{name:"address_kode_pos",label:"Address Postal Code",size:"medium"})}),e.jsx(a,{xs:12,children:e.jsx(l,{name:"address_name",label:"Address Name",size:"medium"})}),e.jsx(a,{xs:12,children:e.jsx(U,{caption:"Fill in the form above and correct it again correctly"})})]})})}),e.jsxs(W,{children:[e.jsx(X,{onClick:g,variant:"outlined",color:"inherit",children:"Cancel"}),e.jsx(Y,{size:"medium",type:"submit",disabled:!y,variant:"contained",loading:f,children:"Save"})]})]})})}export{ge as C,fe as P,he as u};
