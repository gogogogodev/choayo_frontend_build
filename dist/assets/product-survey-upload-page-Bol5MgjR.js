import{k as e,aF as O,ax as he,cx as me,aw as U,cy as K,cz as Q,cA as fe,S,l as P,ag as _,p as te,R as pe,f as D,cB as M,A as W,c6 as H,dj as B,c8 as N,C as L,ay as $,bZ as G,aM as T,aC as ve,cG as xe,cH as ge,as as je,n as V,aB as ye,c$ as be,cf as Se,fA as Ce,bI as q,m as re,r as w,cE as ke,i$ as X,ci as we,bJ as Y,cF as Ue,cD as ne,i9 as R,dC as ie,g as Pe,t as Fe,F as _e,H as Me,aE as Ee}from"./index-CtazL8yi.js";import{u as E,U as ae,d as oe,e as Oe,f as Ie,g as Re,h as De,c as Te}from"./schemas-w72kr6-P.js";import{C as se,a as Ae}from"./errors-wZ747Yys.js";import{u as ze}from"./use-params-Bum5sHW6.js";import{S as A}from"./Skeleton-fN5wJ-1g.js";import{F as ce}from"./form-caption-CV7um5w2.js";import{C as J}from"./Card-DTCuhoee.js";import{u as Le}from"./index-Cwjez_Mi.js";import{a as We}from"./format-number-CSJE7oq6.js";import{U as qe}from"./placeholder-CbRedPRL.js";import{R as He}from"./rhf-radio-group-DX9-_-9m.js";import{R as Z}from"./rhf-autocomplete-on-enter-DMfNrNoq.js";import{R as Be}from"./rhf-autocomplete-checkboxes-CSLOkIHn.js";import{b as Ne}from"./functions-Bap2C2L8.js";import{b as $e}from"./functions-CFE0JKCC.js";import{c as Ge}from"./functions-Bu01K6lk.js";import{C as Ve}from"./custom-breadcrumbs-DCKI5EoT.js";import"./RadioGroup-rk33BBJn.js";import"./FormGroup-3I9bsZvK.js";import"./FormControlLabel-DFxx6sAy.js";function Je(){return e.jsxs(O,{container:!0,spacing:3,children:[e.jsx(O,{xs:12,children:e.jsx(A,{variant:"rounded",sx:{width:"100%",height:236}})}),e.jsx(O,{xs:12,sm:7,children:e.jsx(A,{variant:"rounded",sx:{width:"100%",height:236}})}),e.jsx(O,{xs:12,sm:5,children:e.jsx(A,{variant:"rounded",sx:{width:"100%",height:236}})})]})}function Ke(){return e.jsx(he,{component:me,children:e.jsxs(U,{sx:{display:"flex",flexDirection:"column",alignItems:"center"},children:[e.jsx(K.div,{variants:Q().in,children:e.jsx(fe,{sx:{mt:{xs:5,sm:10},mb:{xs:3,sm:8}}})}),e.jsx(K.div,{variants:Q().in,children:e.jsxs(S,{spacing:2,alignItems:"center",children:[e.jsx(P,{variant:"h5",sx:{color:"text.secondary"},children:"Ups, data not found"}),e.jsx(_,{size:"medium",variant:"contained",component:pe,href:te.dashboard.survey.product_survey,children:"Back"})]})})]})})}function Qe(){const{productSurveyDetail:c}=E(),h=D(!1);return e.jsxs(e.Fragment,{children:[c?.need_customer_confirmation===!0&&c.feedback_status===M.approved?e.jsxs(W,{severity:"success",action:e.jsx(_,{size:"small",variant:"text",sx:{textDecoration:"underline"},onClick:h.onTrue,children:"detail"}),children:[e.jsx(U,{sx:{fontWeight:600},component:"span",children:"Disetujui, "}),"item dapat dilanjutkan ke proses berikutnya ..."]}):c?.need_customer_confirmation===!0&&c.feedback_status===M.rejected?e.jsxs(W,{severity:"error",action:e.jsx(_,{size:"small",variant:"text",sx:{textDecoration:"underline"},onClick:h.onTrue,children:"detail"}),children:[e.jsx(U,{sx:{fontWeight:600},component:"span",children:"Ditolak, "}),"item dikonfirmasi untuk tidak dilanjutkan!"]}):c?.need_customer_confirmation===!0&&c.feedback_status===M.need_confirmation?e.jsx(W,{severity:"warning",children:"Sedang menunggu confirmasi customer!"}):e.jsx(e.Fragment,{}),e.jsx(Xe,{isOpen:h.value,closeDialog:h.onFalse})]})}function Xe({isOpen:c,closeDialog:h}){return e.jsxs(H,{open:c,fullWidth:!0,maxWidth:"sm",children:[e.jsx(B,{children:"Customer Feedback"}),e.jsx(N,{sx:{overflow:"visible"},children:e.jsx(U,{sx:{pt:1,overflowY:"auto",overflowX:"hidden",maxHeight:L.dialog.maxHeight},children:e.jsx($,{rows:4,disabled:!0,multiline:!0,label:"Feedback",name:"feedback_notes"})})}),e.jsx(G,{children:e.jsx(_,{onClick:h,variant:"outlined",color:"inherit",children:"Close"})})]})}function Ye(){const{disabledAllInput:c,productSurveyDetail:h,openDialogEditProduct:v}=E(),m=T(),{getValues:n}=m;return e.jsx(J,{sx:{p:3},children:e.jsxs(S,{spacing:5,children:[e.jsxs(S,{spacing:1,children:[e.jsxs(S,{direction:"row",sx:{justifyContent:"space-between"},children:[e.jsxs(S,{spacing:.5,children:[e.jsx(P,{variant:"body2",color:"text.disabled",children:h?.order_no}),e.jsx(P,{variant:"body2",color:"text.disabled",children:h?.customer_name}),e.jsx(P,{variant:"body2",color:"text.disabled",children:h?.customer_email}),e.jsx(P,{variant:"body2",color:"text.disabled",children:h?.customer_phone})]}),e.jsx(ve,{variant:"soft",color:ge(n("survey_status")),children:xe(n("survey_status"))})]}),e.jsx(je,{sx:{borderStyle:"dashed",bgcolor:"grey.200",width:"100%"}}),e.jsxs(S,{spacing:.5,children:[e.jsxs(S,{spacing:.5,direction:"row",alignItems:"center",children:[e.jsxs(P,{variant:"subtitle2",children:[n("product_name"),e.jsx(U,{component:"span",sx:{color:"text.disabled"},children:` (${n("brand.name")===""?"-":n("brand.name")})`})]}),e.jsx(V,{width:16,icon:"solar:pen-bold",onClick:()=>v.onTrue(),sx:{cursor:"pointer","&:hover":{color:"text.disabled"}}})]}),e.jsxs(S,{spacing:.5,children:[e.jsx(P,{variant:"body2",color:"text.disabled",children:`SKU | ${n("product_sku")}`}),e.jsx(P,{variant:"body2",color:"text.disabled",children:`Color (${n("color.name")===""?"-":n("color.name")})`}),e.jsx(P,{variant:"body2",color:"text.disabled",children:`Remarks (${n("remarks")?.length?n("remarks")?.map(i=>ye(i?.name??"")).join(", "):"-"})`})]})]})]}),e.jsxs(S,{spacing:2,children:[e.jsx($,{name:"survey_note",label:"Notes",disabled:c.value,multiline:!0,rows:4}),e.jsx(ce,{caption:"Fill in the form above and correct it again correctly"})]})]})})}var z={exports:{}},Ze=z.exports,ee;function et(){return ee||(ee=1,(function(c,h){(function(m,n){c.exports=n(be())})(Ze,function(v){return(function(m){var n={};function i(a){if(n[a])return n[a].exports;var o=n[a]={i:a,l:!1,exports:{}};return m[a].call(o.exports,o,o.exports,i),o.l=!0,o.exports}return i.m=m,i.c=n,i.d=function(a,o,f){i.o(a,o)||Object.defineProperty(a,o,{enumerable:!0,get:f})},i.r=function(a){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(a,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(a,"__esModule",{value:!0})},i.t=function(a,o){if(o&1&&(a=i(a)),o&8||o&4&&typeof a=="object"&&a&&a.__esModule)return a;var f=Object.create(null);if(i.r(f),Object.defineProperty(f,"default",{enumerable:!0,value:a}),o&2&&typeof a!="string")for(var k in a)i.d(f,k,(function(b){return a[b]}).bind(null,k));return f},i.n=function(a){var o=a&&a.__esModule?function(){return a.default}:function(){return a};return i.d(o,"a",o),o},i.o=function(a,o){return Object.prototype.hasOwnProperty.call(a,o)},i.p="",i(i.s="./src/react-webcam.tsx")})({"./src/react-webcam.tsx":(function(m,n,i){i.r(n);var a=i("react"),o=(function(){var u=function(d,t){return u=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,l){r.__proto__=l}||function(r,l){for(var s in l)l.hasOwnProperty(s)&&(r[s]=l[s])},u(d,t)};return function(d,t){u(d,t);function r(){this.constructor=d}d.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}})(),f=function(){return f=Object.assign||function(u){for(var d,t=1,r=arguments.length;t<r;t++){d=arguments[t];for(var l in d)Object.prototype.hasOwnProperty.call(d,l)&&(u[l]=d[l])}return u},f.apply(this,arguments)},k=function(u,d){var t={};for(var r in u)Object.prototype.hasOwnProperty.call(u,r)&&d.indexOf(r)<0&&(t[r]=u[r]);if(u!=null&&typeof Object.getOwnPropertySymbols=="function")for(var l=0,r=Object.getOwnPropertySymbols(u);l<r.length;l++)d.indexOf(r[l])<0&&Object.prototype.propertyIsEnumerable.call(u,r[l])&&(t[r[l]]=u[r[l]]);return t};(function(){typeof window>"u"||(navigator.mediaDevices===void 0&&(navigator.mediaDevices={}),navigator.mediaDevices.getUserMedia===void 0&&(navigator.mediaDevices.getUserMedia=function(d){var t=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia;return t?new Promise(function(r,l){t.call(navigator,d,r,l)}):Promise.reject(new Error("getUserMedia is not implemented in this browser"))}))})();function b(){return!!(navigator.mediaDevices&&navigator.mediaDevices.getUserMedia)}var p=(function(u){o(d,u);function d(t){var r=u.call(this,t)||this;return r.canvas=null,r.ctx=null,r.requestUserMediaId=0,r.unmounted=!1,r.state={hasUserMedia:!1},r}return d.prototype.componentDidMount=function(){var t=this,r=t.state,l=t.props;if(this.unmounted=!1,!b()){l.onUserMediaError("getUserMedia not supported");return}r.hasUserMedia||this.requestUserMedia(),l.children&&typeof l.children!="function"&&console.warn("children must be a function")},d.prototype.componentDidUpdate=function(t){var r=this.props;if(!b()){r.onUserMediaError("getUserMedia not supported");return}var l=JSON.stringify(t.audioConstraints)!==JSON.stringify(r.audioConstraints),s=JSON.stringify(t.videoConstraints)!==JSON.stringify(r.videoConstraints),x=t.minScreenshotWidth!==r.minScreenshotWidth,g=t.minScreenshotHeight!==r.minScreenshotHeight;(s||x||g)&&(this.canvas=null,this.ctx=null),(l||s)&&(this.stopAndCleanup(),this.requestUserMedia())},d.prototype.componentWillUnmount=function(){this.unmounted=!0,this.stopAndCleanup()},d.stopMediaStream=function(t){t&&(t.getVideoTracks&&t.getAudioTracks?(t.getVideoTracks().map(function(r){t.removeTrack(r),r.stop()}),t.getAudioTracks().map(function(r){t.removeTrack(r),r.stop()})):t.stop())},d.prototype.stopAndCleanup=function(){var t=this.state;t.hasUserMedia&&(d.stopMediaStream(this.stream),t.src&&window.URL.revokeObjectURL(t.src))},d.prototype.getScreenshot=function(t){var r=this,l=r.state,s=r.props;if(!l.hasUserMedia)return null;var x=this.getCanvas(t);return x&&x.toDataURL(s.screenshotFormat,s.screenshotQuality)},d.prototype.getCanvas=function(t){var r=this,l=r.state,s=r.props;if(!this.video||!l.hasUserMedia||!this.video.videoHeight)return null;if(!this.ctx){var x=this.video.videoWidth,g=this.video.videoHeight;if(!this.props.forceScreenshotSourceSize){var j=x/g;x=s.minScreenshotWidth||this.video.clientWidth,g=x/j,s.minScreenshotHeight&&g<s.minScreenshotHeight&&(g=s.minScreenshotHeight,x=g*j)}this.canvas=document.createElement("canvas"),this.canvas.width=t?.width||x,this.canvas.height=t?.height||g,this.ctx=this.canvas.getContext("2d")}var F=this,C=F.ctx,y=F.canvas;return C&&y&&(y.width=t?.width||y.width,y.height=t?.height||y.height,s.mirrored&&(C.translate(y.width,0),C.scale(-1,1)),C.imageSmoothingEnabled=s.imageSmoothing,C.drawImage(this.video,0,0,t?.width||y.width,t?.height||y.height),s.mirrored&&(C.scale(-1,1),C.translate(-y.width,0))),y},d.prototype.requestUserMedia=function(){var t=this,r=this.props,l=function(g,j){var F={video:typeof j<"u"?j:!0};r.audio&&(F.audio=typeof g<"u"?g:!0),t.requestUserMediaId++;var C=t.requestUserMediaId;navigator.mediaDevices.getUserMedia(F).then(function(y){t.unmounted||C!==t.requestUserMediaId?d.stopMediaStream(y):t.handleUserMedia(null,y)}).catch(function(y){t.handleUserMedia(y)})};if("mediaDevices"in navigator)l(r.audioConstraints,r.videoConstraints);else{var s=function(g){return{optional:[{sourceId:g}]}},x=function(g){var j=g.deviceId;return typeof j=="string"?j:Array.isArray(j)&&j.length>0?j[0]:typeof j=="object"&&j.ideal?j.ideal:null};MediaStreamTrack.getSources(function(g){var j=null,F=null;g.forEach(function(I){I.kind==="audio"?j=I.id:I.kind==="video"&&(F=I.id)});var C=x(r.audioConstraints);C&&(j=C);var y=x(r.videoConstraints);y&&(F=y),l(s(j),s(F))})}},d.prototype.handleUserMedia=function(t,r){var l=this.props;if(t||!r){this.setState({hasUserMedia:!1}),l.onUserMediaError(t);return}this.stream=r;try{this.video&&(this.video.srcObject=r),this.setState({hasUserMedia:!0})}catch{this.setState({hasUserMedia:!0,src:window.URL.createObjectURL(r)})}l.onUserMedia(r)},d.prototype.render=function(){var t=this,r=this,l=r.state,s=r.props,x=s.audio;s.forceScreenshotSourceSize;var g=s.disablePictureInPicture;s.onUserMedia,s.onUserMediaError,s.screenshotFormat,s.screenshotQuality,s.minScreenshotWidth,s.minScreenshotHeight,s.audioConstraints,s.videoConstraints,s.imageSmoothing;var j=s.mirrored,F=s.style,C=F===void 0?{}:F,y=s.children,I=k(s,["audio","forceScreenshotSourceSize","disablePictureInPicture","onUserMedia","onUserMediaError","screenshotFormat","screenshotQuality","minScreenshotWidth","minScreenshotHeight","audioConstraints","videoConstraints","imageSmoothing","mirrored","style","children"]),de=j?f(f({},C),{transform:(C.transform||"")+" scaleX(-1)"}):C,le={getScreenshot:this.getScreenshot.bind(this)};return a.createElement(a.Fragment,null,a.createElement("video",f({autoPlay:!0,disablePictureInPicture:g,src:l.src,muted:!x,playsInline:!0,ref:function(ue){t.video=ue},style:de},I)),y&&y(le))},d.defaultProps={audio:!1,disablePictureInPicture:!1,forceScreenshotSourceSize:!1,imageSmoothing:!0,mirrored:!1,onUserMedia:function(){},onUserMediaError:function(){},screenshotFormat:"image/webp",screenshotQuality:.92},d})(a.Component);n.default=p}),react:(function(m,n){m.exports=v})}).default})})(z)),z.exports}var tt=et();const rt=Se(tt);function nt(){const c=D(!1),{disabledAllInput:h}=E(),v=T(),{control:m,setValue:n}=v,{fields:i,append:a,remove:o}=Ce({control:m,name:"pictures"});return e.jsx(J,{sx:{p:3},children:e.jsxs(S,{spacing:2,children:[e.jsx(it,{isDisabled:h.value,openCamera:()=>c.onTrue(),appendFile:f=>a({caption:"",fileInfo:null,fileObj:f})}),e.jsx(at,{isDialogOpen:c.value,closeCamera:()=>c.onFalse(),appendFile:f=>a({caption:"",fileInfo:null,fileObj:f})}),i.length==0?e.jsx(e.Fragment,{}):e.jsx(S,{spacing:2,children:i.map((f,k)=>e.jsx(ot,{index:k,remove:o,setValue:n,fileObj:f.fileObj,pictureFields:i,url:f.fileInfo?.url??"",name:f.fileInfo?.name??"",extention:f.fileInfo?.extention??""},k))})]})})}function it({isDisabled:c,openCamera:h,appendFile:v}){const{getRootProps:m,getInputProps:n}=Le({multiple:!0,disabled:c,accept:{"image/*":[]},onDrop(i){i.forEach(a=>{v(a)})}});return e.jsxs(U,{sx:{pb:5,outline:"none",borderRadius:1,overflow:"hidden",position:"relative",bgcolor:i=>q(i.vars.palette.grey["500Channel"],.08),border:i=>`1px dashed ${q(i.vars.palette.grey["500Channel"],.2)}`,...c&&{opacity:.48,pointerEvents:"none"}},children:[e.jsx(U,{sx:{p:1,display:"flex",justifyContent:"end"},children:e.jsx(re,{onClick:h,children:e.jsx(V,{icon:"mdi:camera",width:24})})}),e.jsxs(U,{...m(),sx:{cursor:"pointer",transition:i=>i.transitions.create(["opacity","padding"]),"&:hover":{opacity:.72}},children:[e.jsx("input",{...n()}),e.jsx(qe,{})]})]})}function at({isDialogOpen:c,closeCamera:h,appendFile:v}){const m=w.useRef(null),[n,i]=w.useState("unknown");function a(p,u){const d=p.split(","),t=d[0].match(/:(.*?);/),r=t?t[1]:"image/jpeg",l=atob(d[1]);let s=l.length;const x=new Uint8Array(s);for(;s--;)x[s]=l.charCodeAt(s);return new File([x],u,{type:r})}const o=w.useCallback(async()=>{try{await navigator.mediaDevices.getUserMedia({video:!0}),i("granted")}catch(p){console.warn("Camera access error:",p),(p.name==="NotAllowedError"||p.name==="SecurityError")&&p.message?.toLowerCase().includes("dismissed")?i("dismissed"):i("denied")}},[]),f=w.useCallback(()=>{const p=m.current?.video?.srcObject;p&&p.getTracks().forEach(u=>u.stop())},[]);w.useEffect(()=>{c&&o()},[c,o]);const k=w.useCallback(()=>{if(m.current){const p=m.current.getScreenshot();if(!p)return;const u=a(p,`camera-${Date.now()}.jpg`);v(u),b()}},[m,v]),b=()=>{f(),h()};return e.jsxs(H,{open:c,onClose:b,fullWidth:!0,maxWidth:"md",children:[e.jsx(B,{children:"Camera"}),e.jsx(N,{sx:{overflow:"hidden",display:"flex",flexDirection:"column",alignItems:"center"},children:e.jsxs(U,{sx:{width:"100%",maxHeight:"70vh",display:"flex",justifyContent:"center",alignItems:"center"},children:[n==="dismissed"&&e.jsxs(U,{sx:{textAlign:"center"},children:[e.jsx(P,{variant:"body1",sx:{mb:2},children:"Kamera belum diizinkan. Klik tombol di bawah untuk mencoba lagi."}),e.jsx(_,{variant:"contained",onClick:o,children:"Izinkan Kamera"})]}),n==="denied"&&e.jsx(U,{sx:{textAlign:"center"},children:e.jsx(P,{variant:"body1",sx:{mb:2},children:"Akses kamera diblokir. Silakan buka setting browser untuk mengizinkan kamera."})}),n==="granted"&&e.jsx(rt,{audio:!1,ref:m,screenshotFormat:"image/jpeg",videoConstraints:{facingMode:"user"},style:{width:"100%",borderRadius:8}}),n==="unknown"&&e.jsx(P,{children:"Memeriksa izin kamera..."})]})}),e.jsxs(G,{children:[e.jsx(_,{onClick:b,variant:"outlined",color:"inherit",children:"Cancel"}),n==="granted"&&e.jsx(_,{onClick:k,variant:"contained",children:"Capture"})]})]})}function ot({url:c,name:h,index:v,remove:m,fileObj:n,setValue:i,extention:a,pictureFields:o}){const{disabledAllInput:f}=E(),{openPicture:k}=ke(),b=D(!0),[p,u]=w.useState(0),[d,t]=w.useState(""),[r,l]=w.useState(`${L.site.basePath}/assets/icons/files/ic-folder.svg`),s=async()=>{if(n!==null){l(URL.createObjectURL(n));const{name:x,size:g}=Y(n);t(x??""),u(g??0),b.onFalse()}else b.onTrue(),await Ue(c,h,`image/${a}`).then(x=>{l(URL.createObjectURL(x));const{name:g,size:j}=Y(x);t(g??""),u(j??0),o[v].fileObj=x,i("pictures",o)}).catch(()=>{}).finally(()=>{b.onFalse()})};return w.useEffect(()=>{s()},[n]),b.value?e.jsx(A,{variant:"rounded",sx:{width:"100%",height:60}}):e.jsxs(U,{component:"li",sx:{py:1,pr:1,pl:1.5,gap:1.5,display:"flex",borderRadius:1,alignItems:"center",border:x=>`solid 1px ${q(x.vars.palette.grey["500Channel"],.16)}`},children:[e.jsx(S,{component:"span",className:X.root,sx:{width:36,height:36,flexShrink:0,borderRadius:1.25,alignItems:"center",position:"relative",display:"inline-flex",justifyContent:"center"},children:e.jsx(U,{src:r,component:"img",onClick:()=>k(r),className:X.icon,sx:{width:1,height:1,cursor:"pointer"}})}),e.jsx(we,{primary:d,secondary:We(p),secondaryTypographyProps:{component:"span",typography:"caption"}}),e.jsx(re,{size:"small",onClick:()=>m(v),disabled:f.value,children:e.jsx(V,{icon:"mingcute:close-line",width:16})})]})}function st(){const{showConfirmDialog:c}=ne(),{triggerRefresh:h,disabledAllInput:v}=E(),m=T(),{control:n,setValue:i,handleSubmit:a}=m,o=R({control:n,name:"need_confirmation"});R({control:n,name:"feedback_status"});const f=R({control:n,name:"survey_status"});w.useEffect(()=>{o==="0"&&i("confirmation_note","")},[o]);const k=async p=>{await ae(f,oe(p)).then(()=>{h()}).catch(u=>{u instanceof se&&Object.keys(u.validationErrors).forEach(d=>{m.setError(d,{type:"manual",message:u.validationErrors[d][0]})})})},b=async p=>{p.pictures?.message&&ie.warning(p.pictures?.message,{position:"top-center"})};return e.jsx(J,{sx:{p:3},children:e.jsxs(S,{spacing:5,children:[e.jsxs(S,{children:[e.jsx(P,{variant:"subtitle1",children:"Apakah item bermasalah?"}),e.jsx(He,{row:!0,label:"",sx:{pl:.2},name:"need_confirmation",disabled:v.value,options:[{value:"1",label:"Bermasalah"},{value:"0",label:"Tidak bermasalah"}]})]}),e.jsxs(S,{spacing:2,children:[e.jsx($,{rows:4,multiline:!0,label:"Notes",name:"confirmation_note",disabled:o==="0"&&f===M.normal||v.value}),e.jsx(ce,{caption:"Fill in the form above and correct it again correctly"})]}),e.jsx(S,{direction:"row",justifyContent:"end",children:e.jsx(_,{size:"medium",color:"error",variant:"outlined",onClick:()=>{c({title:"Request Confirmation",description:"Anda yakin? Pesan akan dikirim ke customer",confirmBtnText:"Request",onConfirm:a(k,b)})},disabled:o==="0"&&f===M.normal||v.value,children:"REQUEST CONFIRMATION"})})]})})}function ct(){const{openDialogEditProduct:c,disabledAllInput:h}=E(),v=T(),{getFieldState:m}=v;return e.jsxs(H,{open:c.value,fullWidth:!0,maxWidth:"sm",children:[e.jsx(B,{children:"Edit Product"}),e.jsx(N,{sx:{overflow:"visible"},children:e.jsx(U,{sx:{pt:1,overflowY:"auto",overflowX:"hidden",maxHeight:L.dialog.maxHeight},children:e.jsxs(O,{container:!0,spacing:3,children:[e.jsx(O,{xs:12,children:e.jsx(Be,{name:"remarks",label:"Remarks",disableCloseOnSelect:!0,disabled:h.value,getOptionLabel:n=>n.name,fetchFunction:async n=>(await Ge({keyword:n,page:1})).data,isOptionEqualToValue:(n,i)=>n.id===i.id})}),e.jsx(O,{xs:12,children:e.jsx(Z,{name:"brand",label:"Brand",debounceSearch:!0,disabled:h.value,getOptionLabel:n=>n?.name,isOptionEqualToValue:(n,i)=>n?.id===i?.id,fetchFunction:async n=>(await Ne({keyword:n,page:1})).data})}),e.jsx(O,{xs:12,children:e.jsx(Z,{name:"color",label:"Color",debounceSearch:!0,disabled:h.value,getOptionLabel:n=>n?.name,isOptionEqualToValue:(n,i)=>n?.id===i?.id,fetchFunction:async n=>(await $e({keyword:n,page:1})).data})})]})})}),e.jsxs(G,{children:[e.jsx(_,{onClick:c.onFalse,variant:"outlined",color:"inherit",children:"Cancel"}),e.jsx(_,{size:"medium",variant:"contained",onClick:c.onFalse,children:"Save"})]})]})}function dt(){const{showConfirmDialog:c}=ne(),{triggerRefresh:h}=E(),v=T(),{control:m,handleSubmit:n}=v,i=R({control:m,name:"need_confirmation"}),a=R({control:m,name:"feedback_status"}),o=R({control:m,name:"survey_status"}),f=async p=>{await ae(o,oe(p)).then(()=>{h()}).catch(u=>{u instanceof se&&Object.keys(u.validationErrors).forEach(d=>{v.setError(d,{type:"manual",message:u.validationErrors[d][0]})})})},k=async p=>{p.pictures?.message&&ie.warning(p.pictures?.message,{position:"top-center"})},b=p=>{c({title:p==="process"?"Process Production":"Reject Item",description:`Anda yakin? ${p==="process"?"Proses akan dilanjutkan ke production":"Item tidak akan dilanjutkan ke production"}`,confirmBtnText:p==="process"?"Process":"Reject",onConfirm:n(f,k)})};return e.jsx(Ve,{heading:"Product Survey Upload",links:[{name:"Survey",href:"#"},{name:"Product Survey",href:te.dashboard.survey.product_survey},{name:"Upload",href:"#"}],action:o===M.normal||a===M.approved&&o===M.need_confirmation?e.jsx(_,{size:"medium",variant:"contained",onClick:()=>b("process"),disabled:o===M.normal&&i==="1",children:"PROCESS PRODUCTION"}):a===M.rejected&&o===M.need_confirmation?e.jsx(_,{size:"medium",color:"error",variant:"contained",onClick:()=>b("reject"),children:"REJECT ITEM"}):e.jsx(e.Fragment,{})})}function lt(){const{productSurveyDetail:c}=E(),h=Pe({resolver:Fe(Ie),defaultValues:Oe}),{reset:v}=h;return w.useEffect(()=>{if(c!==null){const m=Re(c);v(m)}},[c]),e.jsxs(_e,{methods:h,children:[e.jsxs(S,{spacing:3,children:[e.jsx(dt,{}),e.jsx(Qe,{}),e.jsx(Ye,{}),e.jsx(nt,{}),e.jsx(st,{})]}),e.jsx(ct,{})]})}function ut(){const{order_product_id:c=""}=ze(),{refreshFlag:h,productSurveyDetailSet:v}=E(),m=D(!1),n=D(!1),i=async a=>{m.onTrue(),await De(a).then(o=>{v(o)}).catch(o=>{o instanceof Ae&&n.onTrue()}).finally(()=>{m.onFalse()})};return w.useEffect(()=>{c!==""&&i(c)},[c]),w.useEffect(()=>{h>0&&i(c)},[h]),e.jsx(e.Fragment,{children:m.value?e.jsx(Je,{}):e.jsx(e.Fragment,{children:n.value?e.jsx(Ke,{}):e.jsx(lt,{})})})}const ht={title:`Survey - Product Survey Upload - ${L.site.name}`};function It(){return e.jsxs(e.Fragment,{children:[e.jsx(Me,{children:e.jsxs("title",{children:[" ",ht.title]})}),e.jsx(Ee,{maxWidth:"xl",children:e.jsx(Te,{children:e.jsx(ut,{})})})]})}export{It as default};
