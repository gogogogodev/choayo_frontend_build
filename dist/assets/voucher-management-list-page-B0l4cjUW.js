import{d as P,k as e,ag as V,p as C,R as A,n as x,c as I,cP as R,cD as E,aI as b,aC as B,ii as i,m as F,cQ as _,cd as L,cc as v,g as Y,t as H,r as d,S as N,F as O,ay as $,I as z,aw as q,az as Q,H as W,C as G,aE as K}from"./index-DL1FC2Xw.js";import{u as p,T as U,a as J,P as X}from"./schemas-CbUv6Rrn.js";import{C as Z}from"./custom-breadcrumbs-nJImJlyu.js";import{T as ee}from"./table-pagination-custom-D4L-eNU7.js";import{v as ae,a as te,b as se}from"./functions-wDwdqj4f.js";import{b as g,c as ne,a as oe,T as ie}from"./TableRow-Dnp-F93Q.js";import{T as r}from"./TableCell--CDe426o.js";import{C as re}from"./Card-x9v4l8Wx.js";import"./TablePagination-Cu0e8Dmj.js";import"./LastPage-CNSkhtZT.js";import"./FormControlLabel-RF8C1zCS.js";import"./errors-wZ747Yys.js";function ce(){const{checkAbilities:t}=P();return e.jsx(Z,{heading:"Voucher Management",links:[{name:"Others",href:"#"},{name:"Voucher Management",href:"#"}],action:t?.("voucher-management:create")&&e.jsx(V,{size:"medium",variant:"contained",component:A,href:C.dashboard.others.voucher_management.form("new"),startIcon:e.jsx(x,{icon:"mingcute:add-line"}),children:"New Voucher"}),sx:{mb:{xs:3,md:5}}})}function le({no:t,row:a}){const c=I(),s=R(),{showConfirmDialog:n}=E(),{checkAbilities:o,checkAbilitiesMultiple:h}=P(),{triggerRefresh:m}=p(),l=()=>{n({title:a.status===i.inactive?"Activate voucher":"Inactivate Voucher",description:`Anda yakin? Data akan ${a.status===i.inactive?"diaktifkan":"dinon-aktifkan."}`,confirmBtnText:"Confirm",onConfirm:async()=>{a.status===i.inactive?await ae(a.id):await te(a.id),m()}})};return e.jsxs(g,{hover:!0,children:[e.jsx(r,{sx:{whiteSpace:"nowrap"},children:a.code}),e.jsx(r,{sx:{whiteSpace:"nowrap"},children:a.name}),e.jsx(r,{sx:{whiteSpace:"nowrap"},children:`${b(Number(a.start_at),"DD/MM/YYYY")} - ${b(Number(a.end_at),"DD/MM/YYYY")}`}),e.jsx(r,{sx:{whiteSpace:"nowrap"},children:a.qty}),e.jsx(r,{sx:{whiteSpace:"nowrap"},children:a.usage??"0"}),e.jsx(r,{sx:{whiteSpace:"nowrap"},children:e.jsx(B,{variant:"soft",color:a.status===i.active&&"success"||a.status===i.inactive&&"warning"||a.status===i.expired&&"error"||"default",children:a.status})}),e.jsxs(r,{sx:{whiteSpace:"nowrap"},align:"right",children:[h?.(["voucher-management:delete","voucher-management:activate","voucher-management:edit"])&&e.jsx(F,{color:s.open?"inherit":"default",onClick:s.onOpen,children:e.jsx(x,{icon:"eva:more-vertical-fill"})}),e.jsx(_,{open:s.open,anchorEl:s.anchorEl,onClose:s.onClose,slotProps:{arrow:{placement:"right-top"}},children:e.jsxs(L,{children:[o?.("voucher-management:activate")&&e.jsxs(v,{onClick:()=>{s.onClose(),l()},sx:{color:a.status===i.inactive?"info.main":"error.main"},children:[e.jsx(x,{icon:a.status===i.inactive?"solar:lock-unlocked-bold":"solar:lock-bold"}),a.status===i.inactive?"Activate":"In-Active"]}),o?.("voucher-management:edit")&&e.jsxs(v,{disabled:a.status===i.inactive,onClick:()=>{s.onClose(),c.push(`${C.dashboard.others.voucher_management.form(a.id)}`)},children:[e.jsx(x,{icon:"solar:pen-bold"}),"Edit"]})]})})]})]})}function w({text:t}){return e.jsx(g,{hover:!0,children:e.jsx(r,{sx:{whiteSpace:"nowrap"},align:"center",colSpan:7,children:t})})}function de({rows:t,status:a}){const{page:c,rowsPerPage:s}=p();return e.jsx(ne,{children:a==="loading"?e.jsx(w,{text:"Loading .."}):t.length===0?e.jsx(w,{text:"Data not found"}):t.map((n,o)=>e.jsx(le,{row:n,no:(c-1)*s+o+1},n.id))})}function ue(){const t=[{id:"code",label:"Code",width:100},{id:"name",label:"Name",width:100},{id:"period",label:"Period",width:100},{id:"quota",label:"Quota",width:100},{id:"quota_used",label:"Quota Used",width:100},{id:"status",label:"Status",width:100},{id:"",width:10}];return e.jsx(oe,{children:e.jsx(g,{children:t.map(a=>e.jsx(r,{align:a.align||"left",sortDirection:!1,sx:{width:a.width,minWidth:0},children:a.label},a.id))})})}function he(){const{keyword:t,updateKeyword:a}=p(),c=Y({resolver:H(J),defaultValues:U}),{watch:s,reset:n,handleSubmit:o}=c;d.useEffect(()=>{n({keyword:t})},[t,n]);const h=s();d.useEffect(()=>{const l=setTimeout(()=>{h.keyword===""&&a("")},300);return()=>clearTimeout(l)},[h.keyword,a]);const m=async l=>{a(l.keyword)};return e.jsx(N,{sx:{p:2.5},children:e.jsx(O,{methods:c,onSubmit:o(m),children:e.jsx($,{size:"medium",name:"keyword",tooltipTitle:"press enter",placeholder:"Search voucher...",InputProps:{startAdornment:e.jsx(z,{position:"start",children:e.jsx(x,{icon:"eva:search-fill",sx:{color:"text.disabled"}})})}})})})}function me(){const{keyword:t,refreshFlag:a,updatePage:c,updateRowsPerPage:s}=p(),[n,o]=d.useState(0),[h,m]=d.useState(0),[l,S]=d.useState(15),[T,k]=d.useState([]),[y,f]=d.useState(!1);d.useEffect(()=>{(async()=>(f(!0),await se({keyword:t,page:n+1}).then(u=>{k(u.data),m(u.total),o(u.current_page-1),S(u.per_page),c(u.current_page),s(l)}).finally(()=>{f(!1)})))()},[t,a,n,l]);const M=(j,u)=>{o(u)},D=j=>{o(0)};return e.jsxs(re,{children:[e.jsx(he,{}),e.jsx(q,{sx:{position:"relative"},children:e.jsx(Q,{children:e.jsxs(ie,{size:"medium",sx:{minWidth:0},children:[e.jsx(ue,{}),e.jsx(de,{rows:T,status:y?"loading":"finish"})]})})}),e.jsx(ee,{dense:!1,page:n,count:h,rowsPerPage:15,rowsPerPageOptions:[15,25,100],onPageChange:M,onRowsPerPageChange:D})]})}const xe={title:`Others - Voucher Management - ${G.site.name}`};function ye(){return e.jsxs(e.Fragment,{children:[e.jsx(W,{children:e.jsxs("title",{children:[" ",xe.title]})}),e.jsx(K,{maxWidth:"xl",children:e.jsxs(X,{children:[e.jsx(ce,{}),e.jsx(me,{})]})})]})}export{ye as default};
