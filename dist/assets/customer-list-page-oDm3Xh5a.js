import{d as C,k as e,ag as k,n as h,g as D,t as F,r as n,S as B,F as E,ay as L,I,cP as R,cD as A,m as H,cQ as M,cd as N,cc as g,aw as O,az as _,H as z,C as V,aE as G}from"./index-DL1FC2Xw.js";import{u as p,P as W,C as K}from"./customer-form-DbQeUIrb.js";import{C as Q}from"./custom-breadcrumbs-nJImJlyu.js";import{T as $}from"./table-pagination-custom-D4L-eNU7.js";import{T as q,b as J}from"./schemas-CENM9CnB.js";import{a as U,b as x,c as X,T as Y}from"./TableRow-Dnp-F93Q.js";import{T as i}from"./TableCell--CDe426o.js";import{T as Z}from"./text-divider-CeTsOEqe.js";import{e as ee,C as te}from"./functions-BoFIsn5X.js";import{C as se}from"./Card-x9v4l8Wx.js";import"./errors-wZ747Yys.js";import"./divider-oAQn-qZp.js";import"./rhf-autocomplete-on-enter-kdiwxQrI.js";import"./rhf-radio-group-c3xmrwMe.js";import"./RadioGroup-DjJiUtpj.js";import"./FormGroup-dr7_GDnD.js";import"./FormControlLabel-RF8C1zCS.js";import"./rhf-date-picker-CcRSy6lj.js";import"./DatePicker-x3rEWLr9.js";import"./ListItem-ByRhTH_M.js";import"./MobileDateTimePicker-DRzd3izO.js";import"./form-caption-DFg98poz.js";import"./TablePagination-Cu0e8Dmj.js";import"./LastPage-CNSkhtZT.js";function oe(){const{checkAbilities:s}=C(),{isDialogFormOpen:t}=p();return e.jsx(Q,{heading:"Customer List",links:[{name:"Customer",href:"#"},{name:"Customer List",href:"#"}],action:s?.("customer-list:create")&&e.jsx(k,{size:"medium",variant:"contained",onClick:t.onTrue,startIcon:e.jsx(h,{icon:"mingcute:add-line"}),children:"New Customer"}),sx:{mb:{xs:3,md:5}}})}function re(){const{keyword:s,updateKeyword:t}=p(),o=D({resolver:F(J),defaultValues:q}),{watch:l,reset:r,handleSubmit:a}=o;n.useEffect(()=>{r({keyword:s})},[s,r]);const m=l();n.useEffect(()=>{const c=setTimeout(()=>{m.keyword===""&&t("")},300);return()=>clearTimeout(c)},[m.keyword,t]);const u=async c=>{t(c.keyword)};return e.jsx(B,{sx:{p:2.5},children:e.jsx(E,{methods:o,onSubmit:a(u),children:e.jsx(L,{size:"medium",name:"keyword",tooltipTitle:"press enter",placeholder:"Search store...",InputProps:{startAdornment:e.jsx(I,{position:"start",children:e.jsx(h,{icon:"eva:search-fill",sx:{color:"text.disabled"}})})}})})})}function ae(){const s=[{id:"no",label:"No",width:10},{id:"name",label:"Name",width:100},{id:"gender",label:"Gender",width:100},{id:"phone",label:"No. Phone",width:100},{id:"customer_level",label:"Customer Level",width:100},{id:"",width:10}];return e.jsx(U,{children:e.jsx(x,{children:s.map(t=>e.jsx(i,{align:t.align||"left",sortDirection:!1,sx:{width:t.width,minWidth:0},children:t.label},t.id))})})}function ne({no:s,row:t}){const o=R(),{showConfirmDialog:l}=A(),{checkAbilities:r,checkAbilitiesMultiple:a}=C(),{isDialogFormOpen:m,updateCustomerFormValues:u,triggerRefresh:c}=p();return e.jsxs(x,{hover:!0,children:[e.jsx(i,{sx:{whiteSpace:"nowrap"},children:s}),e.jsx(i,{sx:{whiteSpace:"nowrap"},children:e.jsx(Z,{type:"normal",disableDivider:!0,upperText:t.name,lowerText:t.email,lowerTextProps:{variant:"caption",color:"text.disabled"}})}),e.jsx(i,{sx:{whiteSpace:"nowrap"},children:t.gender=="M"?"Male":"Female"}),e.jsx(i,{sx:{whiteSpace:"nowrap"},children:t.phone}),e.jsx(i,{sx:{whiteSpace:"nowrap"},children:t.level?.name??"-"}),e.jsxs(i,{sx:{whiteSpace:"nowrap"},align:"right",children:[a?.(["customer-list:delete","customer-list:edit"])&&e.jsx(H,{color:o.open?"inherit":"default",onClick:o.onOpen,children:e.jsx(h,{icon:"eva:more-vertical-fill"})}),e.jsx(M,{open:o.open,anchorEl:o.anchorEl,onClose:o.onClose,slotProps:{arrow:{placement:"right-top"}},children:e.jsxs(N,{children:[r?.("customer-list:delete")&&e.jsxs(g,{onClick:()=>{o.onClose(),l({title:"Delete Customer",description:"Anda yakin? Data akan dihapus permanent.",confirmBtnText:"Delete",onConfirm:async()=>{await ee(t.id),c()}})},sx:{color:"error.main"},children:[e.jsx(h,{icon:"solar:trash-bin-trash-bold"}),"Delete"]}),r?.("customer-list:edit")&&e.jsxs(g,{onClick:()=>{o.onClose(),m.onTrue(),u(t)},children:[e.jsx(h,{icon:"solar:pen-bold"}),"Edit"]})]})})]})]})}function j({text:s}){return e.jsx(x,{hover:!0,children:e.jsx(i,{sx:{whiteSpace:"nowrap"},align:"center",colSpan:6,children:s})})}function ie({rows:s,status:t}){const{page:o,rowsPerPage:l}=p();return e.jsx(X,{children:t==="loading"?e.jsx(j,{text:"loading .."}):s.length===0?e.jsx(j,{text:"data not found"}):s.map((r,a)=>e.jsx(ne,{row:r,no:(o-1)*l+a+1},r.id))})}function le(){const{keyword:s,refreshFlag:t,updatePage:o,updateRowsPerPage:l}=p(),[r,a]=n.useState(0),[m,u]=n.useState(0),[c,me]=n.useState(15),[w,b]=n.useState([]),[P,f]=n.useState(!1),T=async()=>{f(!0),await te({keyword:s,page:r+1}).then(d=>{b(d.data),u(d.total),a(d.current_page-1),o(d.current_page),l(c)}).finally(()=>{f(!1)})};n.useEffect(()=>{T()},[s,t,r]);const S=(d,y)=>{a(y)},v=d=>{a(0)};return e.jsxs(se,{children:[e.jsx(re,{}),e.jsx(O,{sx:{position:"relative"},children:e.jsx(_,{children:e.jsxs(Y,{size:"medium",sx:{minWidth:0},children:[e.jsx(ae,{}),e.jsx(ie,{rows:w,status:P?"loading":"finish"})]})})}),e.jsx($,{dense:!1,page:r,count:m,rowsPerPage:15,rowsPerPageOptions:[15,25,100],onPageChange:S,onRowsPerPageChange:v})]})}const ce={title:`Customer - Customer List - ${V.site.name}`};function Ae(){return e.jsxs(e.Fragment,{children:[e.jsx(z,{children:e.jsxs("title",{children:[" ",ce.title]})}),e.jsx(G,{maxWidth:"xl",children:e.jsxs(W,{children:[e.jsx(oe,{}),e.jsx(le,{}),e.jsx(K,{})]})})]})}export{Ae as default};
