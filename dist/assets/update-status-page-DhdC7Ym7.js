import{f as g,r as u,k as t,a as b,e as C,c6 as U,dj as k,c8 as D,aw as x,C as P,bZ as E,ag as w,iw as F,S as y,az as L,cP as $,l as m,c3 as H,aD as j,bI as O,n as I,aB as f,cQ as Q,cd as V,iY as z,cc as A,aF as c,ax as G,cx as M,cy as v,cz as S,cA as W,H as N,aE as Y}from"./index-CtazL8yi.js";import{C as q}from"./custom-breadcrumbs-DCKI5EoT.js";import{k as X}from"./index.esm-DjO86LYU.js";import{C as Z}from"./errors-wZ747Yys.js";import{T as J}from"./table-body-rowinfo-DLz3YlKp.js";import{P as K}from"./product-icon-p7JDWIR-.js";import{C as tt}from"./Card-DTCuhoee.js";import{T as et,a as at,b as _,c as nt}from"./TableRow-CfQY8bjO.js";import{T as i}from"./TableCell-DPzIV_vu.js";import{S as h}from"./Skeleton-fN5wJ-1g.js";const T=u.createContext(void 0),p=()=>{const a=u.useContext(T);if(a===void 0)throw new Error("useContextPage must be used within a PageContext.Provider");return a},st=({children:a})=>{const e=g(),s=g(),[o,l]=u.useState(null),d=r=>{l(r)},n=u.useMemo(()=>({openDialogQR:e,loadingProductionItem:s,valueProductionItem:o,updateValueProductionItem:d}),[e,s,o]);return t.jsx(T.Provider,{value:n,children:a})};function rt(){return t.jsx(q,{heading:"Update Status",links:[{name:"Production",href:"#"},{name:"Update Status",href:"#"}],sx:{mb:{xs:3,md:5}}})}const ot=async a=>{try{return(await b.get(`${C.transaction.order.product_one}/${a}`)).data.data}catch(e){throw console.error("ProductionItemGetOne - error : ",e),new Error("unexpected error occurred")}},it=async a=>{try{await b.post(`${C.transaction.order.product_status}/${a.id}?_method=PUT`,a)}catch(e){throw e.status===422?e.data&&e.data.errors?new Z(e.data.errors):e:(console.error("ProductionItemUpdateLaundryStatus - error : ",e),new Error("Oops, an error occurred while saving data!"))}};function dt(){const{openDialogQR:a,loadingProductionItem:e,updateValueProductionItem:s}=p(),o=g(!1),l=async r=>{e.onTrue(),await F(2e3),await ot(r).then(B=>{s(B)}).finally(()=>{e.onFalse(),o.onFalse()})},d=()=>{a.onFalse()},n=async r=>{console.log(r),r.length>0&&(o.onTrue(),l(r[0].rawValue),d())};return t.jsxs(U,{open:a.value,fullWidth:!0,maxWidth:"sm",children:[t.jsx(k,{children:"Scan QR"}),t.jsx(D,{sx:{overflow:"visible"},children:t.jsx(x,{sx:{pt:1,overflowY:"auto",overflowX:"hidden",maxHeight:P.dialog.maxHeight},children:t.jsx(X,{allowMultiple:!0,paused:o.value,onScan:r=>n(r)})})}),t.jsx(E,{children:t.jsx(w,{onClick:d,variant:"outlined",color:"inherit",children:"Cancel"})})]})}function lt(){const{valueProductionItem:a,updateValueProductionItem:e}=p();return t.jsxs(y,{spacing:2,alignItems:"end",children:[t.jsx(tt,{sx:{width:"100%"},children:t.jsx(x,{sx:{position:"relative"},children:t.jsx(L,{children:t.jsxs(et,{size:"medium",sx:{minWidth:0},children:[t.jsx(ct,{}),t.jsx(ut,{rows:[a]})]})})})}),t.jsx(w,{size:"medium",variant:"outlined",disabled:a===null,onClick:()=>{e(null)},children:"Clear"})]})}const R=[{id:"no",label:"No",width:"5%"},{id:"product",label:"Product",width:"25%"},{id:"status",label:"Status",width:"10%"},{id:"remark",label:"Remark",width:""},{id:"addons",label:"Add-Ons",width:""},{id:"notes",label:"Notes",width:""}];function ct(){return t.jsx(at,{children:t.jsx(_,{children:R.map(a=>t.jsx(i,{align:a.align||"left",sortDirection:!1,sx:{width:a.width,minWidth:0},children:a.label},a.id))})})}function ut({rows:a}){return t.jsx(nt,{children:a.length==0?t.jsx(J,{colspan:R.length,text:"data not found"}):a.map((e,s)=>t.jsx(xt,{row:e,no:s+1},s))})}function xt({no:a,row:e}){const s=$(),[o,l]=u.useState(e.laundry_status),d=async n=>{s.onClose(),l(n),await it({id:e.id,laundry_status:n,note:j(n)}).then(()=>{}).finally(()=>{})};return t.jsxs(t.Fragment,{children:[t.jsxs(_,{hover:!0,children:[t.jsx(i,{sx:{whiteSpace:"nowrap"},children:a}),t.jsxs(i,{sx:{whiteSpace:"nowrap",display:"flex"},children:[t.jsx(K,{icon_name:"",sx:{width:64,height:64}}),t.jsxs(x,{sx:{ml:2},children:[t.jsx(m,{variant:"subtitle2",gutterBottom:!0,children:e.name}),t.jsx(m,{variant:"body2",gutterBottom:!0,children:e.order_product_detail.brand_name!==""?e.order_product_detail.brand_name:"-"}),t.jsx(m,{variant:"body2",gutterBottom:!0,children:e.order_product_detail.color_name!==""?e.order_product_detail.color_name:"-"})]})]}),t.jsx(i,{sx:{whiteSpace:"nowrap"},children:t.jsxs(H,{onClick:s.onOpen,sx:{pr:1,pl:1.5,gap:1.5,height:34,borderRadius:1,typography:"subtitle2",border:n=>`solid 1px ${O(n.vars.palette.grey["500Channel"],.24)}`},children:[j(o),t.jsx(I,{width:16,icon:"carbon:chevron-sort",sx:{color:"text.disabled"}})]})}),t.jsx(i,{sx:{whiteSpace:"nowrap"},children:e.order_product_detail.remarks.map(n=>`${f(n.name)}`).join(", ")}),t.jsx(i,{sx:{whiteSpace:"nowrap"},children:e.order_product_detail.addons.map(n=>`${f(n.name)}`).join(", ")}),t.jsx(i,{sx:{whiteSpace:"nowrap"},children:e.order_product_detail.notes!==""?e.order_product_detail.notes:"-"})]}),t.jsx(Q,{open:s.open,onClose:s.onClose,anchorEl:s.anchorEl,slotProps:{arrow:{placement:"top-right"}},children:t.jsx(V,{children:Object.values(z).map((n,r)=>t.jsx(A,{selected:n===o,onClick:()=>d(n),children:t.jsx(x,{component:"span",sx:{flexGrow:1},children:j(n)})},r))})})]})}function ht(){return t.jsxs(c,{container:!0,spacing:2,children:[t.jsx(c,{xs:2,children:t.jsx(h,{variant:"rounded",sx:{width:"100%",height:30}})}),t.jsx(c,{xs:10,children:t.jsx(h,{variant:"rounded",sx:{width:"100%",height:30}})}),t.jsx(c,{xs:2,children:t.jsx(h,{variant:"rounded",sx:{width:"100%",height:60}})}),t.jsx(c,{xs:10,children:t.jsx(h,{variant:"rounded",sx:{width:"100%",height:60}})})]})}function mt(){const{openDialogQR:a}=p();return t.jsx(G,{component:M,children:t.jsxs(x,{sx:{display:"flex",flexDirection:"column",alignItems:"center"},children:[t.jsx(v.div,{variants:S().in,children:t.jsx(W,{sx:{mt:{xs:5,sm:10},mb:{xs:3,sm:8}}})}),t.jsx(v.div,{variants:S().in,children:t.jsxs(y,{spacing:2,alignItems:"center",children:[t.jsx(m,{variant:"h5",sx:{color:"text.secondary"},children:"Scan QR Code!"}),t.jsx(w,{size:"medium",variant:"contained",onClick:a.onTrue,startIcon:t.jsx(I,{icon:"streamline-sharp:qr-code"}),children:"Scan"})]})})]})})}function pt(){const{loadingProductionItem:a,valueProductionItem:e}=p();return a.value?t.jsx(ht,{}):e===null?t.jsx(mt,{}):t.jsx(lt,{})}const jt={title:`Production - Update Status - ${P.site.name}`};function _t(){return t.jsxs(t.Fragment,{children:[t.jsx(N,{children:t.jsxs("title",{children:[" ",jt.title]})}),t.jsx(Y,{maxWidth:"xl",children:t.jsxs(st,{children:[t.jsx(rt,{}),t.jsx(dt,{}),t.jsx(pt,{})]})})]})}export{_t as default};
