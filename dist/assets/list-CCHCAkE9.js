import{cP as U,k as e,S as v,n as m,aw as g,bK as E,ci as Q,aK as Y,L as X,p as y,R as N,ft as V,m as O,cQ as _,cd as $,cc as T,c as z,r as c,ag as L,bB as H,f$ as Z,g0 as ee,aL as I,l as C,bE as K,I as te,g1 as se,fJ as ae,dg as ne,dl as B,as as oe,bC as k,aY as re,dH as ie,az as le,f as ce,f6 as G,fv as de,gi as A,gf as he,gj as pe,gk as xe,aE as me,cR as P,fx as ue,H as ge,C as be}from"./index-CtazL8yi.js";import{E as je}from"./empty-content-oGcGfW-8.js";import{C as ve}from"./custom-breadcrumbs-DCKI5EoT.js";import{f as W}from"./format-number-CSJE7oq6.js";import{C as ye}from"./Card-DTCuhoee.js";import{P as fe,p as Ce}from"./Pagination-CnuA30AE.js";import{C as Se}from"./country-select-Bwa-rR0D.js";import{D as q}from"./DatePicker-BqHCM0PQ.js";import{F as ke}from"./FormControlLabel-DFxx6sAy.js";import{F as De,a as D,c as w}from"./filters-result-CqTcT7At.js";import"./tour-new-edit-form-CLaXRMHW.js";import"./html-to-markdown-BlmqjLf8.js";import"./LastPage-BNGOmTNl.js";import"./ListItem-D6s2wHyy.js";import"./fields-DtpCY2Ze.js";import"./Rating-CF8Alnys.js";import"./visuallyHidden-Dan1xhjv.js";import"./Slider-DYRFC88j.js";import"./rhf-radio-group-DX9-_-9m.js";import"./RadioGroup-rk33BBJn.js";import"./FormGroup-3I9bsZvK.js";import"./rhf-switch-DjhXwtDK.js";import"./rhf-checkbox-ClXqBOLt.js";import"./rhf-upload-C3OgFPC3.js";import"./upload-B6rOCRw-.js";import"./index-Cwjez_Mi.js";import"./placeholder-CbRedPRL.js";import"./preview-multi-file-DIDrQBye.js";import"./upload-avatar-CfvSEq0I.js";import"./rhf-date-picker-2a_P4JNL.js";import"./MobileDateTimePicker-Cmz-Um3i.js";import"./schema-helper-BI0i4TVU.js";import"./CardHeader-DR90Oglq.js";function we({tour:t,onView:d,onEdit:h,onDelete:s}){const n=U(),r=e.jsxs(v,{direction:"row",alignItems:"center",sx:{top:8,right:8,zIndex:9,borderRadius:1,position:"absolute",p:"2px 6px 2px 4px",typography:"subtitle2",bgcolor:"warning.lighter"},children:[e.jsx(m,{icon:"eva:star-fill",sx:{color:"warning.main",mr:.25}})," ",t.ratingNumber]}),o=e.jsxs(v,{direction:"row",alignItems:"center",sx:{top:8,left:8,zIndex:9,borderRadius:1,bgcolor:"grey.800",position:"absolute",p:"2px 6px 2px 4px",color:"common.white",typography:"subtitle2"},children:[!!t.priceSale&&e.jsx(g,{component:"span",sx:{color:"grey.500",mr:.25,textDecoration:"line-through"},children:W(t.priceSale)}),W(t.price)]}),a=e.jsxs(g,{gap:.5,display:"flex",sx:{p:1},children:[e.jsxs(g,{flexGrow:1,sx:{position:"relative"},children:[o,r,e.jsx(E,{alt:t.images[0],src:t.images[0],sx:{width:1,height:164,borderRadius:1}})]}),e.jsxs(g,{gap:.5,display:"flex",flexDirection:"column",children:[e.jsx(E,{alt:t.images[1],src:t.images[1],ratio:"1/1",sx:{borderRadius:1,width:80,height:80}}),e.jsx(E,{alt:t.images[2],src:t.images[2],ratio:"1/1",sx:{borderRadius:1,width:80,height:80}})]})]}),p=e.jsx(Q,{sx:{p:l=>l.spacing(2.5,2.5,2,2.5)},primary:`Posted date: ${Y(t.createdAt)}`,secondary:e.jsx(X,{component:N,href:y.dashboard.tour.details(t.id),color:"inherit",children:t.name}),primaryTypographyProps:{typography:"caption",color:"text.disabled"},secondaryTypographyProps:{mt:1,noWrap:!0,component:"span",color:"text.primary",typography:"subtitle1"}}),x=e.jsxs(v,{spacing:1.5,sx:{position:"relative",p:l=>l.spacing(0,2.5,2.5,2.5)},children:[e.jsx(O,{onClick:n.onOpen,sx:{position:"absolute",bottom:20,right:8},children:e.jsx(m,{icon:"eva:more-vertical-fill"})}),[{icon:e.jsx(m,{icon:"mingcute:location-fill",sx:{color:"error.main"}}),label:t.destination},{icon:e.jsx(m,{icon:"solar:clock-circle-bold",sx:{color:"info.main"}}),label:V(t.available.startDate,t.available.endDate)},{icon:e.jsx(m,{icon:"solar:users-group-rounded-bold",sx:{color:"primary.main"}}),label:`${t.bookers.length} Booked`}].map(l=>e.jsxs(v,{spacing:1,direction:"row",alignItems:"center",sx:{typography:"body2"},children:[l.icon,l.label]},l.label))]});return e.jsxs(e.Fragment,{children:[e.jsxs(ye,{children:[a,p,x]}),e.jsx(_,{open:n.open,anchorEl:n.anchorEl,onClose:n.onClose,slotProps:{arrow:{placement:"right-top"}},children:e.jsxs($,{children:[e.jsxs(T,{onClick:()=>{n.onClose(),d()},children:[e.jsx(m,{icon:"solar:eye-bold"}),"View"]}),e.jsxs(T,{onClick:()=>{n.onClose(),h()},children:[e.jsx(m,{icon:"solar:pen-bold"}),"Edit"]}),e.jsxs(T,{onClick:()=>{n.onClose(),s()},sx:{color:"error.main"},children:[e.jsx(m,{icon:"solar:trash-bin-trash-bold"}),"Delete"]})]})})]})}function Te({tours:t}){const d=z(),h=c.useCallback(r=>{d.push(y.dashboard.tour.details(r))},[d]),s=c.useCallback(r=>{d.push(y.dashboard.tour.edit(r))},[d]),n=c.useCallback(r=>{console.info("DELETE",r)},[]);return e.jsxs(e.Fragment,{children:[e.jsx(g,{gap:3,display:"grid",gridTemplateColumns:{xs:"repeat(1, 1fr)",sm:"repeat(2, 1fr)",md:"repeat(3, 1fr)"},children:t.map(r=>e.jsx(we,{tour:r,onView:()=>h(r.id),onEdit:()=>s(r.id),onDelete:()=>n(r.id)},r.id))}),t.length>8&&e.jsx(fe,{count:8,sx:{mt:{xs:5,md:8},[`& .${Ce.ul}`]:{justifyContent:"center"}}})]})}function Ie({sort:t,onSort:d,sortOptions:h}){const s=U();return e.jsxs(e.Fragment,{children:[e.jsxs(L,{disableRipple:!0,color:"inherit",onClick:s.onOpen,endIcon:e.jsx(m,{icon:s.open?"eva:arrow-ios-upward-fill":"eva:arrow-ios-downward-fill"}),sx:{fontWeight:"fontWeightSemiBold"},children:["Sort by:",e.jsx(g,{component:"span",sx:{ml:.5,fontWeight:"fontWeightBold",textTransform:"capitalize"},children:t})]}),e.jsx(_,{open:s.open,anchorEl:s.anchorEl,onClose:s.onClose,children:e.jsx($,{children:h.map(n=>e.jsx(T,{selected:n.value===t,onClick:()=>{s.onClose(),d(n.value)},children:n.label},n.value))})})]})}function Re({search:t,onSearch:d}){const h=z(),{state:s}=t,n=o=>{h.push(y.dashboard.tour.details(o))},r=o=>{if(s.query&&o.key==="Enter"){const a=s.results.filter(p=>p.name===s.query)[0];n(a.id)}};return e.jsx(H,{sx:{width:{xs:1,sm:260}},autoHighlight:!0,popupIcon:null,options:s.results,onInputChange:(o,a)=>d(a),getOptionLabel:o=>o.name,noOptionsText:e.jsx(ae,{query:s.query}),isOptionEqualToValue:(o,a)=>o.id===a.id,slotProps:{popper:{placement:"bottom-start",sx:{minWidth:320}},paper:{sx:{[` .${se.option}`]:{pl:.75}}}},renderInput:o=>e.jsx(K,{...o,placeholder:"Search...",onKeyUp:r,InputProps:{...o.InputProps,startAdornment:e.jsx(te,{position:"start",children:e.jsx(m,{icon:"eva:search-fill",sx:{ml:1,color:"text.disabled"}})})}}),renderOption:(o,a,{inputValue:p})=>{const x=Z(a.name,p),l=ee(a.name,x);return c.createElement(g,{component:"li",...o,onClick:()=>n(a.id),key:a.id},e.jsx(I,{alt:a.name,src:a.images[0],variant:"rounded",sx:{mr:1.5,width:48,height:48,flexShrink:0,borderRadius:1}},a.id),e.jsx("div",{children:l.map((b,S)=>e.jsx(C,{component:"span",color:b.highlight?"primary":"textPrimary",sx:{typography:"body2",fontWeight:b.highlight?"fontWeightSemiBold":"fontWeightMedium"},children:b.text},S))},p))}})}function Fe({open:t,onOpen:d,onClose:h,filters:s,options:n,canReset:r,dateError:o}){const a=c.useCallback(i=>{const u=s.state.services.includes(i)?s.state.services.filter(f=>f!==i):[...s.state.services,i];s.setState({services:u})},[s]),p=c.useCallback(i=>{s.setState({startDate:i})},[s]),x=c.useCallback(i=>{s.setState({endDate:i})},[s]),l=c.useCallback(i=>{s.setState({destination:i})},[s]),b=c.useCallback(i=>{s.setState({tourGuides:i})},[s]),S=e.jsxs(e.Fragment,{children:[e.jsxs(g,{display:"flex",alignItems:"center",sx:{py:2,pr:1,pl:2.5},children:[e.jsx(C,{variant:"h6",sx:{flexGrow:1},children:"Filters"}),e.jsx(ne,{title:"Reset",children:e.jsx(O,{onClick:s.onResetState,children:e.jsx(B,{color:"error",variant:"dot",invisible:!r,children:e.jsx(m,{icon:"solar:restart-bold"})})})}),e.jsx(O,{onClick:h,children:e.jsx(m,{icon:"mingcute:close-line"})})]}),e.jsx(oe,{sx:{borderStyle:"dashed"}})]}),j=e.jsxs(g,{display:"flex",flexDirection:"column",children:[e.jsx(C,{variant:"subtitle2",sx:{mb:1.5},children:"Durations"}),e.jsx(q,{label:"Start date",value:s.state.startDate,onChange:p,sx:{mb:2.5}}),e.jsx(q,{label:"End date",value:s.state.endDate,onChange:x,slotProps:{textField:{error:o,helperText:o?"End date must be later than start date":null}}})]}),R=e.jsxs(g,{display:"flex",flexDirection:"column",children:[e.jsx(C,{variant:"subtitle2",sx:{mb:1.5},children:"Destination"}),e.jsx(Se,{id:"multiple-destinations",multiple:!0,fullWidth:!0,placeholder:s.state.destination.length?"+ Destination":"Select Destination",value:s.state.destination,onChange:(i,u)=>l(u)})]}),F=e.jsxs(g,{display:"flex",flexDirection:"column",children:[e.jsx(C,{variant:"subtitle2",sx:{mb:1.5},children:"Tour guide"}),e.jsx(H,{multiple:!0,disableCloseOnSelect:!0,options:n.tourGuides,value:s.state.tourGuides,onChange:(i,u)=>b(u),getOptionLabel:i=>i.name,renderInput:i=>e.jsx(K,{placeholder:"Select Tour Guides",...i}),renderOption:(i,u)=>c.createElement("li",{...i,key:u.id},e.jsx(I,{alt:u.avatarUrl,src:u.avatarUrl,sx:{mr:1,width:24,height:24,flexShrink:0}},u.id),u.name),renderTags:(i,u)=>i.map((f,J)=>c.createElement(k,{...u({index:J}),key:f.id,size:"small",variant:"soft",label:f.name,avatar:e.jsx(I,{alt:f.name,src:f.avatarUrl})}))})]}),M=e.jsxs(g,{display:"flex",flexDirection:"column",children:[e.jsx(C,{variant:"subtitle2",sx:{mb:1},children:"Services"}),n.services.map(i=>e.jsx(ke,{control:e.jsx(re,{checked:s.state.services.includes(i),onClick:()=>a(i)}),label:i},i))]});return e.jsxs(e.Fragment,{children:[e.jsx(L,{disableRipple:!0,color:"inherit",endIcon:e.jsx(B,{color:"error",variant:"dot",invisible:!r,children:e.jsx(m,{icon:"ic:round-filter-list"})}),onClick:d,children:"Filters"}),e.jsxs(ie,{anchor:"right",open:t,onClose:h,slotProps:{backdrop:{invisible:!0}},PaperProps:{sx:{width:320}},children:[S,e.jsx(le,{sx:{px:2.5,py:3},children:e.jsxs(v,{spacing:3,children:[j,R,F,M]})})]})]})}function Ee({filters:t,totalResults:d,sx:h}){const s=c.useCallback(a=>{const p=t.state.services.filter(x=>x!==a);t.setState({services:p})},[t]),n=c.useCallback(()=>{t.setState({startDate:null,endDate:null})},[t]),r=c.useCallback(a=>{const p=t.state.tourGuides.filter(x=>x.name!==a.name);t.setState({tourGuides:p})},[t]),o=c.useCallback(a=>{const p=t.state.destination.filter(x=>x!==a);t.setState({destination:p})},[t]);return e.jsxs(De,{totalResults:d,onReset:t.onResetState,sx:h,children:[e.jsx(D,{label:"Available:",isShow:!!(t.state.startDate&&t.state.endDate),children:e.jsx(k,{...w,label:V(t.state.startDate,t.state.endDate),onDelete:n})}),e.jsx(D,{label:"Services:",isShow:!!t.state.services.length,children:t.state.services.map(a=>c.createElement(k,{...w,key:a,label:a,onDelete:()=>s(a)}))}),e.jsx(D,{label:"Tour guide:",isShow:!!t.state.tourGuides.length,children:t.state.tourGuides.map(a=>c.createElement(k,{...w,key:a.id,avatar:e.jsx(I,{alt:a.name,src:a.avatarUrl}),label:a.name,onDelete:()=>r(a)}))}),e.jsx(D,{label:"Destination:",isShow:!!t.state.destination.length,children:t.state.destination.map(a=>c.createElement(k,{...w,key:a,label:a,onDelete:()=>o(a)}))})]})}function Pe(){const t=ce(),[d,h]=c.useState("latest"),s=G({query:"",results:[]}),n=G({destination:[],tourGuides:[],services:[],startDate:null,endDate:null}),r=de(n.state.startDate,n.state.endDate),o=Oe({inputData:A,filters:n.state,sortBy:d,dateError:r}),a=n.state.destination.length>0||n.state.tourGuides.length>0||n.state.services.length>0||!!n.state.startDate&&!!n.state.endDate,p=!o.length&&a,x=c.useCallback(j=>{h(j)},[]),l=c.useCallback(j=>{if(s.setState({query:j}),j){const R=A.filter(F=>F.name.toLowerCase().indexOf(s.state.query.toLowerCase())!==-1);s.setState({results:R})}},[s]),b=e.jsxs(v,{spacing:3,justifyContent:"space-between",alignItems:{xs:"flex-end",sm:"center"},direction:{xs:"column",sm:"row"},children:[e.jsx(Re,{search:s,onSearch:l}),e.jsxs(v,{direction:"row",spacing:1,flexShrink:0,children:[e.jsx(Fe,{filters:n,canReset:a,dateError:r,open:t.value,onOpen:t.onTrue,onClose:t.onFalse,options:{tourGuides:pe,services:he.map(j=>j.label)}}),e.jsx(Ie,{sort:d,onSort:x,sortOptions:xe})]})]}),S=e.jsx(Ee,{filters:n,totalResults:o.length});return e.jsxs(me,{children:[e.jsx(ve,{heading:"List",links:[{name:"Dashboard",href:y.dashboard.root},{name:"Tour",href:y.dashboard.tour.root},{name:"List"}],action:e.jsx(L,{component:N,href:y.dashboard.tour.new,variant:"contained",startIcon:e.jsx(m,{icon:"mingcute:add-line"}),children:"New Tour"}),sx:{mb:{xs:3,md:5}}}),e.jsxs(v,{spacing:2.5,sx:{mb:{xs:3,md:5}},children:[b,a&&S]}),p&&e.jsx(je,{filled:!0,sx:{py:10}}),e.jsx(Te,{tours:o})]})}const Oe=({inputData:t,filters:d,sortBy:h,dateError:s})=>{const{services:n,destination:r,startDate:o,endDate:a,tourGuides:p}=d,x=p.map(l=>l.id);return h==="latest"&&(t=P(t,["createdAt"],["desc"])),h==="oldest"&&(t=P(t,["createdAt"],["asc"])),h==="popular"&&(t=P(t,["totalViews"],["desc"])),r.length&&(t=t.filter(l=>r.includes(l.destination))),x.length&&(t=t.filter(l=>l.tourGuides.some(b=>x.includes(b.id)))),n.length&&(t=t.filter(l=>l.services.some(b=>n.includes(b)))),s||o&&a&&(t=t.filter(l=>ue(o,l.available.startDate,l.available.endDate))),t},Le={title:`Tour list | Dashboard - ${be.site.name}`};function mt(){return e.jsxs(e.Fragment,{children:[e.jsx(ge,{children:e.jsxs("title",{children:[" ",Le.title]})}),e.jsx(Pe,{})]})}export{mt as default};
