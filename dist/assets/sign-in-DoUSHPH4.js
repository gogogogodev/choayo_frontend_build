import{a as S,e as I,T as m,s as v,b as E,u as F,c as T,d as L,r as A,f as C,g as P,h as R,i as _,j as q,k as e,S as a,l as p,L as u,p as B,R as h,I as H,m as M,n as U,o as V,A as G,F as W,t as z,q as D,v as g,H as N,C as O}from"./index-CtazL8yi.js";import{F as x}from"./fields-DtpCY2Ze.js";import"./Rating-CF8Alnys.js";import"./visuallyHidden-Dan1xhjv.js";import"./Slider-DYRFC88j.js";import"./rhf-radio-group-DX9-_-9m.js";import"./RadioGroup-rk33BBJn.js";import"./FormGroup-3I9bsZvK.js";import"./FormControlLabel-DFxx6sAy.js";import"./country-select-Bwa-rR0D.js";import"./rhf-switch-DjhXwtDK.js";import"./rhf-checkbox-ClXqBOLt.js";import"./rhf-upload-C3OgFPC3.js";import"./upload-B6rOCRw-.js";import"./index-Cwjez_Mi.js";import"./placeholder-CbRedPRL.js";import"./format-number-CSJE7oq6.js";import"./preview-multi-file-DIDrQBye.js";import"./upload-avatar-CfvSEq0I.js";import"./rhf-date-picker-2a_P4JNL.js";import"./DatePicker-BqHCM0PQ.js";import"./ListItem-D6s2wHyy.js";import"./MobileDateTimePicker-Cmz-Um3i.js";const $=async({email:i,password:c})=>{try{const s={email:i,password:c},o=await S.post(I.auth.signIn,s),{token:n,user:t}=o.data;if(!n)throw new Error(m.token_not_found);v(t),E(n)}catch(s){throw s.status==401?new Error("email atau password salah"):s.message==m.token_not_found?(console.error("signIn - frontend error : ",s),new Error("ups, terjadi kesalahan saat login")):(console.error("signIn - backend error : ",s),new Error("ups, terjadi kesalahan pada server"))}},J=D({email:g().min(1,{message:"Email is required!"}),password:g().min(1,{message:"Password is required!"})});function K(){const i=F(),c=T(),{checkUserSession:s}=L(),[o,n]=A.useState(""),t=C(),w={email:"tenant1@choayo.dev",password:"password"},l=P({resolver:z(J),defaultValues:w}),{handleSubmit:j,formState:{isSubmitting:b}}=l,f=j(async d=>{try{await $({email:d.email,password:d.password}),await s?.();const r=R("mobile-websocket-key");(!r||r==='""'||r==="")&&_("mobile-websocket-key",q(4)),c.refresh()}catch(r){n(r instanceof Error?r.message:r)}}),y=e.jsxs(a,{spacing:1.5,sx:{mb:6},children:[e.jsx(p,{variant:"h5",children:"Sign in to your account"}),e.jsxs(a,{direction:"row",spacing:.5,children:[e.jsx(p,{variant:"body2",sx:{color:"text.secondary"},children:"Don't have an account?"}),e.jsx(u,{component:h,href:B.auth.jwt.signUp,variant:"subtitle2",color:i.palette.secondary.darker,children:"Get started"})]})]}),k=e.jsxs(a,{spacing:3,children:[e.jsx(x.Text,{name:"email",label:"Email address",InputLabelProps:{shrink:!0}}),e.jsxs(a,{spacing:1.5,children:[e.jsx(x.Text,{name:"password",label:"Password",type:t.value?"text":"password",InputLabelProps:{shrink:!0},InputProps:{endAdornment:e.jsx(H,{position:"end",children:e.jsx(M,{onClick:t.onToggle,edge:"end",children:e.jsx(U,{icon:t.value?"solar:eye-bold":"solar:eye-closed-bold"})})})}}),e.jsx(u,{component:h,href:"#",variant:"body2",color:"inherit",sx:{alignSelf:"flex-end"},children:"Forgot password?"})]}),e.jsx(V,{fullWidth:!0,size:"large",type:"submit",variant:"contained",loading:b,children:"Sign in"})]});return e.jsxs(e.Fragment,{children:[y,!!o&&e.jsx(G,{severity:"error",sx:{mb:3},children:o}),e.jsx(W,{methods:l,onSubmit:f,children:k})]})}const Q={title:`Login - ${O.site.name}`};function fe(){return e.jsxs(e.Fragment,{children:[e.jsx(N,{children:e.jsxs("title",{children:[" ",Q.title]})}),e.jsx(K,{})]})}export{fe as default};
